import{S as D2,i as C2,s as I2,y as T2,z as B2,A as z2,g as R2,d as M2,B as N2,o as L2,U as O2,q as nn,k as Pa,r as an,l as Ua,b as wr,u as Ka,h as br}from"./index.6ac5f651.js";import{C as F2,h as H2,a as q2}from"./container.26f811e3.js";import{_ as Or}from"./preload-helper.41c905a7.js";const $e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dn=Symbol("doneWritingPromise"),p0=Symbol("doneWritingResolve"),g0=Symbol("doneWritingReject"),Cn=Symbol("readingIndex");class Ge extends Array{constructor(){super(),this[dn]=new Promise((e,t)=>{this[p0]=e,this[g0]=t}),this[dn].catch(()=>{})}}function ce(r){return r&&r.getReader&&Array.isArray(r)}function Mn(r){if(!ce(r)){const e=r.getWriter(),t=e.releaseLock;return e.releaseLock=()=>{e.closed.catch(function(){}),t.call(e)},e}this.stream=r}Ge.prototype.getReader=function(){return this[Cn]===void 0&&(this[Cn]=0),{read:async()=>(await this[dn],this[Cn]===this.length?{value:void 0,done:!0}:{value:this[this[Cn]++],done:!1})}},Ge.prototype.readToEnd=async function(r){await this[dn];const e=r(this.slice(this[Cn]));return this.length=0,e},Ge.prototype.clone=function(){const r=new Ge;return r[dn]=this[dn].then(()=>{r.push(...this)}),r},Mn.prototype.write=async function(r){this.stream.push(r)},Mn.prototype.close=async function(){this.stream[p0]()},Mn.prototype.abort=async function(r){return this.stream[g0](r),r},Mn.prototype.releaseLock=function(){};const ii=typeof $e.process=="object"&&typeof $e.process.versions=="object",Da=ii&&void 0;function be(r){return ce(r)?"array":$e.ReadableStream&&$e.ReadableStream.prototype.isPrototypeOf(r)?"web":wn&&wn.prototype.isPrototypeOf(r)?"ponyfill":Da&&Da.prototype.isPrototypeOf(r)?"node":!(!r||!r.getReader)&&"web-like"}function ai(r){return Uint8Array.prototype.isPrototypeOf(r)}function m0(r){if(r.length===1)return r[0];let e=0;for(let i=0;i<r.length;i++){if(!ai(r[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=r[i].length}const t=new Uint8Array(e);let n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}const j2=ii&&void 0,Ca=ii&&void 0;let si,w0;if(Ca){si=function(e){let t=!1;return new wn({start(n){e.pause(),e.on("data",i=>{t||(j2.isBuffer(i)&&(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)),n.enqueue(i),e.pause())}),e.on("end",()=>{t||n.close()}),e.on("error",i=>n.error(i))},pull(){e.resume()},cancel(n){t=!0,e.destroy(n)}})};class r extends Ca{constructor(t,n){super(n),this._reader=Zr(t)}async _read(t){try{for(;;){const{done:n,value:i}=await this._reader.read();if(n){this.push(null);break}if(!this.push(i)||this._cancelling){this._reading=!1;break}}}catch(n){this.emit("error",n)}}_destroy(t){this._reader.cancel(t)}}w0=function(e,t){return new r(e,t)}}const Ia=new WeakSet,Gt=Symbol("externalBuffer");function Ne(r){if(this.stream=r,r[Gt]&&(this[Gt]=r[Gt].slice()),ce(r)){const n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{},void(this._cancel=()=>{})}let e=be(r);if(e==="node"&&(r=si(r)),e){const n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{n.closed.catch(function(){}),n.releaseLock()},void(this._cancel=n.cancel.bind(n))}let t=!1;this._read=async()=>t||Ia.has(r)?{value:void 0,done:!0}:(t=!0,{value:r,done:!1}),this._releaseLock=()=>{if(t)try{Ia.add(r)}catch{}}}Ne.prototype.read=async function(){return this[Gt]&&this[Gt].length?{done:!1,value:this[Gt].shift()}:this._read()},Ne.prototype.releaseLock=function(){this[Gt]&&(this.stream[Gt]=this[Gt]),this._releaseLock()},Ne.prototype.cancel=function(r){return this._cancel(r)},Ne.prototype.readLine=async function(){let r,e=[];for(;!r;){let{done:t,value:n}=await this.read();if(n+="",t)return e.length?Ee(e):void 0;const i=n.indexOf(`
`)+1;i&&(r=Ee(e.concat(n.substr(0,i))),e=[]),i!==n.length&&e.push(n.substr(i))}return this.unshift(...e),r},Ne.prototype.readByte=async function(){const{done:r,value:e}=await this.read();if(r)return;const t=e[0];return this.unshift(ve(e,1)),t},Ne.prototype.readBytes=async function(r){const e=[];let t=0;for(;;){const{done:n,value:i}=await this.read();if(n)return e.length?Ee(e):void 0;if(e.push(i),t+=i.length,t>=r){const a=Ee(e);return this.unshift(ve(a,r)),ve(a,0,r)}}},Ne.prototype.peekBytes=async function(r){const e=await this.readBytes(r);return this.unshift(e),e},Ne.prototype.unshift=function(...r){this[Gt]||(this[Gt]=[]),r.length===1&&ai(r[0])&&this[Gt].length&&r[0].length&&this[Gt][0].byteOffset>=r[0].length?this[Gt][0]=new Uint8Array(this[Gt][0].buffer,this[Gt][0].byteOffset-r[0].length,this[Gt][0].byteLength+r[0].length):this[Gt].unshift(...r.filter(e=>e&&e.length))},Ne.prototype.readToEnd=async function(r=Ee){const e=[];for(;;){const{done:t,value:n}=await this.read();if(t)break;e.push(n)}return r(e)};let Ta,{ReadableStream:wn,WritableStream:G2,TransformStream:sa}=$e;const $n=ii&&void 0;function oa(r){let e=be(r);return e==="node"?si(r):e==="web"&&Ta?Ta(r):e?r:new wn({start(t){t.enqueue(r),t.close()}})}function b0(r){if(be(r))return r;const e=new Ge;return(async()=>{const t=Te(e);await t.write(r),await t.close()})(),e}function Ee(r){return r.some(e=>be(e)&&!ce(e))?function(e){e=e.map(oa);const t=v0(async function(a){await Promise.all(i.map(o=>V2(o,a)))});let n=Promise.resolve();const i=e.map((a,o)=>n1(a,(s,u)=>(n=n.then(()=>r1(s,t.writable,{preventClose:o!==e.length-1})),n)));return t.readable}(r):r.some(e=>ce(e))?function(e){const t=new Ge;let n=Promise.resolve();return e.forEach((i,a)=>(n=n.then(()=>r1(i,t,{preventClose:a!==e.length-1})),n)),t}(r):typeof r[0]=="string"?r.join(""):$n&&$n.isBuffer(r[0])?$n.concat(r):m0(r)}function Zr(r){return new Ne(r)}function Te(r){return new Mn(r)}async function r1(r,e,{preventClose:t=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(be(r)&&!ce(r)){r=oa(r);try{if(r[Gt]){const s=Te(e);for(let u=0;u<r[Gt].length;u++)await s.ready,await s.write(r[Gt][u]);s.releaseLock()}await r.pipeTo(e,{preventClose:t,preventAbort:n,preventCancel:i})}catch{}return}const a=Zr(r=b0(r)),o=Te(e);try{for(;;){await o.ready;const{done:s,value:u}=await a.read();if(s){t||await o.close();break}await o.write(u)}}catch(s){n||await o.abort(s)}finally{a.releaseLock(),o.releaseLock()}}function k0(r,e){const t=new sa(e);return r1(r,t.writable),t.readable}function v0(r){let e,t,n=!1;return{readable:new wn({start(i){t=i},pull(){e?e():n=!0},cancel:r},{highWaterMark:0}),writable:new G2({write:async function(i){t.enqueue(i),n?n=!1:(await new Promise(a=>{e=a}),e=null)},close:t.close.bind(t),abort:t.error.bind(t)})}}function Xt(r,e=()=>{},t=()=>{}){if(ce(r)){const a=new Ge;return(async()=>{const o=Te(a);try{const s=await nr(r),u=e(s),c=t();let h;h=u!==void 0&&c!==void 0?Ee([u,c]):u!==void 0?u:c,await o.write(h),await o.close()}catch(s){await o.abort(s)}})(),a}if(be(r))return k0(r,{async transform(a,o){try{const s=await e(a);s!==void 0&&o.enqueue(s)}catch(s){o.error(s)}},async flush(a){try{const o=await t();o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}}});const n=e(r),i=t();return n!==void 0&&i!==void 0?Ee([n,i]):n!==void 0?n:i}function n1(r,e){if(be(r)&&!ce(r)){let n;const i=new sa({start(s){n=s}}),a=r1(r,i.writable),o=v0(async function(s){n.error(s),await a,await new Promise(setTimeout)});return e(i.readable,o.writable),o.readable}r=b0(r);const t=new Ge;return e(r,t),t}function O1(r){if(ce(r))return r.clone();if(be(r)){const e=function(t){if(ce(t))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(be(t)){const n=oa(t).tee();return n[0][Gt]=n[1][Gt]=t[Gt],n}return[ve(t),ve(t)]}(r);return A0(r,e[0]),e[1]}return ve(r)}function _0(r){return ce(r)?O1(r):be(r)?new wn({start(e){const t=n1(r,async(n,i)=>{const a=Zr(n),o=Te(i);try{for(;;){await o.ready;const{done:s,value:u}=await a.read();if(s){try{e.close()}catch{}return void await o.close()}try{e.enqueue(u)}catch{}await o.write(u)}}catch(s){e.error(s),await o.abort(s)}});A0(r,t)}}):ve(r)}function A0(r,e){Object.entries(Object.getOwnPropertyDescriptors(r.constructor.prototype)).forEach(([t,n])=>{t!=="constructor"&&(n.value?n.value=n.value.bind(e):n.get=n.get.bind(e),Object.defineProperty(r,t,n))})}function ve(r,e=0,t=1/0){if(ce(r))throw Error("Not implemented");if(be(r)){if(e>=0&&t>=0){let n=0;return k0(r,{transform(i,a){n<t?(n+i.length>=e&&a.enqueue(ve(i,Math.max(e-n,0),t-n)),n+=i.length):a.terminate()}})}if(e<0&&(t<0||t===1/0)){let n=[];return Xt(r,i=>{i.length>=-e?n=[i]:n.push(i)},()=>ve(Ee(n),e,t))}if(e===0&&t<0){let n;return Xt(r,i=>{const a=n?Ee([n,i]):i;if(a.length>=-t)return n=ve(a,t),ve(a,e,t);n=a})}return console.warn(`stream.slice(input, ${e}, ${t}) not implemented efficiently.`),l1(async()=>ve(await nr(r),e,t))}return r[Gt]&&(r=Ee(r[Gt].concat([r]))),!ai(r)||$n&&$n.isBuffer(r)?r.slice(e,t):(t===1/0&&(t=r.length),r.subarray(e,t))}async function nr(r,e=Ee){return ce(r)?r.readToEnd(e):be(r)?Zr(r).readToEnd(e):r}async function V2(r,e){if(be(r)){if(r.cancel)return r.cancel(e);if(r.destroy)return r.destroy(e),await new Promise(setTimeout),e}}function l1(r){const e=new Ge;return(async()=>{const t=Te(e);try{await t.write(await r()),await t.close()}catch(n){await t.abort(n)}})(),e}class ye{constructor(e){if(e===void 0)throw Error("Invalid BigInteger input");if(e instanceof Uint8Array){const t=e,n=Array(t.length);for(let i=0;i<t.length;i++){const a=t[i].toString(16);n[i]=t[i]<=15?"0"+a:a}this.value=BigInt("0x0"+n.join(""))}else this.value=BigInt(e)}clone(){return new ye(this.value)}iinc(){return this.value++,this}inc(){return this.clone().iinc()}idec(){return this.value--,this}dec(){return this.clone().idec()}iadd(e){return this.value+=e.value,this}add(e){return this.clone().iadd(e)}isub(e){return this.value-=e.value,this}sub(e){return this.clone().isub(e)}imul(e){return this.value*=e.value,this}mul(e){return this.clone().imul(e)}imod(e){return this.value%=e.value,this.isNegative()&&this.iadd(e),this}mod(e){return this.clone().imod(e)}modExp(e,t){if(t.isZero())throw Error("Modulo cannot be zero");if(t.isOne())return new ye(0);if(e.isNegative())throw Error("Unsopported negative exponent");let n=e.value,i=this.value;i%=t.value;let a=BigInt(1);for(;n>BigInt(0);){const o=n&BigInt(1);n>>=BigInt(1);const s=a*i%t.value;a=o?s:a,i=i*i%t.value}return new ye(a)}modInv(e){const{gcd:t,x:n}=this._egcd(e);if(!t.isOne())throw Error("Inverse does not exist");return n.add(e).mod(e)}_egcd(e){let t=BigInt(0),n=BigInt(1),i=BigInt(1),a=BigInt(0),o=this.value;for(e=e.value;e!==BigInt(0);){const s=o/e;let u=t;t=i-s*t,i=u,u=n,n=a-s*n,a=u,u=e,e=o%e,o=u}return{x:new ye(i),y:new ye(a),gcd:new ye(o)}}gcd(e){let t=this.value;for(e=e.value;e!==BigInt(0);){const n=e;e=t%e,t=n}return new ye(t)}ileftShift(e){return this.value<<=e.value,this}leftShift(e){return this.clone().ileftShift(e)}irightShift(e){return this.value>>=e.value,this}rightShift(e){return this.clone().irightShift(e)}equal(e){return this.value===e.value}lt(e){return this.value<e.value}lte(e){return this.value<=e.value}gt(e){return this.value>e.value}gte(e){return this.value>=e.value}isZero(){return this.value===BigInt(0)}isOne(){return this.value===BigInt(1)}isNegative(){return this.value<BigInt(0)}isEven(){return!(this.value&BigInt(1))}abs(){const e=this.clone();return this.isNegative()&&(e.value=-e.value),e}toString(){return this.value.toString()}toNumber(){const e=Number(this.value);if(e>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return e}getBit(e){return(this.value>>BigInt(e)&BigInt(1))===BigInt(0)?0:1}bitLength(){const e=new ye(0),t=new ye(1),n=new ye(-1),i=this.isNegative()?n:e;let a=1;const o=this.clone();for(;!o.irightShift(t).equal(i);)a++;return a}byteLength(){const e=new ye(0),t=new ye(-1),n=this.isNegative()?t:e,i=new ye(8);let a=1;const o=this.clone();for(;!o.irightShift(i).equal(n);)a++;return a}toUint8Array(e="be",t){let n=this.value.toString(16);n.length%2==1&&(n="0"+n);const i=n.length/2,a=new Uint8Array(t||i),o=t?t-i:0;let s=0;for(;s<i;)a[s+o]=parseInt(n.slice(2*s,2*s+2),16),s++;return e!=="be"&&a.reverse(),a}}const W2=()=>typeof BigInt<"u",Ba=(()=>{try{return!1}catch{}return!1})(),A={isString:function(r){return typeof r=="string"||r instanceof String},isArray:function(r){return r instanceof Array},isUint8Array:ai,isStream:be,readNumber:function(r){let e=0;for(let t=0;t<r.length;t++)e+=256**t*r[r.length-1-t];return e},writeNumber:function(r,e){const t=new Uint8Array(e);for(let n=0;n<e;n++)t[n]=r>>8*(e-n-1)&255;return t},readDate:function(r){const e=A.readNumber(r);return new Date(1e3*e)},writeDate:function(r){const e=Math.floor(r.getTime()/1e3);return A.writeNumber(e,4)},normalizeDate:function(r=Date.now()){return r===null||r===1/0?r:new Date(1e3*Math.floor(+r/1e3))},readMPI:function(r){const e=(r[0]<<8|r[1])+7>>>3;return r.subarray(2,2+e)},leftPad(r,e){const t=new Uint8Array(e),n=e-r.length;return t.set(r,n),t},uint8ArrayToMPI:function(r){const e=A.uint8ArrayBitLength(r);if(e===0)throw Error("Zero MPI");const t=r.subarray(r.length-Math.ceil(e/8)),n=new Uint8Array([(65280&e)>>8,255&e]);return A.concatUint8Array([n,t])},uint8ArrayBitLength:function(r){let e;for(e=0;e<r.length&&r[e]===0;e++);if(e===r.length)return 0;const t=r.subarray(e);return 8*(t.length-1)+A.nbits(t[0])},hexToUint8Array:function(r){const e=new Uint8Array(r.length>>1);for(let t=0;t<r.length>>1;t++)e[t]=parseInt(r.substr(t<<1,2),16);return e},uint8ArrayToHex:function(r){const e=[],t=r.length;let n,i=0;for(;i<t;){for(n=r[i++].toString(16);n.length<2;)n="0"+n;e.push(""+n)}return e.join("")},stringToUint8Array:function(r){return Xt(r,e=>{if(!A.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})},uint8ArrayToString:function(r){const e=[],n=(r=new Uint8Array(r)).length;for(let i=0;i<n;i+=16384)e.push(String.fromCharCode.apply(String,r.subarray(i,i+16384<n?i+16384:n)));return e.join("")},encodeUTF8:function(r){const e=new TextEncoder("utf-8");function t(n,i=!1){return e.encode(n,{stream:!i})}return Xt(r,t,()=>t("",!0))},decodeUTF8:function(r){const e=new TextDecoder("utf-8");function t(n,i=!1){return e.decode(n,{stream:!i})}return Xt(r,t,()=>t(new Uint8Array,!0))},concat:Ee,concatUint8Array:m0,equalsUint8Array:function(r,e){if(!A.isUint8Array(r)||!A.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0},writeChecksum:function(r){let e=0;for(let t=0;t<r.length;t++)e=e+r[t]&65535;return A.writeNumber(e,2)},printDebug:function(r){Ba&&console.log("[OpenPGP.js debug]",r)},printDebugError:function(r){Ba&&console.error("[OpenPGP.js debug]",r)},nbits:function(r){let e=1,t=r>>>16;return t!==0&&(r=t,e+=16),t=r>>8,t!==0&&(r=t,e+=8),t=r>>4,t!==0&&(r=t,e+=4),t=r>>2,t!==0&&(r=t,e+=2),t=r>>1,t!==0&&(r=t,e+=1),e},double:function(r){const e=new Uint8Array(r.length),t=r.length-1;for(let n=0;n<t;n++)e[n]=r[n]<<1^r[n+1]>>7;return e[t]=r[t]<<1^135*(r[0]>>7),e},shiftRight:function(r,e){if(e)for(let t=r.length-1;t>=0;t--)r[t]>>=e,t>0&&(r[t]|=r[t-1]<<8-e);return r},getWebCrypto:function(){return $e!==void 0&&$e.crypto&&$e.crypto.subtle},getBigInteger:async function(){if(W2())return ye;{const{default:r}=await Or(()=>import("./bn.interface.min.9d5a57c7.js"),["./bn.interface.min.9d5a57c7.js","./bn.min.3fe96d20.js"],import.meta.url);return r}},getNodeCrypto:function(){},getNodeZlib:function(){},getNodeBuffer:function(){return{}.Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:(void 0).cpus().length},isEmailAddress:function(r){return A.isString(r)?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+([a-zA-Z]{2,}|xn--[a-zA-Z\-0-9]+)))$/.test(r):!1},canonicalizeEOL:function(r){let e=!1;return Xt(r,t=>{let n;e&&(t=A.concatUint8Array([new Uint8Array([13]),t])),t[t.length-1]===13?(e=!0,t=t.subarray(0,-1)):e=!1;const i=[];for(let s=0;n=t.indexOf(10,s)+1,n;s=n)t[n-2]!==13&&i.push(n);if(!i.length)return t;const a=new Uint8Array(t.length+i.length);let o=0;for(let s=0;s<i.length;s++){const u=t.subarray(i[s-1]||0,i[s]);a.set(u,o),o+=u.length,a[o-1]=13,a[o]=10,o++}return a.set(t.subarray(i[i.length-1]||0),o),a},()=>e?new Uint8Array([13]):void 0)},nativeEOL:function(r){let e=!1;return Xt(r,t=>{let n;(t=e&&t[0]!==10?A.concatUint8Array([new Uint8Array([13]),t]):new Uint8Array(t))[t.length-1]===13?(e=!0,t=t.subarray(0,-1)):e=!1;let i=0;for(let a=0;a!==t.length;a=n){n=t.indexOf(13,a)+1,n||(n=t.length);const o=n-(t[n]===10?1:0);a&&t.copyWithin(i,a,o),i+=o-a}return t.subarray(0,i)},()=>e?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(r){return r.split(`
`).map(e=>{let t=e.length-1;for(;t>=0&&(e[t]===" "||e[t]==="	"||e[t]==="\r");t--);return e.substr(0,t+1)}).join(`
`)},wrapError:function(r,e){if(!e)return Error(r);try{e.message=r+": "+e.message}catch{}return e},constructAllowedPackets:function(r){const e={};return r.forEach(t=>{if(!t.tag)throw Error("Invalid input: expected a packet class");e[t.tag]=t}),e},anyPromise:function(r){return new Promise(async(e,t)=>{let n;await Promise.all(r.map(async i=>{try{e(await i)}catch(a){n=a}})),t(n)})},selectUint8Array:function(r,e,t){const n=Math.max(e.length,t.length),i=new Uint8Array(n);let a=0;for(let o=0;o<i.length;o++)i[o]=e[o]&256-r|t[o]&255+r,a+=r&o<e.length|1-r&o<t.length;return i.subarray(0,a)},selectUint8:function(r,e,t){return e&256-r|t&255+r}},_i=A.getNodeBuffer();let F1,H1;function or(r){let e=new Uint8Array;return Xt(r,t=>{e=A.concatUint8Array([e,t]);const n=[],i=Math.floor(e.length/45),a=45*i,o=F1(e.subarray(0,a));for(let s=0;s<i;s++)n.push(o.substr(60*s,60)),n.push(`
`);return e=e.subarray(a),n.join("")},()=>e.length?F1(e)+`
`:"")}function E0(r){let e="";return Xt(r,t=>{e+=t;let n=0;const i=[" ","	","\r",`
`];for(let s=0;s<i.length;s++){const u=i[s];for(let c=e.indexOf(u);c!==-1;c=e.indexOf(u,c+1))n++}let a=e.length;for(;a>0&&(a-n)%4!=0;a--)i.includes(e[a])&&n--;const o=H1(e.substr(0,a));return e=e.substr(a),o},()=>H1(e))}function hr(r){return E0(r.replace(/-/g,"+").replace(/_/g,"/"))}function ke(r,e){let t=or(r).replace(/[\r\n]/g,"");return e&&(t=t.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,"")),t}_i?(F1=r=>_i.from(r).toString("base64"),H1=r=>{const e=_i.from(r,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(F1=r=>btoa(A.uint8ArrayToString(r)),H1=r=>A.stringToUint8Array(atob(r)));const In=Symbol("byValue");var m={curve:{p256:"p256","P-256":"p256",secp256r1:"p256",prime256v1:"p256","1.2.840.10045.3.1.7":"p256","2a8648ce3d030107":"p256","2A8648CE3D030107":"p256",p384:"p384","P-384":"p384",secp384r1:"p384","1.3.132.0.34":"p384","2b81040022":"p384","2B81040022":"p384",p521:"p521","P-521":"p521",secp521r1:"p521","1.3.132.0.35":"p521","2b81040023":"p521","2B81040023":"p521",secp256k1:"secp256k1","1.3.132.0.10":"secp256k1","2b8104000a":"secp256k1","2B8104000A":"secp256k1",ED25519:"ed25519",ed25519:"ed25519",Ed25519:"ed25519","1.3.6.1.4.1.11591.15.1":"ed25519","2b06010401da470f01":"ed25519","2B06010401DA470F01":"ed25519",X25519:"curve25519",cv25519:"curve25519",curve25519:"curve25519",Curve25519:"curve25519","1.3.6.1.4.1.3029.1.5.1":"curve25519","2b060104019755010501":"curve25519","2B060104019755010501":"curve25519",brainpoolP256r1:"brainpoolP256r1","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1","2b2403030208010107":"brainpoolP256r1","2B2403030208010107":"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1","2b240303020801010b":"brainpoolP384r1","2B240303020801010B":"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1","2b240303020801010d":"brainpoolP512r1","2B240303020801010D":"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsa:22,aedh:23,aedsa:24},symmetric:{plaintext:0,idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuer:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4},write:function(r,e){if(typeof e=="number"&&(e=this.read(r,e)),r[e]!==void 0)return r[e];throw Error("Invalid enum value.")},read:function(r,e){if(r[In]||(r[In]=[],Object.entries(r).forEach(([t,n])=>{r[In][n]=t})),r[In][e]!==void 0)return r[In][e];throw Error("Invalid enum value.")}},At={preferredHashAlgorithm:m.hash.sha256,preferredSymmetricAlgorithm:m.symmetric.aes256,preferredCompressionAlgorithm:m.compression.uncompressed,deflateLevel:6,aeadProtect:!1,preferredAEADAlgorithm:m.aead.eax,aeadChunkSizeByte:12,v5Keys:!1,s2kIterationCountByte:224,allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,checksumRequired:!1,minRSABits:2047,passwordCollisionCheck:!1,revocationsExpire:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([m.symmetric.aes128,m.symmetric.aes192,m.symmetric.aes256]),minBytesForWebCrypto:1e3,ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,showVersion:!1,showComment:!1,versionString:"OpenPGP.js 5.7.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],useIndutnyElliptic:!0,rejectHashAlgorithms:new Set([m.hash.md5,m.hash.ripemd]),rejectMessageHashAlgorithms:new Set([m.hash.md5,m.hash.ripemd,m.hash.sha1]),rejectPublicKeyAlgorithms:new Set([m.publicKey.elgamal,m.publicKey.dsa]),rejectCurves:new Set([m.curve.secp256k1])};function $2(r){const e=r.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?m.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?m.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?m.armor.signed:/MESSAGE/.test(e[1])?m.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?m.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?m.armor.privateKey:/SIGNATURE/.test(e[1])?m.armor.signature:void 0}function zr(r,e){let t="";return e.showVersion&&(t+="Version: "+e.versionString+`
`),e.showComment&&(t+="Comment: "+e.commentString+`
`),r&&(t+="Comment: "+r+`
`),t+=`
`,t}function _r(r){return or(function(e){let t=13501623;return Xt(e,n=>{const i=Z2?Math.floor(n.length/4):0,a=new Uint32Array(n.buffer,n.byteOffset,i);for(let o=0;o<i;o++)t^=a[o],t=ie[0][t>>24&255]^ie[1][t>>16&255]^ie[2][t>>8&255]^ie[3][t>>0&255];for(let o=4*i;o<n.length;o++)t=t>>8^ie[0][255&t^n[o]]},()=>new Uint8Array([t,t>>8,t>>16]))}(r))}const ie=[Array(255),Array(255),Array(255),Array(255)];for(let r=0;r<=255;r++){let e=r<<16;for(let t=0;t<8;t++)e=e<<1^(8388608&e?8801531:0);ie[0][r]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let r=0;r<=255;r++)ie[1][r]=ie[0][r]>>8^ie[0][255&ie[0][r]];for(let r=0;r<=255;r++)ie[2][r]=ie[1][r]>>8^ie[0][255&ie[1][r]];for(let r=0;r<=255;r++)ie[3][r]=ie[2][r]>>8^ie[0][255&ie[2][r]];const Z2=function(){const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,255,!0),new Int16Array(r)[0]===255}();function za(r){for(let e=0;e<r.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(r[e])||A.printDebugError(Error("Improperly formatted armor header: "+r[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(r[e])||A.printDebugError(Error("Unknown header: "+r[e]))}function Q2(r){let e=r,t="";const n=r.lastIndexOf("=");return n>=0&&n!==r.length-1&&(e=r.slice(0,n),t=r.slice(n+1).substr(0,4)),{body:e,checksum:t}}function Y2(r,e=At){return new Promise(async(t,n)=>{try{const i=/^-----[^-]+-----$/m,a=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let o;const s=[];let u,c,h,l=s,_=[],p=E0(n1(r,async(R,M)=>{const N=Zr(R);try{for(;;){let Y=await N.readLine();if(Y===void 0)throw Error("Misformed armored text");if(Y=A.removeTrailingSpaces(Y.replace(/[\r\n]/g,"")),o)if(u)c||o!==2||(i.test(Y)?(_=_.join(`\r
`),c=!0,za(l),l=[],u=!1):_.push(Y.replace(/^- /,"")));else if(i.test(Y)&&n(Error("Mandatory blank line missing between armor headers and armor data")),a.test(Y)){if(za(l),u=!0,c||o!==2){t({text:_,data:p,headers:s,type:o});break}}else l.push(Y);else i.test(Y)&&(o=$2(Y))}}catch(Y){return void n(Y)}const j=Te(M);try{for(;;){await j.ready;const{done:Y,value:F}=await N.read();if(Y)throw Error("Misformed armored text");const E=F+"";if(E.indexOf("=")!==-1||E.indexOf("-")!==-1){let $=await N.readToEnd();$.length||($=""),$=E+$,$=A.removeTrailingSpaces($.replace(/\r/g,""));const q=$.split(i);if(q.length===1)throw Error("Misformed armored text");const V=Q2(q[0].slice(0,-1));h=V.checksum,await j.write(V.body);break}await j.write(E)}await j.ready,await j.close()}catch(Y){await j.abort(Y)}}));p=n1(p,async(R,M)=>{const N=nr(_r(_0(R)));N.catch(()=>{}),await r1(R,M,{preventClose:!0});const j=Te(M);try{const Y=(await N).replace(`
`,"");if(h!==Y&&(h||e.checksumRequired))throw Error("Ascii armor integrity check failed");await j.ready,await j.close()}catch(Y){await j.abort(Y)}})}catch(i){n(i)}}).then(async t=>(ce(t.data)&&(t.data=await nr(t.data)),t))}function ca(r,e,t,n,i,a=At){let o,s;r===m.armor.signed&&(o=e.text,s=e.hash,e=e.data);const u=_0(e),c=[];switch(r){case m.armor.multipartSection:c.push("-----BEGIN PGP MESSAGE, PART "+t+"/"+n+`-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push("-----END PGP MESSAGE, PART "+t+"/"+n+`-----
`);break;case m.armor.multipartLast:c.push("-----BEGIN PGP MESSAGE, PART "+t+`-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push("-----END PGP MESSAGE, PART "+t+`-----
`);break;case m.armor.signed:c.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),c.push("Hash: "+s+`

`),c.push(o.replace(/^-/gm,"- -")),c.push(`
-----BEGIN PGP SIGNATURE-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push(`-----END PGP SIGNATURE-----
`);break;case m.armor.message:c.push(`-----BEGIN PGP MESSAGE-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push(`-----END PGP MESSAGE-----
`);break;case m.armor.publicKey:c.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case m.armor.privateKey:c.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case m.armor.signature:c.push(`-----BEGIN PGP SIGNATURE-----
`),c.push(zr(i,a)),c.push(or(e)),c.push("=",_r(u)),c.push(`-----END PGP SIGNATURE-----
`)}return A.concat(c)}class bn{constructor(){this.bytes=""}read(e){this.bytes=A.uint8ArrayToString(e.subarray(0,8))}write(){return A.stringToUint8Array(this.bytes)}toHex(){return A.uint8ArrayToHex(A.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const t=new bn;return t.read(A.hexToUint8Array(e)),t}static wildcard(){const e=new bn;return e.read(new Uint8Array(8)),e}}var Pt=function(){var r,e,t=!1;function n(l,_){var p=r[(e[l]+e[_])%255];return l!==0&&_!==0||(p=0),p}var i,a,o,s,u=!1;function c(){function l(M){var N,j,Y;for(j=Y=function(F){var E=r[255-e[F]];return F===0&&(E=0),E}(M),N=0;N<4;N++)Y^=j=255&(j<<1|j>>>7);return Y^=99}t||function(){r=[],e=[];var M,N,j=1;for(M=0;M<255;M++)r[M]=j,N=128&j,j<<=1,j&=255,N===128&&(j^=27),j^=r[M],e[r[M]]=M;r[255]=r[0],e[0]=0,t=!0}(),i=[],a=[],o=[[],[],[],[]],s=[[],[],[],[]];for(var _=0;_<256;_++){var p=l(_);i[_]=p,a[p]=_,o[0][_]=n(2,p)<<24|p<<16|p<<8|n(3,p),s[0][p]=n(14,_)<<24|n(9,_)<<16|n(13,_)<<8|n(11,_);for(var R=1;R<4;R++)o[R][_]=o[R-1][_]>>>8|o[R-1][_]<<24,s[R][p]=s[R-1][p]>>>8|s[R-1][p]<<24}u=!0}var h=function(l,_){u||c();var p=new Uint32Array(_);p.set(i,512),p.set(a,768);for(var R=0;R<4;R++)p.set(o[R],4096+1024*R>>2),p.set(s[R],8192+1024*R>>2);var M=function(N,j,Y){var F=0,E=0,$=0,q=0,V=0,Z=0,tt=0,rt=0,ft=0,lt=0,mt=0,L=0,yt=0,Ct=0,H=0,nt=0,pt=0,gt=0,dt=0,ht=0,wt=0,st=new N.Uint32Array(Y),S=new N.Uint8Array(Y);function O(k,b,et,it,St,It,zt,Kt){k=k|0,b=b|0,et=et|0,it=it|0,St=St|0,It=It|0,zt=zt|0,Kt=Kt|0;var Vt=0,Yt=0,Jt=0,ee=0,Ut=0,Nt=0,Rt=0,Et=0;for(Vt=et|1024,Yt=et|2048,Jt=et|3072,St=St^st[(k|0)>>2],It=It^st[(k|4)>>2],zt=zt^st[(k|8)>>2],Kt=Kt^st[(k|12)>>2],Et=16;(Et|0)<=it<<4;Et=Et+16|0)ee=st[(et|St>>22&1020)>>2]^st[(Vt|It>>14&1020)>>2]^st[(Yt|zt>>6&1020)>>2]^st[(Jt|Kt<<2&1020)>>2]^st[(k|Et|0)>>2],Ut=st[(et|It>>22&1020)>>2]^st[(Vt|zt>>14&1020)>>2]^st[(Yt|Kt>>6&1020)>>2]^st[(Jt|St<<2&1020)>>2]^st[(k|Et|4)>>2],Nt=st[(et|zt>>22&1020)>>2]^st[(Vt|Kt>>14&1020)>>2]^st[(Yt|St>>6&1020)>>2]^st[(Jt|It<<2&1020)>>2]^st[(k|Et|8)>>2],Rt=st[(et|Kt>>22&1020)>>2]^st[(Vt|St>>14&1020)>>2]^st[(Yt|It>>6&1020)>>2]^st[(Jt|zt<<2&1020)>>2]^st[(k|Et|12)>>2],St=ee,It=Ut,zt=Nt,Kt=Rt;F=st[(b|St>>22&1020)>>2]<<24^st[(b|It>>14&1020)>>2]<<16^st[(b|zt>>6&1020)>>2]<<8^st[(b|Kt<<2&1020)>>2]^st[(k|Et|0)>>2],E=st[(b|It>>22&1020)>>2]<<24^st[(b|zt>>14&1020)>>2]<<16^st[(b|Kt>>6&1020)>>2]<<8^st[(b|St<<2&1020)>>2]^st[(k|Et|4)>>2],$=st[(b|zt>>22&1020)>>2]<<24^st[(b|Kt>>14&1020)>>2]<<16^st[(b|St>>6&1020)>>2]<<8^st[(b|It<<2&1020)>>2]^st[(k|Et|8)>>2],q=st[(b|Kt>>22&1020)>>2]<<24^st[(b|St>>14&1020)>>2]<<16^st[(b|It>>6&1020)>>2]<<8^st[(b|zt<<2&1020)>>2]^st[(k|Et|12)>>2]}function w(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,k,b,et,it)}function d(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0;var St=0;O(1024,3072,8192,wt,k,it,et,b),St=E,E=q,q=St}function P(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,V^k,Z^b,tt^et,rt^it),V=F,Z=E,tt=$,rt=q}function G(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0;var St=0;O(1024,3072,8192,wt,k,it,et,b),St=E,E=q,q=St,F=F^V,E=E^Z,$=$^tt,q=q^rt,V=k,Z=b,tt=et,rt=it}function W(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,V,Z,tt,rt),V=F=F^k,Z=E=E^b,tt=$=$^et,rt=q=q^it}function Q(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,V,Z,tt,rt),F=F^k,E=E^b,$=$^et,q=q^it,V=k,Z=b,tt=et,rt=it}function y(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,V,Z,tt,rt),V=F,Z=E,tt=$,rt=q,F=F^k,E=E^b,$=$^et,q=q^it}function f(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,O(0,2048,4096,wt,ft,lt,mt,L),L=~nt&L|nt&L+1,mt=~H&mt|H&mt+((L|0)==0),lt=~Ct&lt|Ct&lt+((mt|0)==0),ft=~yt&ft|yt&ft+((lt|0)==0),F=F^k,E=E^b,$=$^et,q=q^it}function g(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0;var St=0,It=0,zt=0,Kt=0,Vt=0,Yt=0,Jt=0,ee=0,Ut=0,Nt=0;for(k=k^V,b=b^Z,et=et^tt,it=it^rt,St=pt|0,It=gt|0,zt=dt|0,Kt=ht|0;(Ut|0)<128;Ut=Ut+1|0)St>>>31&&(Vt=Vt^k,Yt=Yt^b,Jt=Jt^et,ee=ee^it),St=St<<1|It>>>31,It=It<<1|zt>>>31,zt=zt<<1|Kt>>>31,Kt=Kt<<1,Nt=it&1,it=it>>>1|et<<31,et=et>>>1|b<<31,b=b>>>1|k<<31,k=k>>>1,Nt&&(k=k^3774873600);V=Vt,Z=Yt,tt=Jt,rt=ee}function v(k){k=k|0,wt=k}function C(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,F=k,E=b,$=et,q=it}function x(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,V=k,Z=b,tt=et,rt=it}function B(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,ft=k,lt=b,mt=et,L=it}function ct(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,yt=k,Ct=b,H=et,nt=it}function at(k,b,et,it){k=k|0,b=b|0,et=et|0,it=it|0,L=~nt&L|nt&it,mt=~H&mt|H&et,lt=~Ct&lt|Ct&b,ft=~yt&ft|yt&k}function ut(k){return k=k|0,k&15?-1:(S[k|0]=F>>>24,S[k|1]=F>>>16&255,S[k|2]=F>>>8&255,S[k|3]=F&255,S[k|4]=E>>>24,S[k|5]=E>>>16&255,S[k|6]=E>>>8&255,S[k|7]=E&255,S[k|8]=$>>>24,S[k|9]=$>>>16&255,S[k|10]=$>>>8&255,S[k|11]=$&255,S[k|12]=q>>>24,S[k|13]=q>>>16&255,S[k|14]=q>>>8&255,S[k|15]=q&255,16)}function D(k){return k=k|0,k&15?-1:(S[k|0]=V>>>24,S[k|1]=V>>>16&255,S[k|2]=V>>>8&255,S[k|3]=V&255,S[k|4]=Z>>>24,S[k|5]=Z>>>16&255,S[k|6]=Z>>>8&255,S[k|7]=Z&255,S[k|8]=tt>>>24,S[k|9]=tt>>>16&255,S[k|10]=tt>>>8&255,S[k|11]=tt&255,S[k|12]=rt>>>24,S[k|13]=rt>>>16&255,S[k|14]=rt>>>8&255,S[k|15]=rt&255,16)}function U(){w(0,0,0,0),pt=F,gt=E,dt=$,ht=q}function K(k,b,et){k=k|0,b=b|0,et=et|0;var it=0;if(b&15)return-1;for(;(et|0)>=16;)T[k&7](S[b|0]<<24|S[b|1]<<16|S[b|2]<<8|S[b|3],S[b|4]<<24|S[b|5]<<16|S[b|6]<<8|S[b|7],S[b|8]<<24|S[b|9]<<16|S[b|10]<<8|S[b|11],S[b|12]<<24|S[b|13]<<16|S[b|14]<<8|S[b|15]),S[b|0]=F>>>24,S[b|1]=F>>>16&255,S[b|2]=F>>>8&255,S[b|3]=F&255,S[b|4]=E>>>24,S[b|5]=E>>>16&255,S[b|6]=E>>>8&255,S[b|7]=E&255,S[b|8]=$>>>24,S[b|9]=$>>>16&255,S[b|10]=$>>>8&255,S[b|11]=$&255,S[b|12]=q>>>24,S[b|13]=q>>>16&255,S[b|14]=q>>>8&255,S[b|15]=q&255,it=it+16|0,b=b+16|0,et=et-16|0;return it|0}function I(k,b,et){k=k|0,b=b|0,et=et|0;var it=0;if(b&15)return-1;for(;(et|0)>=16;)z[k&1](S[b|0]<<24|S[b|1]<<16|S[b|2]<<8|S[b|3],S[b|4]<<24|S[b|5]<<16|S[b|6]<<8|S[b|7],S[b|8]<<24|S[b|9]<<16|S[b|10]<<8|S[b|11],S[b|12]<<24|S[b|13]<<16|S[b|14]<<8|S[b|15]),it=it+16|0,b=b+16|0,et=et-16|0;return it|0}var T=[w,d,P,G,W,Q,y,f],z=[P,g];return{set_rounds:v,set_state:C,set_iv:x,set_nonce:B,set_mask:ct,set_counter:at,get_state:ut,get_iv:D,gcm_init:U,cipher:K,mac:I}}({Uint8Array,Uint32Array},l,_);return M.set_key=function(N,j,Y,F,E,$,q,V,Z){var tt=p.subarray(0,60),rt=p.subarray(256,316);tt.set([j,Y,F,E,$,q,V,Z]);for(var ft=N,lt=1;ft<4*N+28;ft++){var mt=tt[ft-1];(ft%N==0||N===8&&ft%N==4)&&(mt=i[mt>>>24]<<24^i[mt>>>16&255]<<16^i[mt>>>8&255]<<8^i[255&mt]),ft%N==0&&(mt=mt<<8^mt>>>24^lt<<24,lt=lt<<1^(128&lt?27:0)),tt[ft]=tt[ft-N]^mt}for(var L=0;L<ft;L+=4)for(var yt=0;yt<4;yt++)mt=tt[ft-(4+L)+(4-yt)%4],rt[L+yt]=L<4||L>=ft-4?mt:s[0][i[mt>>>24]]^s[1][i[mt>>>16&255]]^s[2][i[mt>>>8&255]]^s[3][i[255&mt]];M.set_rounds(N+5)},M};return h.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},h.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},h.MAC={CBC:0,GCM:1},h.HEAP_DATA=16384,h}();function Ra(r){return r instanceof Uint8Array}function ua(r,e){const t=r?r.byteLength:e||65536;if(4095&t||t<=0)throw Error("heap size must be a positive integer and a multiple of 4096");return r=r||new Uint8Array(new ArrayBuffer(t))}function Fr(r,e,t,n,i){const a=r.length-e,o=a<i?a:i;return r.set(t.subarray(n,n+o),e),o}function Br(...r){const e=r.reduce((i,a)=>i+a.length,0),t=new Uint8Array(e);let n=0;for(let i=0;i<r.length;i++)t.set(r[i],n),n+=r[i].length;return t}class Wi extends Error{constructor(...e){super(...e)}}class fr extends Error{constructor(...e){super(...e)}}class $i extends Error{constructor(...e){super(...e)}}const Ma=[],Na=[];class d1{constructor(e,t,n=!0,i,a,o){this.pos=0,this.len=0,this.mode=i,this.pos=0,this.len=0,this.key=e,this.iv=t,this.padding=n,this.acquire_asm(a,o)}acquire_asm(e,t){return this.heap!==void 0&&this.asm!==void 0||(this.heap=e||Ma.pop()||ua().subarray(Pt.HEAP_DATA),this.asm=t||Na.pop()||new Pt(null,this.heap.buffer),this.reset(this.key,this.iv)),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(Ma.push(this.heap),Na.push(this.asm)),this.heap=void 0,this.asm=void 0}reset(e,t){const{asm:n}=this.acquire_asm(),i=e.length;if(i!==16&&i!==24&&i!==32)throw new fr("illegal key size");const a=new DataView(e.buffer,e.byteOffset,e.byteLength);if(n.set_key(i>>2,a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12),i>16?a.getUint32(16):0,i>16?a.getUint32(20):0,i>24?a.getUint32(24):0,i>24?a.getUint32(28):0),t!==void 0){if(t.length!==16)throw new fr("illegal iv size");let o=new DataView(t.buffer,t.byteOffset,t.byteLength);n.set_iv(o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12))}else n.set_iv(0,0,0,0)}AES_Encrypt_process(e){if(!Ra(e))throw new TypeError("data isn't of expected type");let{heap:t,asm:n}=this.acquire_asm(),i=Pt.ENC[this.mode],a=Pt.HEAP_DATA,o=this.pos,s=this.len,u=0,c=e.length||0,h=0,l=0,_=new Uint8Array(s+c&-16);for(;c>0;)l=Fr(t,o+s,e,u,c),s+=l,u+=l,c-=l,l=n.cipher(i,a+o,s),l&&_.set(t.subarray(o,o+l),h),h+=l,l<s?(o+=l,s-=l):(o=0,s=0);return this.pos=o,this.len=s,_}AES_Encrypt_finish(){let{heap:e,asm:t}=this.acquire_asm(),n=Pt.ENC[this.mode],i=Pt.HEAP_DATA,a=this.pos,o=this.len,s=16-o%16,u=o;if(this.hasOwnProperty("padding")){if(this.padding){for(let h=0;h<s;++h)e[a+o+h]=s;o+=s,u=o}else if(o%16)throw new fr("data length must be a multiple of the block size")}else o+=s;const c=new Uint8Array(u);return o&&t.cipher(n,i+a,o),u&&c.set(e.subarray(a,a+u)),this.pos=0,this.len=0,this.release_asm(),c}AES_Decrypt_process(e){if(!Ra(e))throw new TypeError("data isn't of expected type");let{heap:t,asm:n}=this.acquire_asm(),i=Pt.DEC[this.mode],a=Pt.HEAP_DATA,o=this.pos,s=this.len,u=0,c=e.length||0,h=0,l=s+c&-16,_=0,p=0;this.padding&&(_=s+c-l||16,l-=_);const R=new Uint8Array(l);for(;c>0;)p=Fr(t,o+s,e,u,c),s+=p,u+=p,c-=p,p=n.cipher(i,a+o,s-(c?0:_)),p&&R.set(t.subarray(o,o+p),h),h+=p,p<s?(o+=p,s-=p):(o=0,s=0);return this.pos=o,this.len=s,R}AES_Decrypt_finish(){let{heap:e,asm:t}=this.acquire_asm(),n=Pt.DEC[this.mode],i=Pt.HEAP_DATA,a=this.pos,o=this.len,s=o;if(o>0){if(o%16){if(this.hasOwnProperty("padding"))throw new fr("data length must be a multiple of the block size");o+=16-o%16}if(t.cipher(n,i+a,o),this.hasOwnProperty("padding")&&this.padding){let c=e[a+s-1];if(c<1||c>16||c>s)throw new $i("bad padding");let h=0;for(let l=c;l>1;l--)h|=c^e[a+s-l];if(h)throw new $i("bad padding");s-=c}}const u=new Uint8Array(s);return s>0&&u.set(e.subarray(a,a+s)),this.pos=0,this.len=0,this.release_asm(),u}}class q1{static encrypt(e,t,n=!1){return new q1(t,n).encrypt(e)}static decrypt(e,t,n=!1){return new q1(t,n).decrypt(e)}constructor(e,t=!1,n){this.aes=n||new d1(e,void 0,t,"ECB")}encrypt(e){return Br(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return Br(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}}function ha(r){const e=function(t){const n=new q1(t);this.encrypt=function(i){return n.encrypt(i)},this.decrypt=function(i){return n.decrypt(i)}};return e.blockSize=e.prototype.blockSize=16,e.keySize=e.prototype.keySize=r/8,e}function Zn(r,e,t,n,i,a){const o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],_=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let R,M,N,j,Y,F,E,$,q,V,Z,tt,rt,ft,lt=0,mt=e.length;const L=r.length===32?3:9;$=L===3?t?[0,32,2]:[30,-2,-2]:t?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],t&&(e=function(H,nt){const pt=8-H.length%8;let gt;if(nt===2&&pt<8)gt=32;else if(nt===1)gt=pt;else{if(nt||!(pt<8)){if(pt===8)return H;throw Error("des: invalid padding")}gt=0}const dt=new Uint8Array(H.length+pt);for(let ht=0;ht<H.length;ht++)dt[ht]=H[ht];for(let ht=0;ht<pt;ht++)dt[H.length+ht]=gt;return dt}(e,a),mt=e.length);let yt=new Uint8Array(mt),Ct=0;for(n===1&&(q=i[lt++]<<24|i[lt++]<<16|i[lt++]<<8|i[lt++],Z=i[lt++]<<24|i[lt++]<<16|i[lt++]<<8|i[lt++],lt=0);lt<mt;){for(F=e[lt++]<<24|e[lt++]<<16|e[lt++]<<8|e[lt++],E=e[lt++]<<24|e[lt++]<<16|e[lt++]<<8|e[lt++],n===1&&(t?(F^=q,E^=Z):(V=q,tt=Z,q=F,Z=E)),N=252645135&(F>>>4^E),E^=N,F^=N<<4,N=65535&(F>>>16^E),E^=N,F^=N<<16,N=858993459&(E>>>2^F),F^=N,E^=N<<2,N=16711935&(E>>>8^F),F^=N,E^=N<<8,N=1431655765&(F>>>1^E),E^=N,F^=N<<1,F=F<<1|F>>>31,E=E<<1|E>>>31,M=0;M<L;M+=3){for(rt=$[M+1],ft=$[M+2],R=$[M];R!==rt;R+=ft)j=E^r[R],Y=(E>>>4|E<<28)^r[R+1],N=F,F=E,E=N^(s[j>>>24&63]|c[j>>>16&63]|l[j>>>8&63]|p[63&j]|o[Y>>>24&63]|u[Y>>>16&63]|h[Y>>>8&63]|_[63&Y]);N=F,F=E,E=N}F=F>>>1|F<<31,E=E>>>1|E<<31,N=1431655765&(F>>>1^E),E^=N,F^=N<<1,N=16711935&(E>>>8^F),F^=N,E^=N<<8,N=858993459&(E>>>2^F),F^=N,E^=N<<2,N=65535&(F>>>16^E),E^=N,F^=N<<16,N=252645135&(F>>>4^E),E^=N,F^=N<<4,n===1&&(t?(q=F,Z=E):(F^=V,E^=tt)),yt[Ct++]=F>>>24,yt[Ct++]=F>>>16&255,yt[Ct++]=F>>>8&255,yt[Ct++]=255&F,yt[Ct++]=E>>>24,yt[Ct++]=E>>>16&255,yt[Ct++]=E>>>8&255,yt[Ct++]=255&E}return t||(yt=function(H,nt){let pt,gt=null;if(nt===2)pt=32;else if(nt===1)gt=H[H.length-1];else{if(nt)throw Error("des: invalid padding");pt=0}if(!gt){for(gt=1;H[H.length-gt]===pt;)gt++;gt--}return H.subarray(0,H.length-gt)}(yt,a)),yt}function Qn(r){const e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],s=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],_=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],R=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],M=r.length>8?3:1,N=Array(32*M),j=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let Y,F,E,$=0,q=0;for(let V=0;V<M;V++){let Z=r[$++]<<24|r[$++]<<16|r[$++]<<8|r[$++],tt=r[$++]<<24|r[$++]<<16|r[$++]<<8|r[$++];E=252645135&(Z>>>4^tt),tt^=E,Z^=E<<4,E=65535&(tt>>>-16^Z),Z^=E,tt^=E<<-16,E=858993459&(Z>>>2^tt),tt^=E,Z^=E<<2,E=65535&(tt>>>-16^Z),Z^=E,tt^=E<<-16,E=1431655765&(Z>>>1^tt),tt^=E,Z^=E<<1,E=16711935&(tt>>>8^Z),Z^=E,tt^=E<<8,E=1431655765&(Z>>>1^tt),tt^=E,Z^=E<<1,E=Z<<8|tt>>>20&240,Z=tt<<24|tt<<8&16711680|tt>>>8&65280|tt>>>24&240,tt=E;for(let rt=0;rt<16;rt++)j[rt]?(Z=Z<<2|Z>>>26,tt=tt<<2|tt>>>26):(Z=Z<<1|Z>>>27,tt=tt<<1|tt>>>27),Z&=-15,tt&=-15,Y=e[Z>>>28]|t[Z>>>24&15]|n[Z>>>20&15]|i[Z>>>16&15]|a[Z>>>12&15]|o[Z>>>8&15]|s[Z>>>4&15],F=u[tt>>>28]|c[tt>>>24&15]|h[tt>>>20&15]|l[tt>>>16&15]|_[tt>>>12&15]|p[tt>>>8&15]|R[tt>>>4&15],E=65535&(F>>>16^Y),N[q++]=Y^E,N[q++]=F^E<<16}return N}function Nn(r){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(r.subarray(8*e,8*e+8)));this.encrypt=function(e){return Zn(Qn(this.key[2]),Zn(Qn(this.key[1]),Zn(Qn(this.key[0]),e,!0,0,null,null),!1,0,null,null),!0,0,null,null)}}function X2(){this.BlockSize=8,this.KeySize=16,this.setKey=function(o){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),o.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(o),!0},this.reset=function(){for(let o=0;o<16;o++)this.masking[o]=0,this.rotate[o]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(o){const s=Array(o.length);for(let u=0;u<o.length;u+=8){let c,h=o[u]<<24|o[u+1]<<16|o[u+2]<<8|o[u+3],l=o[u+4]<<24|o[u+5]<<16|o[u+6]<<8|o[u+7];c=l,l=h^t(l,this.masking[0],this.rotate[0]),h=c,c=l,l=h^n(l,this.masking[1],this.rotate[1]),h=c,c=l,l=h^i(l,this.masking[2],this.rotate[2]),h=c,c=l,l=h^t(l,this.masking[3],this.rotate[3]),h=c,c=l,l=h^n(l,this.masking[4],this.rotate[4]),h=c,c=l,l=h^i(l,this.masking[5],this.rotate[5]),h=c,c=l,l=h^t(l,this.masking[6],this.rotate[6]),h=c,c=l,l=h^n(l,this.masking[7],this.rotate[7]),h=c,c=l,l=h^i(l,this.masking[8],this.rotate[8]),h=c,c=l,l=h^t(l,this.masking[9],this.rotate[9]),h=c,c=l,l=h^n(l,this.masking[10],this.rotate[10]),h=c,c=l,l=h^i(l,this.masking[11],this.rotate[11]),h=c,c=l,l=h^t(l,this.masking[12],this.rotate[12]),h=c,c=l,l=h^n(l,this.masking[13],this.rotate[13]),h=c,c=l,l=h^i(l,this.masking[14],this.rotate[14]),h=c,c=l,l=h^t(l,this.masking[15],this.rotate[15]),h=c,s[u]=l>>>24&255,s[u+1]=l>>>16&255,s[u+2]=l>>>8&255,s[u+3]=255&l,s[u+4]=h>>>24&255,s[u+5]=h>>>16&255,s[u+6]=h>>>8&255,s[u+7]=255&h}return s},this.decrypt=function(o){const s=Array(o.length);for(let u=0;u<o.length;u+=8){let c,h=o[u]<<24|o[u+1]<<16|o[u+2]<<8|o[u+3],l=o[u+4]<<24|o[u+5]<<16|o[u+6]<<8|o[u+7];c=l,l=h^t(l,this.masking[15],this.rotate[15]),h=c,c=l,l=h^i(l,this.masking[14],this.rotate[14]),h=c,c=l,l=h^n(l,this.masking[13],this.rotate[13]),h=c,c=l,l=h^t(l,this.masking[12],this.rotate[12]),h=c,c=l,l=h^i(l,this.masking[11],this.rotate[11]),h=c,c=l,l=h^n(l,this.masking[10],this.rotate[10]),h=c,c=l,l=h^t(l,this.masking[9],this.rotate[9]),h=c,c=l,l=h^i(l,this.masking[8],this.rotate[8]),h=c,c=l,l=h^n(l,this.masking[7],this.rotate[7]),h=c,c=l,l=h^t(l,this.masking[6],this.rotate[6]),h=c,c=l,l=h^i(l,this.masking[5],this.rotate[5]),h=c,c=l,l=h^n(l,this.masking[4],this.rotate[4]),h=c,c=l,l=h^t(l,this.masking[3],this.rotate[3]),h=c,c=l,l=h^i(l,this.masking[2],this.rotate[2]),h=c,c=l,l=h^n(l,this.masking[1],this.rotate[1]),h=c,c=l,l=h^t(l,this.masking[0],this.rotate[0]),h=c,s[u]=l>>>24&255,s[u+1]=l>>>16&255,s[u+2]=l>>>8&255,s[u+3]=255&l,s[u+4]=h>>>24&255,s[u+5]=h>>16&255,s[u+6]=h>>8&255,s[u+7]=255&h}return s};const r=[,,,,];r[0]=[,,,,],r[0][0]=[4,0,13,15,12,14,8],r[0][1]=[5,2,16,18,17,19,10],r[0][2]=[6,3,23,22,21,20,9],r[0][3]=[7,1,26,25,27,24,11],r[1]=[,,,,],r[1][0]=[0,6,21,23,20,22,16],r[1][1]=[1,4,0,2,1,3,18],r[1][2]=[2,5,7,6,5,4,17],r[1][3]=[3,7,10,9,11,8,19],r[2]=[,,,,],r[2][0]=[4,0,13,15,12,14,8],r[2][1]=[5,2,16,18,17,19,10],r[2][2]=[6,3,23,22,21,20,9],r[2][3]=[7,1,26,25,27,24,11],r[3]=[,,,,],r[3][0]=[0,6,21,23,20,22,16],r[3][1]=[1,4,0,2,1,3,18],r[3][2]=[2,5,7,6,5,4,17],r[3][3]=[3,7,10,9,11,8,19];const e=[,,,,];function t(o,s,u){const c=s+o,h=c<<u|c>>>32-u;return(a[0][h>>>24]^a[1][h>>>16&255])-a[2][h>>>8&255]+a[3][255&h]}function n(o,s,u){const c=s^o,h=c<<u|c>>>32-u;return a[0][h>>>24]-a[1][h>>>16&255]+a[2][h>>>8&255]^a[3][255&h]}function i(o,s,u){const c=s-o,h=c<<u|c>>>32-u;return(a[0][h>>>24]+a[1][h>>>16&255]^a[2][h>>>8&255])-a[3][255&h]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(o){const s=[,,,,,,,,],u=Array(32);let c;for(let p=0;p<4;p++)c=4*p,s[p]=o[c]<<24|o[c+1]<<16|o[c+2]<<8|o[c+3];const h=[6,7,4,5];let l,_=0;for(let p=0;p<2;p++)for(let R=0;R<4;R++){for(c=0;c<4;c++){const M=r[R][c];l=s[M[1]],l^=a[4][s[M[2]>>>2]>>>24-8*(3&M[2])&255],l^=a[5][s[M[3]>>>2]>>>24-8*(3&M[3])&255],l^=a[6][s[M[4]>>>2]>>>24-8*(3&M[4])&255],l^=a[7][s[M[5]>>>2]>>>24-8*(3&M[5])&255],l^=a[h[c]][s[M[6]>>>2]>>>24-8*(3&M[6])&255],s[M[0]]=l}for(c=0;c<4;c++){const M=e[R][c];l=a[4][s[M[0]>>>2]>>>24-8*(3&M[0])&255],l^=a[5][s[M[1]>>>2]>>>24-8*(3&M[1])&255],l^=a[6][s[M[2]>>>2]>>>24-8*(3&M[2])&255],l^=a[7][s[M[3]>>>2]>>>24-8*(3&M[3])&255],l^=a[4+c][s[M[4]>>>2]>>>24-8*(3&M[4])&255],u[_]=l,_++}}for(let p=0;p<16;p++)this.masking[p]=u[p],this.rotate[p]=31&u[16+p]};const a=[,,,,,,,,];a[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],a[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],a[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],a[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],a[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],a[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],a[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],a[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Ln(r){this.cast5=new X2,this.cast5.setKey(r),this.encrypt=function(e){return this.cast5.encrypt(e)}}Nn.keySize=Nn.prototype.keySize=24,Nn.blockSize=Nn.prototype.blockSize=8,Ln.blockSize=Ln.prototype.blockSize=8,Ln.keySize=Ln.prototype.keySize=16;const _e=4294967295;function ze(r,e){return(r<<e|r>>>32-e)&_e}function ir(r,e){return r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24}function kr(r,e,t){r.splice(e,4,255&t,t>>>8&255,t>>>16&255,t>>>24&255)}function _t(r,e){return r>>>8*e&255}function On(r){this.tf=function(){let e=null,t=null,n=-1,i=[],a=[[],[],[],[]];function o(h){return a[0][_t(h,0)]^a[1][_t(h,1)]^a[2][_t(h,2)]^a[3][_t(h,3)]}function s(h){return a[0][_t(h,3)]^a[1][_t(h,0)]^a[2][_t(h,1)]^a[3][_t(h,2)]}function u(h,l){let _=o(l[0]),p=s(l[1]);l[2]=ze(l[2]^_+p+i[4*h+8]&_e,31),l[3]=ze(l[3],1)^_+2*p+i[4*h+9]&_e,_=o(l[2]),p=s(l[3]),l[0]=ze(l[0]^_+p+i[4*h+10]&_e,31),l[1]=ze(l[1],1)^_+2*p+i[4*h+11]&_e}function c(h,l){let _=o(l[0]),p=s(l[1]);l[2]=ze(l[2],1)^_+p+i[4*h+10]&_e,l[3]=ze(l[3]^_+2*p+i[4*h+11]&_e,31),_=o(l[2]),p=s(l[3]),l[0]=ze(l[0],1)^_+p+i[4*h+8]&_e,l[1]=ze(l[1]^_+2*p+i[4*h+9]&_e,31)}return{name:"twofish",blocksize:16,open:function(h){let l,_,p,R,M;e=h;const N=[],j=[],Y=[];let F;const E=[];let $,q,V;const Z=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],tt=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],rt=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],ft=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],lt=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],mt=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],L=[[],[]],yt=[[],[],[],[]];function Ct(dt){return dt^dt>>2^[0,90,180,238][3&dt]}function H(dt){return dt^dt>>1^dt>>2^[0,238,180,90][3&dt]}function nt(dt,ht){let wt,st,S;for(wt=0;wt<8;wt++)st=ht>>>24,ht=ht<<8&_e|dt>>>24,dt=dt<<8&_e,S=st<<1,128&st&&(S^=333),ht^=st^S<<16,S^=st>>>1,1&st&&(S^=166),ht^=S<<24|S<<8;return ht}function pt(dt,ht){const wt=ht>>4,st=15&ht,S=Z[dt][wt^st],O=tt[dt][lt[st]^mt[wt]];return ft[dt][lt[O]^mt[S]]<<4|rt[dt][S^O]}function gt(dt,ht){let wt=_t(dt,0),st=_t(dt,1),S=_t(dt,2),O=_t(dt,3);switch(F){case 4:wt=L[1][wt]^_t(ht[3],0),st=L[0][st]^_t(ht[3],1),S=L[0][S]^_t(ht[3],2),O=L[1][O]^_t(ht[3],3);case 3:wt=L[1][wt]^_t(ht[2],0),st=L[1][st]^_t(ht[2],1),S=L[0][S]^_t(ht[2],2),O=L[0][O]^_t(ht[2],3);case 2:wt=L[0][L[0][wt]^_t(ht[1],0)]^_t(ht[0],0),st=L[0][L[1][st]^_t(ht[1],1)]^_t(ht[0],1),S=L[1][L[0][S]^_t(ht[1],2)]^_t(ht[0],2),O=L[1][L[1][O]^_t(ht[1],3)]^_t(ht[0],3)}return yt[0][wt]^yt[1][st]^yt[2][S]^yt[3][O]}for(e=e.slice(0,32),l=e.length;l!==16&&l!==24&&l!==32;)e[l++]=0;for(l=0;l<e.length;l+=4)Y[l>>2]=ir(e,l);for(l=0;l<256;l++)L[0][l]=pt(0,l),L[1][l]=pt(1,l);for(l=0;l<256;l++)$=L[1][l],q=Ct($),V=H($),yt[0][l]=$+(q<<8)+(V<<16)+(V<<24),yt[2][l]=q+(V<<8)+($<<16)+(V<<24),$=L[0][l],q=Ct($),V=H($),yt[1][l]=V+(V<<8)+(q<<16)+($<<24),yt[3][l]=q+($<<8)+(V<<16)+(q<<24);for(F=Y.length/2,l=0;l<F;l++)_=Y[l+l],N[l]=_,p=Y[l+l+1],j[l]=p,E[F-l-1]=nt(_,p);for(l=0;l<40;l+=2)_=16843009*l,p=_+16843009,_=gt(_,N),p=ze(gt(p,j),8),i[l]=_+p&_e,i[l+1]=ze(_+2*p,9);for(l=0;l<256;l++)switch(_=p=R=M=l,F){case 4:_=L[1][_]^_t(E[3],0),p=L[0][p]^_t(E[3],1),R=L[0][R]^_t(E[3],2),M=L[1][M]^_t(E[3],3);case 3:_=L[1][_]^_t(E[2],0),p=L[1][p]^_t(E[2],1),R=L[0][R]^_t(E[2],2),M=L[0][M]^_t(E[2],3);case 2:a[0][l]=yt[0][L[0][L[0][_]^_t(E[1],0)]^_t(E[0],0)],a[1][l]=yt[1][L[0][L[1][p]^_t(E[1],1)]^_t(E[0],1)],a[2][l]=yt[2][L[1][L[0][R]^_t(E[1],2)]^_t(E[0],2)],a[3][l]=yt[3][L[1][L[1][M]^_t(E[1],3)]^_t(E[0],3)]}},close:function(){i=[],a=[[],[],[],[]]},encrypt:function(h,l){t=h,n=l;const _=[ir(t,n)^i[0],ir(t,n+4)^i[1],ir(t,n+8)^i[2],ir(t,n+12)^i[3]];for(let p=0;p<8;p++)u(p,_);return kr(t,n,_[2]^i[4]),kr(t,n+4,_[3]^i[5]),kr(t,n+8,_[0]^i[6]),kr(t,n+12,_[1]^i[7]),n+=16,t},decrypt:function(h,l){t=h,n=l;const _=[ir(t,n)^i[4],ir(t,n+4)^i[5],ir(t,n+8)^i[6],ir(t,n+12)^i[7]];for(let p=7;p>=0;p--)c(p,_);kr(t,n,_[2]^i[0]),kr(t,n+4,_[3]^i[1]),kr(t,n+8,_[0]^i[2]),kr(t,n+12,_[1]^i[3]),n+=16},finalize:function(){return t}}}(),this.tf.open(Array.from(r),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function Ke(){}function Fn(r){this.bf=new Ke,this.bf.init(r),this.encrypt=function(e){return this.bf.encryptBlock(e)}}On.keySize=On.prototype.keySize=32,On.blockSize=On.prototype.blockSize=16,Ke.prototype.BLOCKSIZE=8,Ke.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],Ke.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Ke.prototype.NN=16,Ke.prototype._clean=function(r){return r<0&&(r=(2147483647&r)+2147483648),r},Ke.prototype._F=function(r){let e;const t=255&r,n=255&(r>>>=8),i=255&(r>>>=8),a=255&(r>>>=8);return e=this.sboxes[0][a]+this.sboxes[1][i],e^=this.sboxes[2][n],e+=this.sboxes[3][t],e},Ke.prototype._encryptBlock=function(r){let e,t=r[0],n=r[1];for(e=0;e<this.NN;++e){t^=this.parray[e],n=this._F(t)^n;const i=t;t=n,n=i}t^=this.parray[this.NN+0],n^=this.parray[this.NN+1],r[0]=this._clean(n),r[1]=this._clean(t)},Ke.prototype.encryptBlock=function(r){let e;const t=[0,0],n=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)t[0]=t[0]<<8|255&r[e+0],t[1]=t[1]<<8|255&r[e+n];this._encryptBlock(t);const i=[];for(e=0;e<this.BLOCKSIZE/2;++e)i[e+0]=t[0]>>>24-8*e&255,i[e+n]=t[1]>>>24-8*e&255;return i},Ke.prototype._decryptBlock=function(r){let e,t=r[0],n=r[1];for(e=this.NN+1;e>1;--e){t^=this.parray[e],n=this._F(t)^n;const i=t;t=n,n=i}t^=this.parray[1],n^=this.parray[0],r[0]=this._clean(n),r[1]=this._clean(t)},Ke.prototype.init=function(r){let e,t=0;for(this.parray=[],e=0;e<this.NN+2;++e){let i=0;for(let a=0;a<4;++a)i=i<<8|255&r[t],++t>=r.length&&(t=0);this.parray[e]=this.PARRAY[e]^i}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],t=0;t<256;++t)this.sboxes[e][t]=this.SBOXES[e][t];const n=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(n),this.parray[e+0]=n[0],this.parray[e+1]=n[1];for(e=0;e<4;++e)for(t=0;t<256;t+=2)this._encryptBlock(n),this.sboxes[e][t+0]=n[0],this.sboxes[e][t+1]=n[1]},Fn.keySize=Fn.prototype.keySize=16,Fn.blockSize=Fn.prototype.blockSize=8;const J2=ha(128),t3=ha(192),e3=ha(256);var f1=Object.freeze({__proto__:null,aes128:J2,aes192:t3,aes256:e3,des:function(r){this.key=r,this.encrypt=function(e,t){return Zn(Qn(this.key),e,!0,0,null,t)},this.decrypt=function(e,t){return Zn(Qn(this.key),e,!1,0,null,t)}},tripledes:Nn,cast5:Ln,twofish:On,blowfish:Fn,idea:function(){throw Error("IDEA symmetric-key algorithm not implemented")}}),S0=function(r,e,t){var n=0,i=0,a=0,o=0,s=0,u=0,c=0,h=0,l=0,_=0,p=0,R=0,M=0,N=0,j=0,Y=0,F=0,E=new r.Uint8Array(t);function $(H,nt,pt,gt,dt,ht,wt,st,S,O,w,d,P,G,W,Q){H=H|0,nt=nt|0,pt=pt|0,gt=gt|0,dt=dt|0,ht=ht|0,wt=wt|0,st=st|0,S=S|0,O=O|0,w=w|0,d=d|0,P=P|0,G=G|0,W=W|0,Q=Q|0;var y=0,f=0,g=0,v=0,C=0,x=0,B=0,ct=0,at=0,ut=0,D=0,U=0,K=0,I=0,T=0,z=0,k=0,b=0,et=0,it=0,St=0,It=0,zt=0,Kt=0,Vt=0,Yt=0,Jt=0,ee=0,Ut=0,Nt=0,Rt=0,Et=0,qt=0,Ot=0,Ht=0,X=0,J=0,ot=0,bt=0,kt=0,xt=0,vt=0,Lt=0,jt=0,Se=0,xe=0,Pe=0,Be=0,Qr=0,Yr=0,Xr=0,Jr=0,tn=0,en=0,rn=0,Kn=0,Dn=0,g1=0,m1=0,w1=0,b1=0,k1=0,v1=0,mi=0,wi=0,bi=0,ki=0,vi=0,Ea=0,Sa=0,xa=0;y=n,f=i,g=a,v=o,C=s,B=H+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=nt+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=pt+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=gt+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=dt+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=ht+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=wt+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=st+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=S+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=O+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=w+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=d+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=P+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=G+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=W+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,B=Q+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=G^S^pt^H,ct=x<<1|x>>>31,B=ct+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=W^O^gt^nt,at=x<<1|x>>>31,B=at+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Q^w^dt^pt,ut=x<<1|x>>>31,B=ut+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=ct^d^ht^gt,D=x<<1|x>>>31,B=D+(y<<5|y>>>27)+C+(f&g|~f&v)+1518500249|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=at^P^wt^dt,U=x<<1|x>>>31,B=U+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=ut^G^st^ht,K=x<<1|x>>>31,B=K+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=D^W^S^wt,I=x<<1|x>>>31,B=I+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=U^Q^O^st,T=x<<1|x>>>31,B=T+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=K^ct^w^S,z=x<<1|x>>>31,B=z+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=I^at^d^O,k=x<<1|x>>>31,B=k+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=T^ut^P^w,b=x<<1|x>>>31,B=b+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=z^D^G^d,et=x<<1|x>>>31,B=et+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=k^U^W^P,it=x<<1|x>>>31,B=it+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=b^K^Q^G,St=x<<1|x>>>31,B=St+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=et^I^ct^W,It=x<<1|x>>>31,B=It+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=it^T^at^Q,zt=x<<1|x>>>31,B=zt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=St^z^ut^ct,Kt=x<<1|x>>>31,B=Kt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=It^k^D^at,Vt=x<<1|x>>>31,B=Vt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=zt^b^U^ut,Yt=x<<1|x>>>31,B=Yt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Kt^et^K^D,Jt=x<<1|x>>>31,B=Jt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Vt^it^I^U,ee=x<<1|x>>>31,B=ee+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Yt^St^T^K,Ut=x<<1|x>>>31,B=Ut+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Jt^It^z^I,Nt=x<<1|x>>>31,B=Nt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=ee^zt^k^T,Rt=x<<1|x>>>31,B=Rt+(y<<5|y>>>27)+C+(f^g^v)+1859775393|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Ut^Kt^b^z,Et=x<<1|x>>>31,B=Et+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Nt^Vt^et^k,qt=x<<1|x>>>31,B=qt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Rt^Yt^it^b,Ot=x<<1|x>>>31,B=Ot+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Et^Jt^St^et,Ht=x<<1|x>>>31,B=Ht+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=qt^ee^It^it,X=x<<1|x>>>31,B=X+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Ot^Ut^zt^St,J=x<<1|x>>>31,B=J+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Ht^Nt^Kt^It,ot=x<<1|x>>>31,B=ot+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=X^Rt^Vt^zt,bt=x<<1|x>>>31,B=bt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=J^Et^Yt^Kt,kt=x<<1|x>>>31,B=kt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=ot^qt^Jt^Vt,xt=x<<1|x>>>31,B=xt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=bt^Ot^ee^Yt,vt=x<<1|x>>>31,B=vt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=kt^Ht^Ut^Jt,Lt=x<<1|x>>>31,B=Lt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=xt^X^Nt^ee,jt=x<<1|x>>>31,B=jt+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=vt^J^Rt^Ut,Se=x<<1|x>>>31,B=Se+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Lt^ot^Et^Nt,xe=x<<1|x>>>31,B=xe+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=jt^bt^qt^Rt,Pe=x<<1|x>>>31,B=Pe+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Se^kt^Ot^Et,Be=x<<1|x>>>31,B=Be+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=xe^xt^Ht^qt,Qr=x<<1|x>>>31,B=Qr+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Pe^vt^X^Ot,Yr=x<<1|x>>>31,B=Yr+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Be^Lt^J^Ht,Xr=x<<1|x>>>31,B=Xr+(y<<5|y>>>27)+C+(f&g|f&v|g&v)-1894007588|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Qr^jt^ot^X,Jr=x<<1|x>>>31,B=Jr+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Yr^Se^bt^J,tn=x<<1|x>>>31,B=tn+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Xr^xe^kt^ot,en=x<<1|x>>>31,B=en+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Jr^Pe^xt^bt,rn=x<<1|x>>>31,B=rn+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=tn^Be^vt^kt,Kn=x<<1|x>>>31,B=Kn+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=en^Qr^Lt^xt,Dn=x<<1|x>>>31,B=Dn+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=rn^Yr^jt^vt,g1=x<<1|x>>>31,B=g1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Kn^Xr^Se^Lt,m1=x<<1|x>>>31,B=m1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=Dn^Jr^xe^jt,w1=x<<1|x>>>31,B=w1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=g1^tn^Pe^Se,b1=x<<1|x>>>31,B=b1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=m1^en^Be^xe,k1=x<<1|x>>>31,B=k1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=w1^rn^Qr^Pe,v1=x<<1|x>>>31,B=v1+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=b1^Kn^Yr^Be,mi=x<<1|x>>>31,B=mi+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=k1^Dn^Xr^Qr,wi=x<<1|x>>>31,B=wi+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=v1^g1^Jr^Yr,bi=x<<1|x>>>31,B=bi+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=mi^m1^tn^Xr,ki=x<<1|x>>>31,B=ki+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=wi^w1^en^Jr,vi=x<<1|x>>>31,B=vi+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=bi^b1^rn^tn,Ea=x<<1|x>>>31,B=Ea+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=ki^k1^Kn^en,Sa=x<<1|x>>>31,B=Sa+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,x=vi^v1^Dn^rn,xa=x<<1|x>>>31,B=xa+(y<<5|y>>>27)+C+(f^g^v)-899497514|0,C=v,v=g,g=f<<30|f>>>2,f=y,y=B,n=n+y|0,i=i+f|0,a=a+g|0,o=o+v|0,s=s+C|0}function q(H){H=H|0,$(E[H|0]<<24|E[H|1]<<16|E[H|2]<<8|E[H|3],E[H|4]<<24|E[H|5]<<16|E[H|6]<<8|E[H|7],E[H|8]<<24|E[H|9]<<16|E[H|10]<<8|E[H|11],E[H|12]<<24|E[H|13]<<16|E[H|14]<<8|E[H|15],E[H|16]<<24|E[H|17]<<16|E[H|18]<<8|E[H|19],E[H|20]<<24|E[H|21]<<16|E[H|22]<<8|E[H|23],E[H|24]<<24|E[H|25]<<16|E[H|26]<<8|E[H|27],E[H|28]<<24|E[H|29]<<16|E[H|30]<<8|E[H|31],E[H|32]<<24|E[H|33]<<16|E[H|34]<<8|E[H|35],E[H|36]<<24|E[H|37]<<16|E[H|38]<<8|E[H|39],E[H|40]<<24|E[H|41]<<16|E[H|42]<<8|E[H|43],E[H|44]<<24|E[H|45]<<16|E[H|46]<<8|E[H|47],E[H|48]<<24|E[H|49]<<16|E[H|50]<<8|E[H|51],E[H|52]<<24|E[H|53]<<16|E[H|54]<<8|E[H|55],E[H|56]<<24|E[H|57]<<16|E[H|58]<<8|E[H|59],E[H|60]<<24|E[H|61]<<16|E[H|62]<<8|E[H|63])}function V(H){H=H|0,E[H|0]=n>>>24,E[H|1]=n>>>16&255,E[H|2]=n>>>8&255,E[H|3]=n&255,E[H|4]=i>>>24,E[H|5]=i>>>16&255,E[H|6]=i>>>8&255,E[H|7]=i&255,E[H|8]=a>>>24,E[H|9]=a>>>16&255,E[H|10]=a>>>8&255,E[H|11]=a&255,E[H|12]=o>>>24,E[H|13]=o>>>16&255,E[H|14]=o>>>8&255,E[H|15]=o&255,E[H|16]=s>>>24,E[H|17]=s>>>16&255,E[H|18]=s>>>8&255,E[H|19]=s&255}function Z(){n=1732584193,i=4023233417,a=2562383102,o=271733878,s=3285377520,u=c=0}function tt(H,nt,pt,gt,dt,ht,wt){H=H|0,nt=nt|0,pt=pt|0,gt=gt|0,dt=dt|0,ht=ht|0,wt=wt|0,n=H,i=nt,a=pt,o=gt,s=dt,u=ht,c=wt}function rt(H,nt){H=H|0,nt=nt|0;var pt=0;if(H&63)return-1;for(;(nt|0)>=64;)q(H),H=H+64|0,nt=nt-64|0,pt=pt+64|0;return u=u+pt|0,u>>>0<pt>>>0&&(c=c+1|0),pt|0}function ft(H,nt,pt){H=H|0,nt=nt|0,pt=pt|0;var gt=0,dt=0;if(H&63||~pt&&pt&31)return-1;if((nt|0)>=64){if(gt=rt(H,nt)|0,(gt|0)==-1)return-1;H=H+gt|0,nt=nt-gt|0}if(gt=gt+nt|0,u=u+nt|0,u>>>0<nt>>>0&&(c=c+1|0),E[H|nt]=128,(nt|0)>=56){for(dt=nt+1|0;(dt|0)<64;dt=dt+1|0)E[H|dt]=0;q(H),nt=0,E[H|0]=0}for(dt=nt+1|0;(dt|0)<59;dt=dt+1|0)E[H|dt]=0;return E[H|56]=c>>>21&255,E[H|57]=c>>>13&255,E[H|58]=c>>>5&255,E[H|59]=c<<3&255|u>>>29,E[H|60]=u>>>21&255,E[H|61]=u>>>13&255,E[H|62]=u>>>5&255,E[H|63]=u<<3&255,q(H),~pt&&V(pt),gt|0}function lt(){n=h,i=l,a=_,o=p,s=R,u=64,c=0}function mt(){n=M,i=N,a=j,o=Y,s=F,u=64,c=0}function L(H,nt,pt,gt,dt,ht,wt,st,S,O,w,d,P,G,W,Q){H=H|0,nt=nt|0,pt=pt|0,gt=gt|0,dt=dt|0,ht=ht|0,wt=wt|0,st=st|0,S=S|0,O=O|0,w=w|0,d=d|0,P=P|0,G=G|0,W=W|0,Q=Q|0,Z(),$(H^1549556828,nt^1549556828,pt^1549556828,gt^1549556828,dt^1549556828,ht^1549556828,wt^1549556828,st^1549556828,S^1549556828,O^1549556828,w^1549556828,d^1549556828,P^1549556828,G^1549556828,W^1549556828,Q^1549556828),M=n,N=i,j=a,Y=o,F=s,Z(),$(H^909522486,nt^909522486,pt^909522486,gt^909522486,dt^909522486,ht^909522486,wt^909522486,st^909522486,S^909522486,O^909522486,w^909522486,d^909522486,P^909522486,G^909522486,W^909522486,Q^909522486),h=n,l=i,_=a,p=o,R=s,u=64,c=0}function yt(H,nt,pt){H=H|0,nt=nt|0,pt=pt|0;var gt=0,dt=0,ht=0,wt=0,st=0,S=0;return H&63||~pt&&pt&31?-1:(S=ft(H,nt,-1)|0,gt=n,dt=i,ht=a,wt=o,st=s,mt(),$(gt,dt,ht,wt,st,2147483648,0,0,0,0,0,0,0,0,0,672),~pt&&V(pt),S|0)}function Ct(H,nt,pt,gt,dt){H=H|0,nt=nt|0,pt=pt|0,gt=gt|0,dt=dt|0;var ht=0,wt=0,st=0,S=0,O=0,w=0,d=0,P=0,G=0,W=0;if(H&63||~dt&&dt&31)return-1;for(E[H+nt|0]=pt>>>24,E[H+nt+1|0]=pt>>>16&255,E[H+nt+2|0]=pt>>>8&255,E[H+nt+3|0]=pt&255,yt(H,nt+4|0,-1)|0,ht=w=n,wt=d=i,st=P=a,S=G=o,O=W=s,gt=gt-1|0;(gt|0)>0;)lt(),$(w,d,P,G,W,2147483648,0,0,0,0,0,0,0,0,0,672),w=n,d=i,P=a,G=o,W=s,mt(),$(w,d,P,G,W,2147483648,0,0,0,0,0,0,0,0,0,672),w=n,d=i,P=a,G=o,W=s,ht=ht^n,wt=wt^i,st=st^a,S=S^o,O=O^s,gt=gt-1|0;return n=ht,i=wt,a=st,o=S,s=O,~dt&&V(dt),0}return{reset:Z,init:tt,process:rt,finish:ft,hmac_reset:lt,hmac_init:L,hmac_finish:yt,pbkdf2_generate_block:Ct}};class x0{constructor(){this.pos=0,this.len=0}reset(){const{asm:e}=this.acquire_asm();return this.result=null,this.pos=0,this.len=0,e.reset(),this}process(e){if(this.result!==null)throw new Wi("state must be reset before processing new data");const{asm:t,heap:n}=this.acquire_asm();let i=this.pos,a=this.len,o=0,s=e.length,u=0;for(;s>0;)u=Fr(n,i+a,e,o,s),a+=u,o+=u,s-=u,u=t.process(i,a),i+=u,a-=u,a||(i=0);return this.pos=i,this.len=a,this}finish(){if(this.result!==null)throw new Wi("state must be reset before processing new data");const{asm:e,heap:t}=this.acquire_asm();return e.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(t.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this.release_asm(),this}}const La=[],Oa=[];class Hr extends x0{constructor(){super(),this.NAME="sha1",this.BLOCK_SIZE=64,this.HASH_SIZE=20,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=La.pop()||ua(),this.asm=Oa.pop()||S0({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(La.push(this.heap),Oa.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(e){return new Hr().process(e).finish().result}}Hr.NAME="sha1",Hr.heap_pool=[],Hr.asm_pool=[],Hr.asm_function=S0;const Fa=[],Ha=[];class oi extends x0{constructor(){super(),this.NAME="sha256",this.BLOCK_SIZE=64,this.HASH_SIZE=32,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=Fa.pop()||ua(),this.asm=Ha.pop()||function(e,t,n){var i=0,a=0,o=0,s=0,u=0,c=0,h=0,l=0,_=0,p=0,R=0,M=0,N=0,j=0,Y=0,F=0,E=0,$=0,q=0,V=0,Z=0,tt=0,rt=0,ft=0,lt=0,mt=0,L=new e.Uint8Array(n);function yt(w,d,P,G,W,Q,y,f,g,v,C,x,B,ct,at,ut){w=w|0,d=d|0,P=P|0,G=G|0,W=W|0,Q=Q|0,y=y|0,f=f|0,g=g|0,v=v|0,C=C|0,x=x|0,B=B|0,ct=ct|0,at=at|0,ut=ut|0;var D=0,U=0,K=0,I=0,T=0,z=0,k=0,b=0;D=i,U=a,K=o,I=s,T=u,z=c,k=h,b=l,b=w+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+1116352408|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,k=d+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+1899447441|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,z=P+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+3049323471|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,T=G+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+3921009573|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,I=W+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+961987163|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,K=Q+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+1508970993|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,U=y+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+2453635748|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,D=f+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+2870763221|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,b=g+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+3624381080|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,k=v+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+310598401|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,z=C+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+607225278|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,T=x+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+1426881987|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,I=B+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+1925078388|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,K=ct+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+2162078206|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,U=at+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+2614888103|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,D=ut+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+3248222580|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(at>>>17^at>>>19^at>>>10^at<<15^at<<13)+w+v|0,b=w+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+3835390401|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,d=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+d+C|0,k=d+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+4022224774|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,P=(G>>>7^G>>>18^G>>>3^G<<25^G<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+P+x|0,z=P+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+264347078|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,G=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+G+B|0,T=G+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+604807628|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,W=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+W+ct|0,I=W+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+770255983|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,Q=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(G>>>17^G>>>19^G>>>10^G<<15^G<<13)+Q+at|0,K=Q+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+1249150122|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,y=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+y+ut|0,U=y+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+1555081692|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,f=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+f+w|0,D=f+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+1996064986|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,g=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+g+d|0,b=g+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+2554220882|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,v=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+v+P|0,k=v+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+2821834349|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,C=(x>>>7^x>>>18^x>>>3^x<<25^x<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+C+G|0,z=C+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+2952996808|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,x=(B>>>7^B>>>18^B>>>3^B<<25^B<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+x+W|0,T=x+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+3210313671|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,B=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+B+Q|0,I=B+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+3336571891|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,ct=(at>>>7^at>>>18^at>>>3^at<<25^at<<14)+(x>>>17^x>>>19^x>>>10^x<<15^x<<13)+ct+y|0,K=ct+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+3584528711|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,at=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(B>>>17^B>>>19^B>>>10^B<<15^B<<13)+at+f|0,U=at+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+113926993|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,ut=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+ut+g|0,D=ut+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+338241895|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(at>>>17^at>>>19^at>>>10^at<<15^at<<13)+w+v|0,b=w+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+666307205|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,d=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+d+C|0,k=d+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+773529912|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,P=(G>>>7^G>>>18^G>>>3^G<<25^G<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+P+x|0,z=P+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+1294757372|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,G=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+G+B|0,T=G+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+1396182291|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,W=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+W+ct|0,I=W+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+1695183700|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,Q=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(G>>>17^G>>>19^G>>>10^G<<15^G<<13)+Q+at|0,K=Q+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+1986661051|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,y=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+y+ut|0,U=y+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+2177026350|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,f=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+f+w|0,D=f+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+2456956037|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,g=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+g+d|0,b=g+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+2730485921|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,v=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+v+P|0,k=v+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+2820302411|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,C=(x>>>7^x>>>18^x>>>3^x<<25^x<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+C+G|0,z=C+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+3259730800|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,x=(B>>>7^B>>>18^B>>>3^B<<25^B<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+x+W|0,T=x+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+3345764771|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,B=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+B+Q|0,I=B+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+3516065817|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,ct=(at>>>7^at>>>18^at>>>3^at<<25^at<<14)+(x>>>17^x>>>19^x>>>10^x<<15^x<<13)+ct+y|0,K=ct+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+3600352804|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,at=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(B>>>17^B>>>19^B>>>10^B<<15^B<<13)+at+f|0,U=at+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+4094571909|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,ut=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+ut+g|0,D=ut+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+275423344|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(at>>>17^at>>>19^at>>>10^at<<15^at<<13)+w+v|0,b=w+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+430227734|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,d=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+d+C|0,k=d+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+506948616|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,P=(G>>>7^G>>>18^G>>>3^G<<25^G<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+P+x|0,z=P+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+659060556|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,G=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+G+B|0,T=G+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+883997877|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,W=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+W+ct|0,I=W+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+958139571|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,Q=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(G>>>17^G>>>19^G>>>10^G<<15^G<<13)+Q+at|0,K=Q+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+1322822218|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,y=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+y+ut|0,U=y+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+1537002063|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,f=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+f+w|0,D=f+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+1747873779|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,g=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+g+d|0,b=g+b+(T>>>6^T>>>11^T>>>25^T<<26^T<<21^T<<7)+(k^T&(z^k))+1955562222|0,I=I+b|0,b=b+(D&U^K&(D^U))+(D>>>2^D>>>13^D>>>22^D<<30^D<<19^D<<10)|0,v=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+v+P|0,k=v+k+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(T^z))+2024104815|0,K=K+k|0,k=k+(b&D^U&(b^D))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0,C=(x>>>7^x>>>18^x>>>3^x<<25^x<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+C+G|0,z=C+z+(K>>>6^K>>>11^K>>>25^K<<26^K<<21^K<<7)+(T^K&(I^T))+2227730452|0,U=U+z|0,z=z+(k&b^D&(k^b))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,x=(B>>>7^B>>>18^B>>>3^B<<25^B<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+x+W|0,T=x+T+(U>>>6^U>>>11^U>>>25^U<<26^U<<21^U<<7)+(I^U&(K^I))+2361852424|0,D=D+T|0,T=T+(z&k^b&(z^k))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,B=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+B+Q|0,I=B+I+(D>>>6^D>>>11^D>>>25^D<<26^D<<21^D<<7)+(K^D&(U^K))+2428436474|0,b=b+I|0,I=I+(T&z^k&(T^z))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0,ct=(at>>>7^at>>>18^at>>>3^at<<25^at<<14)+(x>>>17^x>>>19^x>>>10^x<<15^x<<13)+ct+y|0,K=ct+K+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(U^b&(D^U))+2756734187|0,k=k+K|0,K=K+(I&T^z&(I^T))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,at=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(B>>>17^B>>>19^B>>>10^B<<15^B<<13)+at+f|0,U=at+U+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(D^k&(b^D))+3204031479|0,z=z+U|0,U=U+(K&I^T&(K^I))+(K>>>2^K>>>13^K>>>22^K<<30^K<<19^K<<10)|0,ut=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+ut+g|0,D=ut+D+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(b^z&(k^b))+3329325298|0,T=T+D|0,D=D+(U&K^I&(U^K))+(U>>>2^U>>>13^U>>>22^U<<30^U<<19^U<<10)|0,i=i+D|0,a=a+U|0,o=o+K|0,s=s+I|0,u=u+T|0,c=c+z|0,h=h+k|0,l=l+b|0}function Ct(w){w=w|0,yt(L[w|0]<<24|L[w|1]<<16|L[w|2]<<8|L[w|3],L[w|4]<<24|L[w|5]<<16|L[w|6]<<8|L[w|7],L[w|8]<<24|L[w|9]<<16|L[w|10]<<8|L[w|11],L[w|12]<<24|L[w|13]<<16|L[w|14]<<8|L[w|15],L[w|16]<<24|L[w|17]<<16|L[w|18]<<8|L[w|19],L[w|20]<<24|L[w|21]<<16|L[w|22]<<8|L[w|23],L[w|24]<<24|L[w|25]<<16|L[w|26]<<8|L[w|27],L[w|28]<<24|L[w|29]<<16|L[w|30]<<8|L[w|31],L[w|32]<<24|L[w|33]<<16|L[w|34]<<8|L[w|35],L[w|36]<<24|L[w|37]<<16|L[w|38]<<8|L[w|39],L[w|40]<<24|L[w|41]<<16|L[w|42]<<8|L[w|43],L[w|44]<<24|L[w|45]<<16|L[w|46]<<8|L[w|47],L[w|48]<<24|L[w|49]<<16|L[w|50]<<8|L[w|51],L[w|52]<<24|L[w|53]<<16|L[w|54]<<8|L[w|55],L[w|56]<<24|L[w|57]<<16|L[w|58]<<8|L[w|59],L[w|60]<<24|L[w|61]<<16|L[w|62]<<8|L[w|63])}function H(w){w=w|0,L[w|0]=i>>>24,L[w|1]=i>>>16&255,L[w|2]=i>>>8&255,L[w|3]=i&255,L[w|4]=a>>>24,L[w|5]=a>>>16&255,L[w|6]=a>>>8&255,L[w|7]=a&255,L[w|8]=o>>>24,L[w|9]=o>>>16&255,L[w|10]=o>>>8&255,L[w|11]=o&255,L[w|12]=s>>>24,L[w|13]=s>>>16&255,L[w|14]=s>>>8&255,L[w|15]=s&255,L[w|16]=u>>>24,L[w|17]=u>>>16&255,L[w|18]=u>>>8&255,L[w|19]=u&255,L[w|20]=c>>>24,L[w|21]=c>>>16&255,L[w|22]=c>>>8&255,L[w|23]=c&255,L[w|24]=h>>>24,L[w|25]=h>>>16&255,L[w|26]=h>>>8&255,L[w|27]=h&255,L[w|28]=l>>>24,L[w|29]=l>>>16&255,L[w|30]=l>>>8&255,L[w|31]=l&255}function nt(){i=1779033703,a=3144134277,o=1013904242,s=2773480762,u=1359893119,c=2600822924,h=528734635,l=1541459225,_=p=0}function pt(w,d,P,G,W,Q,y,f,g,v){w=w|0,d=d|0,P=P|0,G=G|0,W=W|0,Q=Q|0,y=y|0,f=f|0,g=g|0,v=v|0,i=w,a=d,o=P,s=G,u=W,c=Q,h=y,l=f,_=g,p=v}function gt(w,d){w=w|0,d=d|0;var P=0;if(w&63)return-1;for(;(d|0)>=64;)Ct(w),w=w+64|0,d=d-64|0,P=P+64|0;return _=_+P|0,_>>>0<P>>>0&&(p=p+1|0),P|0}function dt(w,d,P){w=w|0,d=d|0,P=P|0;var G=0,W=0;if(w&63||~P&&P&31)return-1;if((d|0)>=64){if(G=gt(w,d)|0,(G|0)==-1)return-1;w=w+G|0,d=d-G|0}if(G=G+d|0,_=_+d|0,_>>>0<d>>>0&&(p=p+1|0),L[w|d]=128,(d|0)>=56){for(W=d+1|0;(W|0)<64;W=W+1|0)L[w|W]=0;Ct(w),d=0,L[w|0]=0}for(W=d+1|0;(W|0)<59;W=W+1|0)L[w|W]=0;return L[w|56]=p>>>21&255,L[w|57]=p>>>13&255,L[w|58]=p>>>5&255,L[w|59]=p<<3&255|_>>>29,L[w|60]=_>>>21&255,L[w|61]=_>>>13&255,L[w|62]=_>>>5&255,L[w|63]=_<<3&255,Ct(w),~P&&H(P),G|0}function ht(){i=R,a=M,o=N,s=j,u=Y,c=F,h=E,l=$,_=64,p=0}function wt(){i=q,a=V,o=Z,s=tt,u=rt,c=ft,h=lt,l=mt,_=64,p=0}function st(w,d,P,G,W,Q,y,f,g,v,C,x,B,ct,at,ut){w=w|0,d=d|0,P=P|0,G=G|0,W=W|0,Q=Q|0,y=y|0,f=f|0,g=g|0,v=v|0,C=C|0,x=x|0,B=B|0,ct=ct|0,at=at|0,ut=ut|0,nt(),yt(w^1549556828,d^1549556828,P^1549556828,G^1549556828,W^1549556828,Q^1549556828,y^1549556828,f^1549556828,g^1549556828,v^1549556828,C^1549556828,x^1549556828,B^1549556828,ct^1549556828,at^1549556828,ut^1549556828),q=i,V=a,Z=o,tt=s,rt=u,ft=c,lt=h,mt=l,nt(),yt(w^909522486,d^909522486,P^909522486,G^909522486,W^909522486,Q^909522486,y^909522486,f^909522486,g^909522486,v^909522486,C^909522486,x^909522486,B^909522486,ct^909522486,at^909522486,ut^909522486),R=i,M=a,N=o,j=s,Y=u,F=c,E=h,$=l,_=64,p=0}function S(w,d,P){w=w|0,d=d|0,P=P|0;var G=0,W=0,Q=0,y=0,f=0,g=0,v=0,C=0,x=0;return w&63||~P&&P&31?-1:(x=dt(w,d,-1)|0,G=i,W=a,Q=o,y=s,f=u,g=c,v=h,C=l,wt(),yt(G,W,Q,y,f,g,v,C,2147483648,0,0,0,0,0,0,768),~P&&H(P),x|0)}function O(w,d,P,G,W){w=w|0,d=d|0,P=P|0,G=G|0,W=W|0;var Q=0,y=0,f=0,g=0,v=0,C=0,x=0,B=0,ct=0,at=0,ut=0,D=0,U=0,K=0,I=0,T=0;if(w&63||~W&&W&31)return-1;for(L[w+d|0]=P>>>24,L[w+d+1|0]=P>>>16&255,L[w+d+2|0]=P>>>8&255,L[w+d+3|0]=P&255,S(w,d+4|0,-1)|0,Q=ct=i,y=at=a,f=ut=o,g=D=s,v=U=u,C=K=c,x=I=h,B=T=l,G=G-1|0;(G|0)>0;)ht(),yt(ct,at,ut,D,U,K,I,T,2147483648,0,0,0,0,0,0,768),ct=i,at=a,ut=o,D=s,U=u,K=c,I=h,T=l,wt(),yt(ct,at,ut,D,U,K,I,T,2147483648,0,0,0,0,0,0,768),ct=i,at=a,ut=o,D=s,U=u,K=c,I=h,T=l,Q=Q^i,y=y^a,f=f^o,g=g^s,v=v^u,C=C^c,x=x^h,B=B^l,G=G-1|0;return i=Q,a=y,o=f,s=g,u=v,c=C,h=x,l=B,~W&&H(W),0}return{reset:nt,init:pt,process:gt,finish:dt,hmac_reset:ht,hmac_init:st,hmac_finish:S,pbkdf2_generate_block:O}}({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(Fa.push(this.heap),Ha.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(e){return new oi().process(e).finish().result}}oi.NAME="sha256";var ci=P0;function P0(r,e){if(!r)throw Error(e||"Assertion failed")}P0.equal=function(r,e,t){if(r!=e)throw Error(t||"Assertion failed: "+r+" != "+e)};var x5=$e!==void 0?$e:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function la(r,e){return r(e={exports:{}},e.exports),e.exports}function r3(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var n3=la(function(r){r.exports=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),i3=function(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for((r=r.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var n=0;n<r.length;n++){var i=r.charCodeAt(n),a=i>>8,o=255&i;a?t.push(a,o):t.push(o)}else for(n=0;n<r.length;n++)t[n]=0|r[n];return t},a3=function(r){for(var e="",t=0;t<r.length;t++)e+=K0(r[t].toString(16));return e};function U0(r){return(r>>>24|r>>>8&65280|r<<8&16711680|(255&r)<<24)>>>0}var s3=function(r,e){for(var t="",n=0;n<r.length;n++){var i=r[n];e==="little"&&(i=U0(i)),t+=D0(i.toString(16))}return t};function K0(r){return r.length===1?"0"+r:r}function D0(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}var o3=function(r,e,t,n){var i=t-e;ci(i%4==0);for(var a=Array(i/4),o=0,s=e;o<a.length;o++,s+=4){var u;u=n==="big"?r[s]<<24|r[s+1]<<16|r[s+2]<<8|r[s+3]:r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s],a[o]=u>>>0}return a},c3=function(r,e){for(var t=Array(4*r.length),n=0,i=0;n<r.length;n++,i+=4){var a=r[n];e==="big"?(t[i]=a>>>24,t[i+1]=a>>>16&255,t[i+2]=a>>>8&255,t[i+3]=255&a):(t[i+3]=a>>>24,t[i+2]=a>>>16&255,t[i+1]=a>>>8&255,t[i]=255&a)}return t},Dt={inherits:n3,toArray:i3,toHex:a3,htonl:U0,toHex32:s3,zero2:K0,zero8:D0,join32:o3,split32:c3,rotr32:function(r,e){return r>>>e|r<<32-e},rotl32:function(r,e){return r<<e|r>>>32-e},sum32:function(r,e){return r+e>>>0},sum32_3:function(r,e,t){return r+e+t>>>0},sum32_4:function(r,e,t,n){return r+e+t+n>>>0},sum32_5:function(r,e,t,n,i){return r+e+t+n+i>>>0},sum64:function(r,e,t,n){var i=r[e],a=n+r[e+1]>>>0,o=(a<n?1:0)+t+i;r[e]=o>>>0,r[e+1]=a},sum64_hi:function(r,e,t,n){return(e+n>>>0<e?1:0)+r+t>>>0},sum64_lo:function(r,e,t,n){return e+n>>>0},sum64_4_hi:function(r,e,t,n,i,a,o,s){var u=0,c=e;return u+=(c=c+n>>>0)<e?1:0,u+=(c=c+a>>>0)<a?1:0,r+t+i+o+(u+=(c=c+s>>>0)<s?1:0)>>>0},sum64_4_lo:function(r,e,t,n,i,a,o,s){return e+n+a+s>>>0},sum64_5_hi:function(r,e,t,n,i,a,o,s,u,c){var h=0,l=e;return h+=(l=l+n>>>0)<e?1:0,h+=(l=l+a>>>0)<a?1:0,h+=(l=l+s>>>0)<s?1:0,r+t+i+o+u+(h+=(l=l+c>>>0)<c?1:0)>>>0},sum64_5_lo:function(r,e,t,n,i,a,o,s,u,c){return e+n+a+s+c>>>0},rotr64_hi:function(r,e,t){return(e<<32-t|r>>>t)>>>0},rotr64_lo:function(r,e,t){return(r<<32-t|e>>>t)>>>0},shr64_hi:function(r,e,t){return r>>>t},shr64_lo:function(r,e,t){return(r<<32-t|e>>>t)>>>0}};function T1(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var u3=T1;T1.prototype.update=function(r,e){if(r=Dt.toArray(r,e),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){var t=(r=this.pending).length%this._delta8;this.pending=r.slice(r.length-t,r.length),this.pending.length===0&&(this.pending=null),r=Dt.join32(r,0,r.length-t,this.endian);for(var n=0;n<r.length;n+=this._delta32)this._update(r,n,n+this._delta32)}return this},T1.prototype.digest=function(r){return this.update(this._pad()),ci(this.pending===null),this._digest(r)},T1.prototype._pad=function(){var r=this.pendingTotal,e=this._delta8,t=e-(r+this.padLength)%e,n=Array(t+this.padLength);n[0]=128;for(var i=1;i<t;i++)n[i]=0;if(r<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=r>>>24&255,n[i++]=r>>>16&255,n[i++]=r>>>8&255,n[i++]=255&r}else for(n[i++]=255&r,n[i++]=r>>>8&255,n[i++]=r>>>16&255,n[i++]=r>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,a=8;a<this.padLength;a++)n[i++]=0;return n};var da={BlockHash:u3},Re=Dt.rotr32,h3=function(r,e,t,n){return r===0?C0(e,t,n):r===1||r===3?T0(e,t,n):r===2?I0(e,t,n):void 0};function C0(r,e,t){return r&e^~r&t}function I0(r,e,t){return r&e^r&t^e&t}function T0(r,e,t){return r^e^t}var Sn={ft_1:h3,ch32:C0,maj32:I0,p32:T0,s0_256:function(r){return Re(r,2)^Re(r,13)^Re(r,22)},s1_256:function(r){return Re(r,6)^Re(r,11)^Re(r,25)},g0_256:function(r){return Re(r,7)^Re(r,18)^r>>>3},g1_256:function(r){return Re(r,17)^Re(r,19)^r>>>10}},Ue=Dt.sum32,l3=Dt.sum32_4,d3=Dt.sum32_5,f3=Sn.ch32,y3=Sn.maj32,p3=Sn.s0_256,g3=Sn.s1_256,m3=Sn.g0_256,w3=Sn.g1_256,B0=da.BlockHash,b3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Fe(){if(!(this instanceof Fe))return new Fe;B0.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b3,this.W=Array(64)}Dt.inherits(Fe,B0);var z0=Fe;function lr(){if(!(this instanceof lr))return new lr;z0.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Fe.blockSize=512,Fe.outSize=256,Fe.hmacStrength=192,Fe.padLength=64,Fe.prototype._update=function(r,e){for(var t=this.W,n=0;n<16;n++)t[n]=r[e+n];for(;n<t.length;n++)t[n]=l3(w3(t[n-2]),t[n-7],m3(t[n-15]),t[n-16]);var i=this.h[0],a=this.h[1],o=this.h[2],s=this.h[3],u=this.h[4],c=this.h[5],h=this.h[6],l=this.h[7];for(ci(this.k.length===t.length),n=0;n<t.length;n++){var _=d3(l,g3(u),f3(u,c,h),this.k[n],t[n]),p=Ue(p3(i),y3(i,a,o));l=h,h=c,c=u,u=Ue(s,_),s=o,o=a,a=i,i=Ue(_,p)}this.h[0]=Ue(this.h[0],i),this.h[1]=Ue(this.h[1],a),this.h[2]=Ue(this.h[2],o),this.h[3]=Ue(this.h[3],s),this.h[4]=Ue(this.h[4],u),this.h[5]=Ue(this.h[5],c),this.h[6]=Ue(this.h[6],h),this.h[7]=Ue(this.h[7],l)},Fe.prototype._digest=function(r){return r==="hex"?Dt.toHex32(this.h,"big"):Dt.split32(this.h,"big")},Dt.inherits(lr,z0);var k3=lr;lr.blockSize=512,lr.outSize=224,lr.hmacStrength=192,lr.padLength=64,lr.prototype._digest=function(r){return r==="hex"?Dt.toHex32(this.h.slice(0,7),"big"):Dt.split32(this.h.slice(0,7),"big")};var Ze=Dt.rotr64_hi,Qe=Dt.rotr64_lo,R0=Dt.shr64_hi,M0=Dt.shr64_lo,vr=Dt.sum64,Ai=Dt.sum64_hi,Ei=Dt.sum64_lo,v3=Dt.sum64_4_hi,_3=Dt.sum64_4_lo,A3=Dt.sum64_5_hi,E3=Dt.sum64_5_lo,N0=da.BlockHash,S3=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function De(){if(!(this instanceof De))return new De;N0.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=S3,this.W=Array(160)}Dt.inherits(De,N0);var ui=De;function x3(r,e,t,n,i){var a=r&t^~r&i;return a<0&&(a+=4294967296),a}function P3(r,e,t,n,i,a){var o=e&n^~e&a;return o<0&&(o+=4294967296),o}function U3(r,e,t,n,i){var a=r&t^r&i^t&i;return a<0&&(a+=4294967296),a}function K3(r,e,t,n,i,a){var o=e&n^e&a^n&a;return o<0&&(o+=4294967296),o}function D3(r,e){var t=Ze(r,e,28)^Ze(e,r,2)^Ze(e,r,7);return t<0&&(t+=4294967296),t}function C3(r,e){var t=Qe(r,e,28)^Qe(e,r,2)^Qe(e,r,7);return t<0&&(t+=4294967296),t}function I3(r,e){var t=Ze(r,e,14)^Ze(r,e,18)^Ze(e,r,9);return t<0&&(t+=4294967296),t}function T3(r,e){var t=Qe(r,e,14)^Qe(r,e,18)^Qe(e,r,9);return t<0&&(t+=4294967296),t}function B3(r,e){var t=Ze(r,e,1)^Ze(r,e,8)^R0(r,e,7);return t<0&&(t+=4294967296),t}function z3(r,e){var t=Qe(r,e,1)^Qe(r,e,8)^M0(r,e,7);return t<0&&(t+=4294967296),t}function R3(r,e){var t=Ze(r,e,19)^Ze(e,r,29)^R0(r,e,6);return t<0&&(t+=4294967296),t}function M3(r,e){var t=Qe(r,e,19)^Qe(e,r,29)^M0(r,e,6);return t<0&&(t+=4294967296),t}function dr(){if(!(this instanceof dr))return new dr;ui.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}De.blockSize=1024,De.outSize=512,De.hmacStrength=192,De.padLength=128,De.prototype._prepareBlock=function(r,e){for(var t=this.W,n=0;n<32;n++)t[n]=r[e+n];for(;n<t.length;n+=2){var i=R3(t[n-4],t[n-3]),a=M3(t[n-4],t[n-3]),o=t[n-14],s=t[n-13],u=B3(t[n-30],t[n-29]),c=z3(t[n-30],t[n-29]),h=t[n-32],l=t[n-31];t[n]=v3(i,a,o,s,u,c,h,l),t[n+1]=_3(i,a,o,s,u,c,h,l)}},De.prototype._update=function(r,e){this._prepareBlock(r,e);var t=this.W,n=this.h[0],i=this.h[1],a=this.h[2],o=this.h[3],s=this.h[4],u=this.h[5],c=this.h[6],h=this.h[7],l=this.h[8],_=this.h[9],p=this.h[10],R=this.h[11],M=this.h[12],N=this.h[13],j=this.h[14],Y=this.h[15];ci(this.k.length===t.length);for(var F=0;F<t.length;F+=2){var E=j,$=Y,q=I3(l,_),V=T3(l,_),Z=x3(l,_,p,R,M),tt=P3(l,_,p,R,M,N),rt=this.k[F],ft=this.k[F+1],lt=t[F],mt=t[F+1],L=A3(E,$,q,V,Z,tt,rt,ft,lt,mt),yt=E3(E,$,q,V,Z,tt,rt,ft,lt,mt);E=D3(n,i),$=C3(n,i),q=U3(n,i,a,o,s),V=K3(n,i,a,o,s,u);var Ct=Ai(E,$,q,V),H=Ei(E,$,q,V);j=M,Y=N,M=p,N=R,p=l,R=_,l=Ai(c,h,L,yt),_=Ei(h,h,L,yt),c=s,h=u,s=a,u=o,a=n,o=i,n=Ai(L,yt,Ct,H),i=Ei(L,yt,Ct,H)}vr(this.h,0,n,i),vr(this.h,2,a,o),vr(this.h,4,s,u),vr(this.h,6,c,h),vr(this.h,8,l,_),vr(this.h,10,p,R),vr(this.h,12,M,N),vr(this.h,14,j,Y)},De.prototype._digest=function(r){return r==="hex"?Dt.toHex32(this.h,"big"):Dt.split32(this.h,"big")},Dt.inherits(dr,ui);var N3=dr;dr.blockSize=1024,dr.outSize=384,dr.hmacStrength=192,dr.padLength=128,dr.prototype._digest=function(r){return r==="hex"?Dt.toHex32(this.h.slice(0,12),"big"):Dt.split32(this.h.slice(0,12),"big")};var _1=Dt.rotl32,qa=Dt.sum32,Tn=Dt.sum32_3,ja=Dt.sum32_4,L0=da.BlockHash;function He(){if(!(this instanceof He))return new He;L0.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Dt.inherits(He,L0);var O0=He;function Ga(r,e,t,n){return r<=15?e^t^n:r<=31?e&t|~e&n:r<=47?(e|~t)^n:r<=63?e&n|t&~n:e^(t|~n)}function L3(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function O3(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}He.blockSize=512,He.outSize=160,He.hmacStrength=192,He.padLength=64,He.prototype._update=function(r,e){for(var t=this.h[0],n=this.h[1],i=this.h[2],a=this.h[3],o=this.h[4],s=t,u=n,c=i,h=a,l=o,_=0;_<80;_++){var p=qa(_1(ja(t,Ga(_,n,i,a),r[F3[_]+e],L3(_)),q3[_]),o);t=o,o=a,a=_1(i,10),i=n,n=p,p=qa(_1(ja(s,Ga(79-_,u,c,h),r[H3[_]+e],O3(_)),j3[_]),l),s=l,l=h,h=_1(c,10),c=u,u=p}p=Tn(this.h[1],i,h),this.h[1]=Tn(this.h[2],a,l),this.h[2]=Tn(this.h[3],o,s),this.h[3]=Tn(this.h[4],t,u),this.h[4]=Tn(this.h[0],n,c),this.h[0]=p},He.prototype._digest=function(r){return r==="hex"?Dt.toHex32(this.h,"little"):Dt.split32(this.h,"little")};var F3=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],H3=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],q3=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],j3=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],P5={ripemd160:O0};function Si(r,e){let t=r[0],n=r[1],i=r[2],a=r[3];t=ue(t,n,i,a,e[0],7,-680876936),a=ue(a,t,n,i,e[1],12,-389564586),i=ue(i,a,t,n,e[2],17,606105819),n=ue(n,i,a,t,e[3],22,-1044525330),t=ue(t,n,i,a,e[4],7,-176418897),a=ue(a,t,n,i,e[5],12,1200080426),i=ue(i,a,t,n,e[6],17,-1473231341),n=ue(n,i,a,t,e[7],22,-45705983),t=ue(t,n,i,a,e[8],7,1770035416),a=ue(a,t,n,i,e[9],12,-1958414417),i=ue(i,a,t,n,e[10],17,-42063),n=ue(n,i,a,t,e[11],22,-1990404162),t=ue(t,n,i,a,e[12],7,1804603682),a=ue(a,t,n,i,e[13],12,-40341101),i=ue(i,a,t,n,e[14],17,-1502002290),n=ue(n,i,a,t,e[15],22,1236535329),t=he(t,n,i,a,e[1],5,-165796510),a=he(a,t,n,i,e[6],9,-1069501632),i=he(i,a,t,n,e[11],14,643717713),n=he(n,i,a,t,e[0],20,-373897302),t=he(t,n,i,a,e[5],5,-701558691),a=he(a,t,n,i,e[10],9,38016083),i=he(i,a,t,n,e[15],14,-660478335),n=he(n,i,a,t,e[4],20,-405537848),t=he(t,n,i,a,e[9],5,568446438),a=he(a,t,n,i,e[14],9,-1019803690),i=he(i,a,t,n,e[3],14,-187363961),n=he(n,i,a,t,e[8],20,1163531501),t=he(t,n,i,a,e[13],5,-1444681467),a=he(a,t,n,i,e[2],9,-51403784),i=he(i,a,t,n,e[7],14,1735328473),n=he(n,i,a,t,e[12],20,-1926607734),t=le(t,n,i,a,e[5],4,-378558),a=le(a,t,n,i,e[8],11,-2022574463),i=le(i,a,t,n,e[11],16,1839030562),n=le(n,i,a,t,e[14],23,-35309556),t=le(t,n,i,a,e[1],4,-1530992060),a=le(a,t,n,i,e[4],11,1272893353),i=le(i,a,t,n,e[7],16,-155497632),n=le(n,i,a,t,e[10],23,-1094730640),t=le(t,n,i,a,e[13],4,681279174),a=le(a,t,n,i,e[0],11,-358537222),i=le(i,a,t,n,e[3],16,-722521979),n=le(n,i,a,t,e[6],23,76029189),t=le(t,n,i,a,e[9],4,-640364487),a=le(a,t,n,i,e[12],11,-421815835),i=le(i,a,t,n,e[15],16,530742520),n=le(n,i,a,t,e[2],23,-995338651),t=de(t,n,i,a,e[0],6,-198630844),a=de(a,t,n,i,e[7],10,1126891415),i=de(i,a,t,n,e[14],15,-1416354905),n=de(n,i,a,t,e[5],21,-57434055),t=de(t,n,i,a,e[12],6,1700485571),a=de(a,t,n,i,e[3],10,-1894986606),i=de(i,a,t,n,e[10],15,-1051523),n=de(n,i,a,t,e[1],21,-2054922799),t=de(t,n,i,a,e[8],6,1873313359),a=de(a,t,n,i,e[15],10,-30611744),i=de(i,a,t,n,e[6],15,-1560198380),n=de(n,i,a,t,e[13],21,1309151649),t=de(t,n,i,a,e[4],6,-145523070),a=de(a,t,n,i,e[11],10,-1120210379),i=de(i,a,t,n,e[2],15,718787259),n=de(n,i,a,t,e[9],21,-343485551),r[0]=Ur(t,r[0]),r[1]=Ur(n,r[1]),r[2]=Ur(i,r[2]),r[3]=Ur(a,r[3])}function hi(r,e,t,n,i,a){return e=Ur(Ur(e,r),Ur(n,a)),Ur(e<<i|e>>>32-i,t)}function ue(r,e,t,n,i,a,o){return hi(e&t|~e&n,r,e,i,a,o)}function he(r,e,t,n,i,a,o){return hi(e&n|t&~n,r,e,i,a,o)}function le(r,e,t,n,i,a,o){return hi(e^t^n,r,e,i,a,o)}function de(r,e,t,n,i,a,o){return hi(t^(e|~n),r,e,i,a,o)}function G3(r){const e=[];let t;for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}const Va="0123456789abcdef".split("");function V3(r){let e="",t=0;for(;t<4;t++)e+=Va[r>>8*t+4&15]+Va[r>>8*t&15];return e}function Ur(r,e){return r+e&4294967295}const j1=A.getWebCrypto(),G1=A.getNodeCrypto(),W3=G1&&G1.getHashes();function Rr(r){if(G1&&W3.includes(r))return async function(e){const t=G1.createHash(r);return Xt(e,n=>{t.update(n)},()=>new Uint8Array(t.digest()))}}function A1(r,e){return async function(t,n=At){if(ce(t)&&(t=await nr(t)),!A.isStream(t)&&j1&&e&&t.length>=n.minBytesForWebCrypto)return new Uint8Array(await j1.digest(e,t));const i=r();return Xt(t,a=>{i.update(a)},()=>new Uint8Array(i.digest()))}}function Wa(r,e){return async function(t,n=At){if(ce(t)&&(t=await nr(t)),A.isStream(t)){const i=new r;return Xt(t,a=>{i.process(a)},()=>i.finish().result)}return j1&&e&&t.length>=n.minBytesForWebCrypto?new Uint8Array(await j1.digest(e,t)):r.bytes(t)}}const Mr={md5:Rr("md5")||async function(r){const e=function(t){const n=t.length,i=[1732584193,-271733879,-1732584194,271733878];let a;for(a=64;a<=t.length;a+=64)Si(i,G3(t.substring(a-64,a)));t=t.substring(a-64);const o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=0;a<t.length;a++)o[a>>2]|=t.charCodeAt(a)<<(a%4<<3);if(o[a>>2]|=128<<(a%4<<3),a>55)for(Si(i,o),a=0;a<16;a++)o[a]=0;return o[14]=8*n,Si(i,o),i}(A.uint8ArrayToString(r));return A.hexToUint8Array(function(t){for(let n=0;n<t.length;n++)t[n]=V3(t[n]);return t.join("")}(e))},sha1:Rr("sha1")||Wa(Hr,"SHA-1"),sha224:Rr("sha224")||A1(k3),sha256:Rr("sha256")||Wa(oi,"SHA-256"),sha384:Rr("sha384")||A1(N3,"SHA-384"),sha512:Rr("sha512")||A1(ui,"SHA-512"),ripemd:Rr("ripemd160")||A1(O0)};var kn={md5:Mr.md5,sha1:Mr.sha1,sha224:Mr.sha224,sha256:Mr.sha256,sha384:Mr.sha384,sha512:Mr.sha512,ripemd:Mr.ripemd,digest:function(r,e){switch(r){case m.hash.md5:return this.md5(e);case m.hash.sha1:return this.sha1(e);case m.hash.ripemd:return this.ripemd(e);case m.hash.sha256:return this.sha256(e);case m.hash.sha384:return this.sha384(e);case m.hash.sha512:return this.sha512(e);case m.hash.sha224:return this.sha224(e);default:throw Error("Invalid hash function.")}},getHashByteLength:function(r){switch(r){case m.hash.md5:return 16;case m.hash.sha1:case m.hash.ripemd:return 20;case m.hash.sha256:return 32;case m.hash.sha384:return 48;case m.hash.sha512:return 64;case m.hash.sha224:return 28;default:throw Error("Invalid hash algorithm.")}}};class pn{static encrypt(e,t,n){return new pn(t,n).encrypt(e)}static decrypt(e,t,n){return new pn(t,n).decrypt(e)}constructor(e,t,n){this.aes=n||new d1(e,t,!0,"CFB"),delete this.aes.padding}encrypt(e){return Br(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return Br(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}}function Ir(r){const e=m.read(m.symmetric,r);return f1[e]}const $a=A.getWebCrypto(),V1=A.getNodeCrypto(),Nr=V1?V1.getCiphers():[],E1={idea:Nr.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Nr.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Nr.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Nr.includes("bf-cfb")?"bf-cfb":void 0,aes128:Nr.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Nr.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Nr.includes("aes-256-cfb")?"aes-256-cfb":void 0};var $3=Object.freeze({__proto__:null,encrypt:async function(r,e,t,n,i){const a=m.read(m.symmetric,r);if(A.getNodeCrypto()&&E1[a])return function(l,_,p,R){const M=m.read(m.symmetric,l),N=new V1.createCipheriv(E1[M],_,R);return Xt(p,j=>new Uint8Array(N.update(j)))}(r,e,t,n);if(a.substr(0,3)==="aes")return function(l,_,p,R,M){if(A.getWebCrypto()&&_.length!==24&&!A.isStream(p)&&p.length>=3e3*M.minBytesForWebCrypto)return async function(j,Y,F,E){const $="AES-CBC",q=await $a.importKey("raw",Y,{name:$},!1,["encrypt"]),{blockSize:V}=Ir(j),Z=A.concatUint8Array([new Uint8Array(V),F]),tt=new Uint8Array(await $a.encrypt({name:$,iv:E},q,Z)).subarray(0,F.length);return function(rt,ft){for(let lt=0;lt<rt.length;lt++)rt[lt]=rt[lt]^ft[lt]}(tt,F),tt}(l,_,p,R);const N=new pn(_,R);return Xt(p,j=>N.aes.AES_Encrypt_process(j),()=>N.aes.AES_Encrypt_finish())}(r,e,t,n,i);const o=new(Ir(r))(e),s=o.blockSize,u=n.slice();let c=new Uint8Array;const h=l=>{l&&(c=A.concatUint8Array([c,l]));const _=new Uint8Array(c.length);let p,R=0;for(;l?c.length>=s:c.length;){const M=o.encrypt(u);for(p=0;p<s;p++)u[p]=c[p]^M[p],_[R++]=u[p];c=c.subarray(s)}return _.subarray(0,R)};return Xt(t,h,h)},decrypt:async function(r,e,t,n){const i=m.read(m.symmetric,r);if(A.getNodeCrypto()&&E1[i])return function(h,l,_,p){const R=m.read(m.symmetric,h),M=new V1.createDecipheriv(E1[R],l,p);return Xt(_,N=>new Uint8Array(M.update(N)))}(r,e,t,n);if(i.substr(0,3)==="aes")return function(h,l,_,p){if(A.isStream(_)){const R=new pn(l,p);return Xt(_,M=>R.aes.AES_Decrypt_process(M),()=>R.aes.AES_Decrypt_finish())}return pn.decrypt(_,l,p)}(0,e,t,n);const a=new(Ir(r))(e),o=a.blockSize;let s=n,u=new Uint8Array;const c=h=>{h&&(u=A.concatUint8Array([u,h]));const l=new Uint8Array(u.length);let _,p=0;for(;h?u.length>=o:u.length;){const R=a.encrypt(s);for(s=u,_=0;_<o;_++)l[p++]=s[_]^R[_];u=u.subarray(o)}return l.subarray(0,p)};return Xt(t,c,c)}});class W1{static encrypt(e,t,n){return new W1(t,n).encrypt(e)}static decrypt(e,t,n){return new W1(t,n).encrypt(e)}constructor(e,t,n){this.aes=n||new d1(e,void 0,!1,"CTR"),delete this.aes.padding,this.AES_CTR_set_options(t)}encrypt(e){return Br(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return Br(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}AES_CTR_set_options(e,t,n){let{asm:i}=this.aes.acquire_asm();if(n!==void 0){if(n<8||n>48)throw new fr("illegal counter size");let a=Math.pow(2,n)-1;i.set_mask(0,0,a/4294967296|0,0|a)}else n=48,i.set_mask(0,0,65535,4294967295);if(e===void 0)throw Error("nonce is required");{let a=e.length;if(!a||a>16)throw new fr("illegal nonce size");let o=new DataView(new ArrayBuffer(16));new Uint8Array(o.buffer).set(e),i.set_nonce(o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12))}if(t!==void 0){if(t<0||t>=Math.pow(2,n))throw new fr("illegal counter value");i.set_counter(0,0,t/4294967296|0,0|t)}}}class $1{static encrypt(e,t,n=!0,i){return new $1(t,i,n).encrypt(e)}static decrypt(e,t,n=!0,i){return new $1(t,i,n).decrypt(e)}constructor(e,t,n=!0,i){this.aes=i||new d1(e,t,n,"CBC")}encrypt(e){return Br(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return Br(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}}const Za=A.getWebCrypto(),Z3=A.getNodeCrypto(),cr=16;function Qa(r,e){const t=r.length-cr;for(let n=0;n<cr;n++)r[n+t]^=e[n];return r}const S1=new Uint8Array(cr);async function Q3(r){const e=await async function(i){return A.getWebCrypto()&&i.length!==24?(i=await Za.importKey("raw",i,{name:"AES-CBC",length:8*i.length},!1,["encrypt"]),async function(a){const o=await Za.encrypt({name:"AES-CBC",iv:S1,length:8*cr},i,a);return new Uint8Array(o).subarray(0,o.byteLength-cr)}):A.getNodeCrypto()?async function(a){const o=new Z3.createCipheriv("aes-"+8*i.length+"-cbc",i,S1).update(a);return new Uint8Array(o)}:async function(a){return $1.encrypt(a,i,!1,S1)}}(r),t=A.double(await e(S1)),n=A.double(t);return async function(i){return(await e(function(a,o,s){if(a.length&&a.length%cr==0)return Qa(a,o);const u=new Uint8Array(a.length+(cr-a.length%cr));return u.set(a),u[a.length]=128,Qa(u,s)}(i,t,n))).subarray(-cr)}}const Ya=A.getWebCrypto(),Y3=A.getNodeCrypto(),X3=A.getNodeBuffer(),pr=16,J3=pr,hn=pr,Xa=new Uint8Array(pr),Zi=new Uint8Array(pr);Zi[pr-1]=1;const Qi=new Uint8Array(pr);async function to(r){const e=await Q3(r);return function(t,n){return e(A.concatUint8Array([t,n]))}}async function eo(r){return A.getWebCrypto()&&r.length!==24?(r=await Ya.importKey("raw",r,{name:"AES-CTR",length:8*r.length},!1,["encrypt"]),async function(e,t){const n=await Ya.encrypt({name:"AES-CTR",counter:t,length:8*pr},r,e);return new Uint8Array(n)}):A.getNodeCrypto()?async function(e,t){const n=new Y3.createCipheriv("aes-"+8*r.length+"-ctr",r,t),i=X3.concat([n.update(e),n.final()]);return new Uint8Array(i)}:async function(e,t){return W1.encrypt(e,r,t)}}async function Hn(r,e){if(r!==m.symmetric.aes128&&r!==m.symmetric.aes192&&r!==m.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[t,n]=await Promise.all([to(e),eo(e)]);return{encrypt:async function(i,a,o){const[s,u]=await Promise.all([t(Xa,a),t(Zi,o)]),c=await n(i,s),h=await t(Qi,c);for(let l=0;l<hn;l++)h[l]^=u[l]^s[l];return A.concatUint8Array([c,h])},decrypt:async function(i,a,o){if(i.length<hn)throw Error("Invalid EAX ciphertext");const s=i.subarray(0,-hn),u=i.subarray(-hn),[c,h,l]=await Promise.all([t(Xa,a),t(Zi,o),t(Qi,s)]),_=l;for(let p=0;p<hn;p++)_[p]^=h[p]^c[p];if(!A.equalsUint8Array(u,_))throw Error("Authentication tag mismatch");return await n(s,c)}}}Qi[pr-1]=2,Hn.getNonce=function(r,e){const t=r.slice();for(let n=0;n<e.length;n++)t[8+n]^=e[n];return t},Hn.blockLength=pr,Hn.ivLength=J3,Hn.tagLength=hn;const pe=16,F0=15,Ar=16;function Ja(r){let e=0;for(let t=1;!(r&t);t<<=1)e++;return e}function me(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t];return r}function x1(r,e){return me(r.slice(),e)}const xi=new Uint8Array(pe),ro=new Uint8Array([1]);async function qn(r,e){let t,n,i,a=0;function o(s,u,c,h){const l=u.length/pe|0;(function(q,V){const Z=A.nbits(Math.max(q.length,V.length)/pe|0)-1;for(let tt=a+1;tt<=Z;tt++)i[tt]=A.double(i[tt-1]);a=Z})(u,h);const _=A.concatUint8Array([xi.subarray(0,F0-c.length),ro,c]),p=63&_[pe-1];_[pe-1]&=192;const R=t(_),M=A.concatUint8Array([R,x1(R.subarray(0,8),R.subarray(1,9))]),N=A.shiftRight(M.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),j=new Uint8Array(pe),Y=new Uint8Array(u.length+Ar);let F,E=0;for(F=0;F<l;F++)me(N,i[Ja(F+1)]),Y.set(me(s(x1(N,u)),N),E),me(j,s===t?u:Y.subarray(E)),u=u.subarray(pe),E+=pe;if(u.length){me(N,i.x);const q=t(N);Y.set(x1(u,q),E);const V=new Uint8Array(pe);V.set(s===t?u:Y.subarray(E,-Ar),0),V[u.length]=128,me(j,V),E+=u.length}const $=me(t(me(me(j,N),i.$)),function(q){if(!q.length)return xi;const V=q.length/pe|0,Z=new Uint8Array(pe),tt=new Uint8Array(pe);for(let rt=0;rt<V;rt++)me(Z,i[Ja(rt+1)]),me(tt,t(x1(Z,q))),q=q.subarray(pe);if(q.length){me(Z,i.x);const rt=new Uint8Array(pe);rt.set(q,0),rt[q.length]=128,me(rt,Z),me(tt,t(rt))}return tt}(h));return Y.set($,E),Y}return function(s,u){const c=m.read(m.symmetric,s),h=new f1[c](u);t=h.encrypt.bind(h),n=h.decrypt.bind(h);const l=t(xi),_=A.double(l);i=[],i[0]=A.double(_),i.x=l,i.$=_}(r,e),{encrypt:async function(s,u,c){return o(t,s,u,c)},decrypt:async function(s,u,c){if(s.length<Ar)throw Error("Invalid OCB ciphertext");const h=s.subarray(-Ar);s=s.subarray(0,-Ar);const l=o(n,s,u,c);if(A.equalsUint8Array(h,l.subarray(-Ar)))return l.subarray(0,-Ar);throw Error("Authentication tag mismatch")}}}qn.getNonce=function(r,e){const t=r.slice();for(let n=0;n<e.length;n++)t[7+n]^=e[n];return t},qn.blockLength=pe,qn.ivLength=F0,qn.tagLength=Ar;const Pi=68719476704;class qr{constructor(e,t,n,i=16,a){this.tagSize=i,this.gamma0=0,this.counter=1,this.aes=a||new d1(e,void 0,!1,"CTR");let{asm:o,heap:s}=this.aes.acquire_asm();if(o.gcm_init(),this.tagSize<4||this.tagSize>16)throw new fr("illegal tagSize value");const u=t.length||0,c=new Uint8Array(16);u!==12?(this._gcm_mac_process(t),s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=0,s[11]=u>>>29,s[12]=u>>>21&255,s[13]=u>>>13&255,s[14]=u>>>5&255,s[15]=u<<3&255,o.mac(Pt.MAC.GCM,Pt.HEAP_DATA,16),o.get_iv(Pt.HEAP_DATA),o.set_iv(0,0,0,0),c.set(s.subarray(0,16))):(c.set(t),c[15]=1);const h=new DataView(c.buffer);if(this.gamma0=h.getUint32(12),o.set_nonce(h.getUint32(0),h.getUint32(4),h.getUint32(8),0),o.set_mask(0,0,0,4294967295),n!==void 0){if(n.length>Pi)throw new fr("illegal adata length");n.length?(this.adata=n,this._gcm_mac_process(n)):this.adata=void 0}else this.adata=void 0;if(this.counter<1||this.counter>4294967295)throw new RangeError("counter must be a positive 32-bit integer");o.set_counter(0,0,0,this.gamma0+this.counter|0)}static encrypt(e,t,n,i,a){return new qr(t,n,i,a).encrypt(e)}static decrypt(e,t,n,i,a){return new qr(t,n,i,a).decrypt(e)}encrypt(e){return this.AES_GCM_encrypt(e)}decrypt(e){return this.AES_GCM_decrypt(e)}AES_GCM_Encrypt_process(e){let t=0,n=e.length||0,{asm:i,heap:a}=this.aes.acquire_asm(),o=this.counter,s=this.aes.pos,u=this.aes.len,c=0,h=u+n&-16,l=0;if((o-1<<4)+u+n>Pi)throw new RangeError("counter overflow");const _=new Uint8Array(h);for(;n>0;)l=Fr(a,s+u,e,t,n),u+=l,t+=l,n-=l,l=i.cipher(Pt.ENC.CTR,Pt.HEAP_DATA+s,u),l=i.mac(Pt.MAC.GCM,Pt.HEAP_DATA+s,l),l&&_.set(a.subarray(s,s+l),c),o+=l>>>4,c+=l,l<u?(s+=l,u-=l):(s=0,u=0);return this.counter=o,this.aes.pos=s,this.aes.len=u,_}AES_GCM_Encrypt_finish(){let{asm:e,heap:t}=this.aes.acquire_asm(),n=this.counter,i=this.tagSize,a=this.adata,o=this.aes.pos,s=this.aes.len;const u=new Uint8Array(s+i);e.cipher(Pt.ENC.CTR,Pt.HEAP_DATA+o,s+15&-16),s&&u.set(t.subarray(o,o+s));let c=s;for(;15&c;c++)t[o+c]=0;e.mac(Pt.MAC.GCM,Pt.HEAP_DATA+o,c);const h=a!==void 0?a.length:0,l=(n-1<<4)+s;return t[0]=0,t[1]=0,t[2]=0,t[3]=h>>>29,t[4]=h>>>21,t[5]=h>>>13&255,t[6]=h>>>5&255,t[7]=h<<3&255,t[8]=t[9]=t[10]=0,t[11]=l>>>29,t[12]=l>>>21&255,t[13]=l>>>13&255,t[14]=l>>>5&255,t[15]=l<<3&255,e.mac(Pt.MAC.GCM,Pt.HEAP_DATA,16),e.get_iv(Pt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Pt.ENC.CTR,Pt.HEAP_DATA,16),u.set(t.subarray(0,i),s),this.counter=1,this.aes.pos=0,this.aes.len=0,u}AES_GCM_Decrypt_process(e){let t=0,n=e.length||0,{asm:i,heap:a}=this.aes.acquire_asm(),o=this.counter,s=this.tagSize,u=this.aes.pos,c=this.aes.len,h=0,l=c+n>s?c+n-s&-16:0,_=c+n-l,p=0;if((o-1<<4)+c+n>Pi)throw new RangeError("counter overflow");const R=new Uint8Array(l);for(;n>_;)p=Fr(a,u+c,e,t,n-_),c+=p,t+=p,n-=p,p=i.mac(Pt.MAC.GCM,Pt.HEAP_DATA+u,p),p=i.cipher(Pt.DEC.CTR,Pt.HEAP_DATA+u,p),p&&R.set(a.subarray(u,u+p),h),o+=p>>>4,h+=p,u=0,c=0;return n>0&&(c+=Fr(a,0,e,t,n)),this.counter=o,this.aes.pos=u,this.aes.len=c,R}AES_GCM_Decrypt_finish(){let{asm:e,heap:t}=this.aes.acquire_asm(),n=this.tagSize,i=this.adata,a=this.counter,o=this.aes.pos,s=this.aes.len,u=s-n;if(s<n)throw new Wi("authentication tag not found");const c=new Uint8Array(u),h=new Uint8Array(t.subarray(o+u,o+s));let l=u;for(;15&l;l++)t[o+l]=0;e.mac(Pt.MAC.GCM,Pt.HEAP_DATA+o,l),e.cipher(Pt.DEC.CTR,Pt.HEAP_DATA+o,l),u&&c.set(t.subarray(o,o+u));const _=i!==void 0?i.length:0,p=(a-1<<4)+s-n;t[0]=0,t[1]=0,t[2]=0,t[3]=_>>>29,t[4]=_>>>21,t[5]=_>>>13&255,t[6]=_>>>5&255,t[7]=_<<3&255,t[8]=t[9]=t[10]=0,t[11]=p>>>29,t[12]=p>>>21&255,t[13]=p>>>13&255,t[14]=p>>>5&255,t[15]=p<<3&255,e.mac(Pt.MAC.GCM,Pt.HEAP_DATA,16),e.get_iv(Pt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Pt.ENC.CTR,Pt.HEAP_DATA,16);let R=0;for(let M=0;M<n;++M)R|=h[M]^t[M];if(R)throw new $i("data integrity check failed");return this.counter=1,this.aes.pos=0,this.aes.len=0,c}AES_GCM_decrypt(e){const t=this.AES_GCM_Decrypt_process(e),n=this.AES_GCM_Decrypt_finish(),i=new Uint8Array(t.length+n.length);return t.length&&i.set(t),n.length&&i.set(n,t.length),i}AES_GCM_encrypt(e){const t=this.AES_GCM_Encrypt_process(e),n=this.AES_GCM_Encrypt_finish(),i=new Uint8Array(t.length+n.length);return t.length&&i.set(t),n.length&&i.set(n,t.length),i}_gcm_mac_process(e){let{asm:t,heap:n}=this.aes.acquire_asm(),i=0,a=e.length||0,o=0;for(;a>0;){for(o=Fr(n,0,e,i,a),i+=o,a-=o;15&o;)n[o++]=0;t.mac(Pt.MAC.GCM,Pt.HEAP_DATA,o)}}}const Ui=A.getWebCrypto(),ts=A.getNodeCrypto(),es=A.getNodeBuffer(),ln=16,Ki="AES-GCM";async function fn(r,e){if(r!==m.symmetric.aes128&&r!==m.symmetric.aes192&&r!==m.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(A.getWebCrypto()&&e.length!==24){const t=await Ui.importKey("raw",e,{name:Ki},!1,["encrypt","decrypt"]);return{encrypt:async function(n,i,a=new Uint8Array){if(!n.length)return qr.encrypt(n,e,i,a);const o=await Ui.encrypt({name:Ki,iv:i,additionalData:a,tagLength:8*ln},t,n);return new Uint8Array(o)},decrypt:async function(n,i,a=new Uint8Array){if(n.length===ln)return qr.decrypt(n,e,i,a);const o=await Ui.decrypt({name:Ki,iv:i,additionalData:a,tagLength:8*ln},t,n);return new Uint8Array(o)}}}return A.getNodeCrypto()?{encrypt:async function(t,n,i=new Uint8Array){const a=new ts.createCipheriv("aes-"+8*e.length+"-gcm",e,n);a.setAAD(i);const o=es.concat([a.update(t),a.final(),a.getAuthTag()]);return new Uint8Array(o)},decrypt:async function(t,n,i=new Uint8Array){const a=new ts.createDecipheriv("aes-"+8*e.length+"-gcm",e,n);a.setAAD(i),a.setAuthTag(t.slice(t.length-ln,t.length));const o=es.concat([a.update(t.slice(0,t.length-ln)),a.final()]);return new Uint8Array(o)}}:{encrypt:async function(t,n,i){return qr.encrypt(t,e,n,i)},decrypt:async function(t,n,i){return qr.decrypt(t,e,n,i)}}}fn.getNonce=function(r,e){const t=r.slice();for(let n=0;n<e.length;n++)t[4+n]^=e[n];return t},fn.blockLength=16,fn.ivLength=12,fn.tagLength=ln;var H0={cfb:$3,gcm:fn,experimentalGCM:fn,eax:Hn,ocb:qn},Ye=la(function(r){(function(e){var t=function(S){var O,w=new Float64Array(16);if(S)for(O=0;O<S.length;O++)w[O]=S[O];return w},n=function(){throw Error("no PRNG")},i=new Uint8Array(32);i[0]=9;var a=t(),o=t([1]),s=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(S,O,w,d){return function(P,G,W,Q,y){var f,g=0;for(f=0;f<y;f++)g|=P[G+f]^W[Q+f];return(1&g-1>>>8)-1}(S,O,w,d,32)}function R(S,O){var w;for(w=0;w<16;w++)S[w]=0|O[w]}function M(S){var O,w,d=1;for(O=0;O<16;O++)w=S[O]+d+65535,d=Math.floor(w/65536),S[O]=w-65536*d;S[0]+=d-1+37*(d-1)}function N(S,O,w){for(var d,P=~(w-1),G=0;G<16;G++)d=P&(S[G]^O[G]),S[G]^=d,O[G]^=d}function j(S,O){var w,d,P,G=t(),W=t();for(w=0;w<16;w++)W[w]=O[w];for(M(W),M(W),M(W),d=0;d<2;d++){for(G[0]=W[0]-65517,w=1;w<15;w++)G[w]=W[w]-65535-(G[w-1]>>16&1),G[w-1]&=65535;G[15]=W[15]-32767-(G[14]>>16&1),P=G[15]>>16&1,G[14]&=65535,N(W,G,1-P)}for(w=0;w<16;w++)S[2*w]=255&W[w],S[2*w+1]=W[w]>>8}function Y(S,O){var w=new Uint8Array(32),d=new Uint8Array(32);return j(w,S),j(d,O),p(w,0,d,0)}function F(S){var O=new Uint8Array(32);return j(O,S),1&O[0]}function E(S,O){var w;for(w=0;w<16;w++)S[w]=O[2*w]+(O[2*w+1]<<8);S[15]&=32767}function $(S,O,w){for(var d=0;d<16;d++)S[d]=O[d]+w[d]}function q(S,O,w){for(var d=0;d<16;d++)S[d]=O[d]-w[d]}function V(S,O,w){var d,P,G=0,W=0,Q=0,y=0,f=0,g=0,v=0,C=0,x=0,B=0,ct=0,at=0,ut=0,D=0,U=0,K=0,I=0,T=0,z=0,k=0,b=0,et=0,it=0,St=0,It=0,zt=0,Kt=0,Vt=0,Yt=0,Jt=0,ee=0,Ut=w[0],Nt=w[1],Rt=w[2],Et=w[3],qt=w[4],Ot=w[5],Ht=w[6],X=w[7],J=w[8],ot=w[9],bt=w[10],kt=w[11],xt=w[12],vt=w[13],Lt=w[14],jt=w[15];G+=(d=O[0])*Ut,W+=d*Nt,Q+=d*Rt,y+=d*Et,f+=d*qt,g+=d*Ot,v+=d*Ht,C+=d*X,x+=d*J,B+=d*ot,ct+=d*bt,at+=d*kt,ut+=d*xt,D+=d*vt,U+=d*Lt,K+=d*jt,W+=(d=O[1])*Ut,Q+=d*Nt,y+=d*Rt,f+=d*Et,g+=d*qt,v+=d*Ot,C+=d*Ht,x+=d*X,B+=d*J,ct+=d*ot,at+=d*bt,ut+=d*kt,D+=d*xt,U+=d*vt,K+=d*Lt,I+=d*jt,Q+=(d=O[2])*Ut,y+=d*Nt,f+=d*Rt,g+=d*Et,v+=d*qt,C+=d*Ot,x+=d*Ht,B+=d*X,ct+=d*J,at+=d*ot,ut+=d*bt,D+=d*kt,U+=d*xt,K+=d*vt,I+=d*Lt,T+=d*jt,y+=(d=O[3])*Ut,f+=d*Nt,g+=d*Rt,v+=d*Et,C+=d*qt,x+=d*Ot,B+=d*Ht,ct+=d*X,at+=d*J,ut+=d*ot,D+=d*bt,U+=d*kt,K+=d*xt,I+=d*vt,T+=d*Lt,z+=d*jt,f+=(d=O[4])*Ut,g+=d*Nt,v+=d*Rt,C+=d*Et,x+=d*qt,B+=d*Ot,ct+=d*Ht,at+=d*X,ut+=d*J,D+=d*ot,U+=d*bt,K+=d*kt,I+=d*xt,T+=d*vt,z+=d*Lt,k+=d*jt,g+=(d=O[5])*Ut,v+=d*Nt,C+=d*Rt,x+=d*Et,B+=d*qt,ct+=d*Ot,at+=d*Ht,ut+=d*X,D+=d*J,U+=d*ot,K+=d*bt,I+=d*kt,T+=d*xt,z+=d*vt,k+=d*Lt,b+=d*jt,v+=(d=O[6])*Ut,C+=d*Nt,x+=d*Rt,B+=d*Et,ct+=d*qt,at+=d*Ot,ut+=d*Ht,D+=d*X,U+=d*J,K+=d*ot,I+=d*bt,T+=d*kt,z+=d*xt,k+=d*vt,b+=d*Lt,et+=d*jt,C+=(d=O[7])*Ut,x+=d*Nt,B+=d*Rt,ct+=d*Et,at+=d*qt,ut+=d*Ot,D+=d*Ht,U+=d*X,K+=d*J,I+=d*ot,T+=d*bt,z+=d*kt,k+=d*xt,b+=d*vt,et+=d*Lt,it+=d*jt,x+=(d=O[8])*Ut,B+=d*Nt,ct+=d*Rt,at+=d*Et,ut+=d*qt,D+=d*Ot,U+=d*Ht,K+=d*X,I+=d*J,T+=d*ot,z+=d*bt,k+=d*kt,b+=d*xt,et+=d*vt,it+=d*Lt,St+=d*jt,B+=(d=O[9])*Ut,ct+=d*Nt,at+=d*Rt,ut+=d*Et,D+=d*qt,U+=d*Ot,K+=d*Ht,I+=d*X,T+=d*J,z+=d*ot,k+=d*bt,b+=d*kt,et+=d*xt,it+=d*vt,St+=d*Lt,It+=d*jt,ct+=(d=O[10])*Ut,at+=d*Nt,ut+=d*Rt,D+=d*Et,U+=d*qt,K+=d*Ot,I+=d*Ht,T+=d*X,z+=d*J,k+=d*ot,b+=d*bt,et+=d*kt,it+=d*xt,St+=d*vt,It+=d*Lt,zt+=d*jt,at+=(d=O[11])*Ut,ut+=d*Nt,D+=d*Rt,U+=d*Et,K+=d*qt,I+=d*Ot,T+=d*Ht,z+=d*X,k+=d*J,b+=d*ot,et+=d*bt,it+=d*kt,St+=d*xt,It+=d*vt,zt+=d*Lt,Kt+=d*jt,ut+=(d=O[12])*Ut,D+=d*Nt,U+=d*Rt,K+=d*Et,I+=d*qt,T+=d*Ot,z+=d*Ht,k+=d*X,b+=d*J,et+=d*ot,it+=d*bt,St+=d*kt,It+=d*xt,zt+=d*vt,Kt+=d*Lt,Vt+=d*jt,D+=(d=O[13])*Ut,U+=d*Nt,K+=d*Rt,I+=d*Et,T+=d*qt,z+=d*Ot,k+=d*Ht,b+=d*X,et+=d*J,it+=d*ot,St+=d*bt,It+=d*kt,zt+=d*xt,Kt+=d*vt,Vt+=d*Lt,Yt+=d*jt,U+=(d=O[14])*Ut,K+=d*Nt,I+=d*Rt,T+=d*Et,z+=d*qt,k+=d*Ot,b+=d*Ht,et+=d*X,it+=d*J,St+=d*ot,It+=d*bt,zt+=d*kt,Kt+=d*xt,Vt+=d*vt,Yt+=d*Lt,Jt+=d*jt,K+=(d=O[15])*Ut,W+=38*(T+=d*Rt),Q+=38*(z+=d*Et),y+=38*(k+=d*qt),f+=38*(b+=d*Ot),g+=38*(et+=d*Ht),v+=38*(it+=d*X),C+=38*(St+=d*J),x+=38*(It+=d*ot),B+=38*(zt+=d*bt),ct+=38*(Kt+=d*kt),at+=38*(Vt+=d*xt),ut+=38*(Yt+=d*vt),D+=38*(Jt+=d*Lt),U+=38*(ee+=d*jt),G=(d=(G+=38*(I+=d*Nt))+(P=1)+65535)-65536*(P=Math.floor(d/65536)),W=(d=W+P+65535)-65536*(P=Math.floor(d/65536)),Q=(d=Q+P+65535)-65536*(P=Math.floor(d/65536)),y=(d=y+P+65535)-65536*(P=Math.floor(d/65536)),f=(d=f+P+65535)-65536*(P=Math.floor(d/65536)),g=(d=g+P+65535)-65536*(P=Math.floor(d/65536)),v=(d=v+P+65535)-65536*(P=Math.floor(d/65536)),C=(d=C+P+65535)-65536*(P=Math.floor(d/65536)),x=(d=x+P+65535)-65536*(P=Math.floor(d/65536)),B=(d=B+P+65535)-65536*(P=Math.floor(d/65536)),ct=(d=ct+P+65535)-65536*(P=Math.floor(d/65536)),at=(d=at+P+65535)-65536*(P=Math.floor(d/65536)),ut=(d=ut+P+65535)-65536*(P=Math.floor(d/65536)),D=(d=D+P+65535)-65536*(P=Math.floor(d/65536)),U=(d=U+P+65535)-65536*(P=Math.floor(d/65536)),K=(d=K+P+65535)-65536*(P=Math.floor(d/65536)),G=(d=(G+=P-1+37*(P-1))+(P=1)+65535)-65536*(P=Math.floor(d/65536)),W=(d=W+P+65535)-65536*(P=Math.floor(d/65536)),Q=(d=Q+P+65535)-65536*(P=Math.floor(d/65536)),y=(d=y+P+65535)-65536*(P=Math.floor(d/65536)),f=(d=f+P+65535)-65536*(P=Math.floor(d/65536)),g=(d=g+P+65535)-65536*(P=Math.floor(d/65536)),v=(d=v+P+65535)-65536*(P=Math.floor(d/65536)),C=(d=C+P+65535)-65536*(P=Math.floor(d/65536)),x=(d=x+P+65535)-65536*(P=Math.floor(d/65536)),B=(d=B+P+65535)-65536*(P=Math.floor(d/65536)),ct=(d=ct+P+65535)-65536*(P=Math.floor(d/65536)),at=(d=at+P+65535)-65536*(P=Math.floor(d/65536)),ut=(d=ut+P+65535)-65536*(P=Math.floor(d/65536)),D=(d=D+P+65535)-65536*(P=Math.floor(d/65536)),U=(d=U+P+65535)-65536*(P=Math.floor(d/65536)),K=(d=K+P+65535)-65536*(P=Math.floor(d/65536)),G+=P-1+37*(P-1),S[0]=G,S[1]=W,S[2]=Q,S[3]=y,S[4]=f,S[5]=g,S[6]=v,S[7]=C,S[8]=x,S[9]=B,S[10]=ct,S[11]=at,S[12]=ut,S[13]=D,S[14]=U,S[15]=K}function Z(S,O){V(S,O,O)}function tt(S,O){var w,d=t();for(w=0;w<16;w++)d[w]=O[w];for(w=253;w>=0;w--)Z(d,d),w!==2&&w!==4&&V(d,d,O);for(w=0;w<16;w++)S[w]=d[w]}function rt(S,O,w){var d,P,G=new Uint8Array(32),W=new Float64Array(80),Q=t(),y=t(),f=t(),g=t(),v=t(),C=t();for(P=0;P<31;P++)G[P]=O[P];for(G[31]=127&O[31]|64,G[0]&=248,E(W,w),P=0;P<16;P++)y[P]=W[P],g[P]=Q[P]=f[P]=0;for(Q[0]=g[0]=1,P=254;P>=0;--P)N(Q,y,d=G[P>>>3]>>>(7&P)&1),N(f,g,d),$(v,Q,f),q(Q,Q,f),$(f,y,g),q(y,y,g),Z(g,v),Z(C,Q),V(Q,f,Q),V(f,y,v),$(v,Q,f),q(Q,Q,f),Z(y,Q),q(f,g,C),V(Q,f,s),$(Q,Q,g),V(f,f,Q),V(Q,g,C),V(g,y,W),Z(y,v),N(Q,y,d),N(f,g,d);for(P=0;P<16;P++)W[P+16]=Q[P],W[P+32]=f[P],W[P+48]=y[P],W[P+64]=g[P];var x=W.subarray(32),B=W.subarray(16);return tt(x,x),V(B,B,x),j(S,B),0}function ft(S,O){return rt(S,O,i)}function lt(S,O){var w=t(),d=t(),P=t(),G=t(),W=t(),Q=t(),y=t(),f=t(),g=t();q(w,S[1],S[0]),q(g,O[1],O[0]),V(w,w,g),$(d,S[0],S[1]),$(g,O[0],O[1]),V(d,d,g),V(P,S[3],O[3]),V(P,P,c),V(G,S[2],O[2]),$(G,G,G),q(W,d,w),q(Q,G,P),$(y,G,P),$(f,d,w),V(S[0],W,Q),V(S[1],f,y),V(S[2],y,Q),V(S[3],W,f)}function mt(S,O,w){var d;for(d=0;d<4;d++)N(S[d],O[d],w)}function L(S,O){var w=t(),d=t(),P=t();tt(P,O[2]),V(w,O[0],P),V(d,O[1],P),j(S,d),S[31]^=F(w)<<7}function yt(S,O,w){var d,P;for(R(S[0],a),R(S[1],o),R(S[2],o),R(S[3],a),P=255;P>=0;--P)mt(S,O,d=w[P/8|0]>>(7&P)&1),lt(O,S),lt(S,S),mt(S,O,d)}function Ct(S,O){var w=[t(),t(),t(),t()];R(w[0],h),R(w[1],l),R(w[2],o),V(w[3],h,l),yt(S,w,O)}function H(S,O,w){var d,P,G=[t(),t(),t(),t()];for(w||n(O,32),(d=e.hash(O.subarray(0,32)))[0]&=248,d[31]&=127,d[31]|=64,Ct(G,d),L(S,G),P=0;P<32;P++)O[P+32]=S[P];return 0}var nt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function pt(S,O){var w,d,P,G;for(d=63;d>=32;--d){for(w=0,P=d-32,G=d-12;P<G;++P)O[P]+=w-16*O[d]*nt[P-(d-32)],w=Math.floor((O[P]+128)/256),O[P]-=256*w;O[P]+=w,O[d]=0}for(w=0,P=0;P<32;P++)O[P]+=w-(O[31]>>4)*nt[P],w=O[P]>>8,O[P]&=255;for(P=0;P<32;P++)O[P]-=w*nt[P];for(d=0;d<32;d++)O[d+1]+=O[d]>>8,S[d]=255&O[d]}function gt(S){var O,w=new Float64Array(64);for(O=0;O<64;O++)w[O]=S[O];for(O=0;O<64;O++)S[O]=0;pt(S,w)}function dt(S,O){var w=t(),d=t(),P=t(),G=t(),W=t(),Q=t(),y=t();return R(S[2],o),E(S[1],O),Z(P,S[1]),V(G,P,u),q(P,P,S[2]),$(G,S[2],G),Z(W,G),Z(Q,W),V(y,Q,W),V(w,y,P),V(w,w,G),function(f,g){var v,C=t();for(v=0;v<16;v++)C[v]=g[v];for(v=250;v>=0;v--)Z(C,C),v!==1&&V(C,C,g);for(v=0;v<16;v++)f[v]=C[v]}(w,w),V(w,w,P),V(w,w,G),V(w,w,G),V(S[0],w,G),Z(d,S[0]),V(d,d,G),Y(d,P)&&V(S[0],S[0],_),Z(d,S[0]),V(d,d,G),Y(d,P)?-1:(F(S[0])===O[31]>>7&&q(S[0],a,S[0]),V(S[3],S[0],S[1]),0)}var ht=64;function wt(){for(var S=0;S<arguments.length;S++)if(!(arguments[S]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function st(S){for(var O=0;O<S.length;O++)S[O]=0}e.scalarMult=function(S,O){if(wt(S,O),S.length!==32)throw Error("bad n size");if(O.length!==32)throw Error("bad p size");var w=new Uint8Array(32);return rt(w,S,O),w},e.box={},e.box.keyPair=function(){var S,O,w=new Uint8Array(32),d=new Uint8Array(32);return S=w,n(O=d,32),ft(S,O),{publicKey:w,secretKey:d}},e.box.keyPair.fromSecretKey=function(S){if(wt(S),S.length!==32)throw Error("bad secret key size");var O=new Uint8Array(32);return ft(O,S),{publicKey:O,secretKey:new Uint8Array(S)}},e.sign=function(S,O){if(wt(S,O),O.length!==64)throw Error("bad secret key size");var w=new Uint8Array(ht+S.length);return function(d,P,G,W){var Q,y,f,g,v,C=new Float64Array(64),x=[t(),t(),t(),t()];(Q=e.hash(W.subarray(0,32)))[0]&=248,Q[31]&=127,Q[31]|=64;var B=G+64;for(g=0;g<G;g++)d[64+g]=P[g];for(g=0;g<32;g++)d[32+g]=Q[32+g];for(gt(f=e.hash(d.subarray(32,B))),Ct(x,f),L(d,x),g=32;g<64;g++)d[g]=W[g];for(gt(y=e.hash(d.subarray(0,B))),g=0;g<64;g++)C[g]=0;for(g=0;g<32;g++)C[g]=f[g];for(g=0;g<32;g++)for(v=0;v<32;v++)C[g+v]+=y[g]*Q[v];pt(d.subarray(32),C)}(w,S,S.length,O),w},e.sign.detached=function(S,O){for(var w=e.sign(S,O),d=new Uint8Array(ht),P=0;P<d.length;P++)d[P]=w[P];return d},e.sign.detached.verify=function(S,O,w){if(wt(S,O,w),O.length!==ht)throw Error("bad signature size");if(w.length!==32)throw Error("bad public key size");var d,P=new Uint8Array(ht+S.length),G=new Uint8Array(ht+S.length);for(d=0;d<ht;d++)P[d]=O[d];for(d=0;d<S.length;d++)P[d+ht]=S[d];return function(W,Q,y,f){var g,v,C=new Uint8Array(32),x=[t(),t(),t(),t()],B=[t(),t(),t(),t()];if(y<64||dt(B,f))return-1;for(g=0;g<y;g++)W[g]=Q[g];for(g=0;g<32;g++)W[g+32]=f[g];if(gt(v=e.hash(W.subarray(0,y))),yt(x,B,v),Ct(B,Q.subarray(32)),lt(x,B),L(C,x),y-=64,p(Q,0,C,0)){for(g=0;g<y;g++)W[g]=0;return-1}for(g=0;g<y;g++)W[g]=Q[g+64];return y}(G,P,P.length,w)>=0},e.sign.keyPair=function(){var S=new Uint8Array(32),O=new Uint8Array(64);return H(S,O),{publicKey:S,secretKey:O}},e.sign.keyPair.fromSecretKey=function(S){if(wt(S),S.length!==64)throw Error("bad secret key size");for(var O=new Uint8Array(32),w=0;w<O.length;w++)O[w]=S[32+w];return{publicKey:O,secretKey:new Uint8Array(S)}},e.sign.keyPair.fromSeed=function(S){if(wt(S),S.length!==32)throw Error("bad seed size");for(var O=new Uint8Array(32),w=new Uint8Array(64),d=0;d<32;d++)w[d]=S[d];return H(O,w,!0),{publicKey:O,secretKey:w}},e.setPRNG=function(S){n=S},function(){var S=typeof self<"u"?self.crypto||self.msCrypto:null;S&&S.getRandomValues?e.setPRNG(function(O,w){var d,P=new Uint8Array(w);for(d=0;d<w;d+=65536)S.getRandomValues(P.subarray(d,d+Math.min(w-d,65536)));for(d=0;d<w;d++)O[d]=P[d];st(P)}):r3!==void 0&&(S=void 0)&&S.randomBytes&&e.setPRNG(function(O,w){var d,P=S.randomBytes(w);for(d=0;d<w;d++)O[d]=P[d];st(P)})}()})(r.exports?r.exports:self.nacl=self.nacl||{})});const rs=A.getNodeCrypto();function Xe(r){const e=new Uint8Array(r);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(e);else{if(!rs)throw Error("No secure random number generator available.");{const t=rs.randomBytes(e.length);e.set(t)}}return e}async function gr(r,e){const t=await A.getBigInteger();if(e.lt(r))throw Error("Illegal parameter value: max <= min");const n=e.sub(r),i=n.byteLength();return new t(await Xe(i+8)).mod(n).add(r)}var no=Object.freeze({__proto__:null,getRandomBytes:Xe,getRandomBigInteger:gr});async function ns(r,e,t){const n=await A.getBigInteger(),i=new n(1),a=i.leftShift(new n(r-1)),o=new n(30),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],u=await gr(a,a.leftShift(i));let c=u.mod(o).toNumber();do u.iadd(new n(s[c])),c=(c+s[c])%s.length,u.bitLength()>r&&(u.imod(a.leftShift(i)).iadd(a),c=u.mod(o).toNumber());while(!await q0(u,e,t));return u}async function q0(r,e,t){return!(e&&!r.dec().gcd(e).isOne())&&!!await async function(n){const i=await A.getBigInteger();return io.every(a=>n.mod(new i(a))!==0)}(r)&&!!await async function(n,i){const a=await A.getBigInteger();return i=i||new a(2),i.modExp(n.dec(),n).isOne()}(r)&&!!await async function(n,i,a){const o=await A.getBigInteger(),s=n.bitLength();i||(i=Math.max(1,s/48|0));const u=n.dec();let c=0;for(;!u.getBit(c);)c++;const h=n.rightShift(new o(c));for(;i>0;i--){let l,_=(a?a():await gr(new o(2),u)).modExp(h,n);if(!_.isOne()&&!_.equal(u)){for(l=1;l<c;l++){if(_=_.mul(_).mod(n),_.isOne())return!1;if(_.equal(u))break}if(l===c)return!1}}return!0}(r,t)}const io=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999],Le=[];function fa(r,e){const t=r.length;if(t>e-11)throw Error("Message too long");const n=function(a){const o=new Uint8Array(a);let s=0;for(;s<a;){const u=Xe(a-s);for(let c=0;c<u.length;c++)u[c]!==0&&(o[s++]=u[c])}return o}(e-t-3),i=new Uint8Array(e);return i[1]=2,i.set(n,2),i.set(r,e-t),i}function ya(r,e){let t=2,n=1;for(let s=t;s<r.length;s++)n&=r[s]!==0,t+=n;const i=t-2,a=r.subarray(t+1),o=r[0]===0&r[1]===2&i>=8&!n;if(e)return A.selectUint8Array(o,a,e);if(o)return a;throw Error("Decryption error")}async function Yi(r,e,t){let n;if(e.length!==kn.getHashByteLength(r))throw Error("Invalid hash length");const i=new Uint8Array(Le[r].length);for(n=0;n<Le[r].length;n++)i[n]=Le[r][n];const a=i.length+e.length;if(t<a+11)throw Error("Intended encoded message length too short");const o=new Uint8Array(t-a-3).fill(255),s=new Uint8Array(t);return s[1]=1,s.set(o,2),s.set(i,t-a),s.set(e,t-e.length),s}Le[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Le[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Le[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Le[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Le[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Le[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Le[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var ao=Object.freeze({__proto__:null,emeEncode:fa,emeDecode:ya,emsaEncode:Yi});const sn=A.getWebCrypto(),fe=A.getNodeCrypto(),j0=void 0,on=fe?j0.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}):void 0,P1=fe?j0.define("RSAPubliceKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}):void 0;var so=Object.freeze({__proto__:null,sign:async function(r,e,t,n,i,a,o,s,u){if(e&&!A.isStream(e)){if(A.getWebCrypto())try{return await async function(c,h,l,_,p,R,M,N){const j=await async function(E,$,q,V,Z,tt){const rt=await A.getBigInteger(),ft=new rt(V),lt=new rt(Z),mt=new rt(q);let L=mt.mod(lt.dec()),yt=mt.mod(ft.dec());return yt=yt.toUint8Array(),L=L.toUint8Array(),{kty:"RSA",n:ke(E,!0),e:ke($,!0),d:ke(q,!0),p:ke(Z,!0),q:ke(V,!0),dp:ke(L,!0),dq:ke(yt,!0),qi:ke(tt,!0),ext:!0}}(l,_,p,R,M,N),Y={name:"RSASSA-PKCS1-v1_5",hash:{name:c}},F=await sn.importKey("jwk",j,Y,!1,["sign"]);return new Uint8Array(await sn.sign("RSASSA-PKCS1-v1_5",F,h))}(m.read(m.webHash,r),e,t,n,i,a,o,s)}catch(c){A.printDebugError(c)}else if(A.getNodeCrypto())return async function(c,h,l,_,p,R,M,N){const{default:j}=await Or(()=>import("./bn.min.3fe96d20.js"),[],import.meta.url),Y=new j(R),F=new j(M),E=new j(p),$=E.mod(F.subn(1)),q=E.mod(Y.subn(1)),V=fe.createSign(m.read(m.hash,c));V.write(h),V.end();const Z={version:0,modulus:new j(l),publicExponent:new j(_),privateExponent:new j(p),prime1:new j(M),prime2:new j(R),exponent1:$,exponent2:q,coefficient:new j(N)};if(fe.createPrivateKey!==void 0){const rt=on.encode(Z,"der");return new Uint8Array(V.sign({key:rt,format:"der",type:"pkcs1"}))}const tt=on.encode(Z,"pem",{label:"RSA PRIVATE KEY"});return new Uint8Array(V.sign(tt))}(r,e,t,n,i,a,o,s)}return async function(c,h,l,_){const p=await A.getBigInteger();h=new p(h);const R=new p(await Yi(c,_,h.byteLength()));if(l=new p(l),R.gte(h))throw Error("Message size cannot exceed modulus size");return R.modExp(l,h).toUint8Array("be",h.byteLength())}(r,t,i,u)},verify:async function(r,e,t,n,i,a){if(e&&!A.isStream(e)){if(A.getWebCrypto())try{return await async function(o,s,u,c,h){const l=function(p,R){return{kty:"RSA",n:ke(p,!0),e:ke(R,!0),ext:!0}}(c,h),_=await sn.importKey("jwk",l,{name:"RSASSA-PKCS1-v1_5",hash:{name:o}},!1,["verify"]);return sn.verify("RSASSA-PKCS1-v1_5",_,u,s)}(m.read(m.webHash,r),e,t,n,i)}catch(o){A.printDebugError(o)}else if(A.getNodeCrypto())return async function(o,s,u,c,h){const{default:l}=await Or(()=>import("./bn.min.3fe96d20.js"),[],import.meta.url),_=fe.createVerify(m.read(m.hash,o));_.write(s),_.end();const p={modulus:new l(c),publicExponent:new l(h)};let R;fe.createPrivateKey!==void 0?R={key:P1.encode(p,"der"),format:"der",type:"pkcs1"}:R=P1.encode(p,"pem",{label:"RSA PUBLIC KEY"});try{return await _.verify(R,u)}catch{return!1}}(r,e,t,n,i)}return async function(o,s,u,c,h){const l=await A.getBigInteger();if(u=new l(u),s=new l(s),c=new l(c),s.gte(u))throw Error("Signature size cannot exceed modulus size");const _=s.modExp(c,u).toUint8Array("be",u.byteLength()),p=await Yi(o,h,u.byteLength());return A.equalsUint8Array(_,p)}(r,t,n,i,a)},encrypt:async function(r,e,t){return A.getNodeCrypto()?async function(n,i,a){const{default:o}=await Or(()=>import("./bn.min.3fe96d20.js"),[],import.meta.url),s={modulus:new o(i),publicExponent:new o(a)};let u;return fe.createPrivateKey!==void 0?u={key:P1.encode(s,"der"),format:"der",type:"pkcs1",padding:fe.constants.RSA_PKCS1_PADDING}:u={key:P1.encode(s,"pem",{label:"RSA PUBLIC KEY"}),padding:fe.constants.RSA_PKCS1_PADDING},new Uint8Array(fe.publicEncrypt(u,n))}(r,e,t):async function(n,i,a){const o=await A.getBigInteger();if(i=new o(i),n=new o(fa(n,i.byteLength())),a=new o(a),n.gte(i))throw Error("Message size cannot exceed modulus size");return n.modExp(a,i).toUint8Array("be",i.byteLength())}(r,e,t)},decrypt:async function(r,e,t,n,i,a,o,s){return A.getNodeCrypto()?async function(u,c,h,l,_,p,R,M){const{default:N}=await Or(()=>import("./bn.min.3fe96d20.js"),[],import.meta.url),j=new N(_),Y=new N(p),F=new N(l),E=F.mod(Y.subn(1)),$=F.mod(j.subn(1)),q={version:0,modulus:new N(c),publicExponent:new N(h),privateExponent:new N(l),prime1:new N(p),prime2:new N(_),exponent1:E,exponent2:$,coefficient:new N(R)};let V;fe.createPrivateKey!==void 0?V={key:on.encode(q,"der"),format:"der",type:"pkcs1",padding:fe.constants.RSA_PKCS1_PADDING}:V={key:on.encode(q,"pem",{label:"RSA PRIVATE KEY"}),padding:fe.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(fe.privateDecrypt(V,u))}catch{if(M)return M;throw Error("Decryption error")}}(r,e,t,n,i,a,o,s):async function(u,c,h,l,_,p,R,M){const N=await A.getBigInteger();if(u=new N(u),c=new N(c),h=new N(h),l=new N(l),_=new N(_),p=new N(p),R=new N(R),u.gte(c))throw Error("Data too large.");const j=l.mod(p.dec()),Y=l.mod(_.dec()),F=(await gr(new N(2),c)).mod(c),E=F.modInv(c).modExp(h,c);u=u.mul(E).mod(c);const $=u.modExp(Y,_),q=u.modExp(j,p);let Z=R.mul(q.sub($)).mod(p).mul(_).add($);return Z=Z.mul(F).mod(c),ya(Z.toUint8Array("be",c.byteLength()),M)}(r,e,t,n,i,a,o,s)},generate:async function(r,e){if(e=new(await A.getBigInteger())(e),A.getWebCrypto()){const o={name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:e.toUint8Array(),hash:{name:"SHA-1"}},s=await sn.generateKey(o,!0,["sign","verify"]),u=await sn.exportKey("jwk",s.privateKey);return{n:hr(u.n),e:e.toUint8Array(),d:hr(u.d),p:hr(u.q),q:hr(u.p),u:hr(u.qi)}}if(A.getNodeCrypto()&&fe.generateKeyPair&&on){const o={modulusLength:r,publicExponent:e.toNumber(),publicKeyEncoding:{type:"pkcs1",format:"der"},privateKeyEncoding:{type:"pkcs1",format:"der"}},s=await new Promise((u,c)=>{fe.generateKeyPair("rsa",o,(h,l,_)=>{h?c(h):u(on.decode(_,"der"))})});return{n:s.modulus.toArrayLike(Uint8Array),e:s.publicExponent.toArrayLike(Uint8Array),d:s.privateExponent.toArrayLike(Uint8Array),p:s.prime2.toArrayLike(Uint8Array),q:s.prime1.toArrayLike(Uint8Array),u:s.coefficient.toArrayLike(Uint8Array)}}let t,n,i;do n=await ns(r-(r>>1),e,40),t=await ns(r>>1,e,40),i=t.mul(n);while(i.bitLength()!==r);const a=t.dec().imul(n.dec());return n.lt(t)&&([t,n]=[n,t]),{n:i.toUint8Array(),e:e.toUint8Array(),d:e.modInv(a).toUint8Array(),p:t.toUint8Array(),q:n.toUint8Array(),u:t.modInv(n).toUint8Array()}},validateParams:async function(r,e,t,n,i,a){const o=await A.getBigInteger();if(r=new o(r),n=new o(n),i=new o(i),!n.mul(i).equal(r))return!1;const s=new o(2);if(a=new o(a),!n.mul(a).mod(i).isOne())return!1;e=new o(e),t=new o(t);const u=new o(Math.floor(r.bitLength()/3)),c=await gr(s,s.leftShift(u)),h=c.mul(t).mul(e);return!(!h.mod(n.dec()).equal(c)||!h.mod(i.dec()).equal(c))}}),oo=Object.freeze({__proto__:null,encrypt:async function(r,e,t,n){const i=await A.getBigInteger();e=new i(e),t=new i(t),n=new i(n);const a=new i(fa(r,e.byteLength())),o=await gr(new i(1),e.dec());return{c1:t.modExp(o,e).toUint8Array(),c2:n.modExp(o,e).imul(a).imod(e).toUint8Array()}},decrypt:async function(r,e,t,n,i){const a=await A.getBigInteger();return r=new a(r),e=new a(e),t=new a(t),n=new a(n),ya(r.modExp(n,t).modInv(t).imul(e).imod(t).toUint8Array("be",t.byteLength()),i)},validateParams:async function(r,e,t,n){const i=await A.getBigInteger();r=new i(r),e=new i(e),t=new i(t);const a=new i(1);if(e.lte(a)||e.gte(r))return!1;const o=new i(r.bitLength()),s=new i(1023);if(o.lt(s)||!e.modExp(r.dec(),r).isOne())return!1;let u=e;const c=new i(1),h=new i(2).leftShift(new i(17));for(;c.lt(h);){if(u=u.mul(e).imod(r),u.isOne())return!1;c.iinc()}n=new i(n);const l=new i(2),_=await gr(l.leftShift(o.dec()),l.leftShift(o)),p=r.dec().imul(_).iadd(n);return!!t.equal(e.modExp(p,r))}});class qe{constructor(e){if(e instanceof qe)this.oid=e.oid;else if(A.isArray(e)||A.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return A.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return A.uint8ArrayToHex(this.oid)}getName(){const e=this.toHex();if(m.curve[e])return m.write(m.curve,e);throw Error("Unknown curve object identifier.")}}function li(r,e){return r.keyPair({priv:e})}function di(r,e){const t=r.keyPair({pub:e});if(t.validate().result!==!0)throw Error("Invalid elliptic public key");return t}async function xn(r){if(!At.useIndutnyElliptic)throw Error("This curve is only supported in the full build of OpenPGP.js");const{default:e}=await Or(()=>import("./elliptic.min.6a81295a.js"),["./elliptic.min.6a81295a.js","./bn.min.3fe96d20.js"],import.meta.url);return new e.ec(r)}function co(r){let e,t=0;const n=r[0];return n<192?([t]=r,e=1):n<255?(t=(r[0]-192<<8)+r[1]+192,e=2):n===255&&(t=A.readNumber(r.subarray(1,5)),e=5),{len:t,offset:e}}function fi(r){return r<192?new Uint8Array([r]):r>191&&r<8384?new Uint8Array([192+(r-192>>8),r-192&255]):A.concatUint8Array([new Uint8Array([255]),A.writeNumber(r,4)])}function uo(r){if(r<0||r>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+r])}function G0(r){return new Uint8Array([192|r])}function is(r,e){return A.concatUint8Array([G0(r),fi(e)])}function B1(r){return[m.packet.literalData,m.packet.compressedData,m.packet.symmetricallyEncryptedData,m.packet.symEncryptedIntegrityProtectedData,m.packet.aeadEncryptedData].includes(r)}async function ho(r,e){const t=Zr(r);let n,i;try{const a=await t.peekBytes(2);if(!a||a.length<2||!(128&a[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const o=await t.readByte();let s,u,c=-1,h=-1;h=0,64&o&&(h=1),h?c=63&o:(c=(63&o)>>2,u=3&o);const l=B1(c);let _,p=null;if(l){if(A.isStream(r)==="array"){const M=new Ge;n=Te(M),p=M}else{const M=new sa;n=Te(M.writable),p=M.readable}i=e({tag:c,packet:p})}else p=[];do{if(h){const M=await t.readByte();if(_=!1,M<192)s=M;else if(M>=192&&M<224)s=(M-192<<8)+await t.readByte()+192;else if(M>223&&M<255){if(s=1<<(31&M),_=!0,!l)throw new TypeError("This packet type does not support partial lengths.")}else s=await t.readByte()<<24|await t.readByte()<<16|await t.readByte()<<8|await t.readByte()}else switch(u){case 0:s=await t.readByte();break;case 1:s=await t.readByte()<<8|await t.readByte();break;case 2:s=await t.readByte()<<24|await t.readByte()<<16|await t.readByte()<<8|await t.readByte();break;default:s=1/0}if(s>0){let M=0;for(;;){n&&await n.ready;const{done:N,value:j}=await t.read();if(N){if(s===1/0)break;throw Error("Unexpected end of packet")}const Y=s===1/0?j:j.subarray(0,s-M);if(n?await n.write(Y):p.push(Y),M+=j.length,M>=s){t.unshift(j.subarray(s-M+j.length));break}}}}while(_);const R=await t.peekBytes(l?1/0:2);return n?(await n.ready,await n.close()):(p=A.concatUint8Array(p),await e({tag:c,packet:p})),!R||!R.length}catch(a){if(n)return await n.abort(a),!0;throw a}finally{n&&await i,t.releaseLock()}}class ge extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ge),this.name="UnsupportedError"}}class Xi{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}}const Di=A.getWebCrypto(),Z1=A.getNodeCrypto(),Je={p256:"P-256",p384:"P-384",p521:"P-521"},ar=Z1?Z1.getCurves():[],Er=Z1?{secp256k1:ar.includes("secp256k1")?"secp256k1":void 0,p256:ar.includes("prime256v1")?"prime256v1":void 0,p384:ar.includes("secp384r1")?"secp384r1":void 0,p521:ar.includes("secp521r1")?"secp521r1":void 0,ed25519:ar.includes("ED25519")?"ED25519":void 0,curve25519:ar.includes("X25519")?"X25519":void 0,brainpoolP256r1:ar.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,brainpoolP384r1:ar.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,brainpoolP512r1:ar.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},z1={p256:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:m.publicKey.ecdsa,hash:m.hash.sha256,cipher:m.symmetric.aes128,node:Er.p256,web:Je.p256,payloadSize:32,sharedSize:256},p384:{oid:[6,5,43,129,4,0,34],keyType:m.publicKey.ecdsa,hash:m.hash.sha384,cipher:m.symmetric.aes192,node:Er.p384,web:Je.p384,payloadSize:48,sharedSize:384},p521:{oid:[6,5,43,129,4,0,35],keyType:m.publicKey.ecdsa,hash:m.hash.sha512,cipher:m.symmetric.aes256,node:Er.p521,web:Je.p521,payloadSize:66,sharedSize:528},secp256k1:{oid:[6,5,43,129,4,0,10],keyType:m.publicKey.ecdsa,hash:m.hash.sha256,cipher:m.symmetric.aes128,node:Er.secp256k1,payloadSize:32},ed25519:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:m.publicKey.eddsa,hash:m.hash.sha512,node:!1,payloadSize:32},curve25519:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:m.publicKey.ecdh,hash:m.hash.sha256,cipher:m.symmetric.aes128,node:!1,payloadSize:32},brainpoolP256r1:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:m.publicKey.ecdsa,hash:m.hash.sha256,cipher:m.symmetric.aes128,node:Er.brainpoolP256r1,payloadSize:32},brainpoolP384r1:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:m.publicKey.ecdsa,hash:m.hash.sha384,cipher:m.symmetric.aes192,node:Er.brainpoolP384r1,payloadSize:48},brainpoolP512r1:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:m.publicKey.ecdsa,hash:m.hash.sha512,cipher:m.symmetric.aes256,node:Er.brainpoolP512r1,payloadSize:64}};class mr{constructor(e,t){try{(A.isArray(e)||A.isUint8Array(e))&&(e=new qe(e)),e instanceof qe&&(e=e.getName()),this.name=m.write(m.curve,e)}catch{throw new ge("Unknown curve")}t=t||z1[this.name],this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node&&z1[this.name],this.web=t.web&&z1[this.name],this.payloadSize=t.payloadSize,this.web&&A.getWebCrypto()?this.type="web":this.node&&A.getNodeCrypto()?this.type="node":this.name==="curve25519"?this.type="curve25519":this.name==="ed25519"&&(this.type="ed25519")}async genKeyPair(){let e;switch(this.type){case"web":try{return await async function(n){const i=await Di.generateKey({name:"ECDSA",namedCurve:Je[n]},!0,["sign","verify"]),a=await Di.exportKey("jwk",i.privateKey),o=await Di.exportKey("jwk",i.publicKey);return{publicKey:W0(o),privateKey:hr(a.d)}}(this.name)}catch(n){A.printDebugError("Browser did not support generating ec key "+n.message);break}case"node":return async function(n){const i=Z1.createECDH(Er[n]);return await i.generateKeys(),{publicKey:new Uint8Array(i.getPublicKey()),privateKey:new Uint8Array(i.getPrivateKey())}}(this.name);case"curve25519":{const n=Xe(32);n[0]=127&n[0]|64,n[31]&=248;const i=n.slice().reverse();return e=Ye.box.keyPair.fromSecretKey(i),{publicKey:A.concatUint8Array([new Uint8Array([64]),e.publicKey]),privateKey:n}}case"ed25519":{const n=Xe(32),i=Ye.sign.keyPair.fromSeed(n);return{publicKey:A.concatUint8Array([new Uint8Array([64]),i.publicKey]),privateKey:n}}}return e=await(await xn(this.name)).genKeyPair({entropy:A.uint8ArrayToString(Xe(32))}),{publicKey:new Uint8Array(e.getPublic("array",!1)),privateKey:e.getPrivate().toArrayLike(Uint8Array)}}}async function V0(r,e,t,n){const i={p256:!0,p384:!0,p521:!0,secp256k1:!0,curve25519:r===m.publicKey.ecdh,brainpoolP256r1:!0,brainpoolP384r1:!0,brainpoolP512r1:!0},a=e.getName();if(!i[a])return!1;if(a==="curve25519"){n=n.slice().reverse();const{publicKey:s}=Ye.box.keyPair.fromSecretKey(n);t=new Uint8Array(t);const u=new Uint8Array([64,...s]);return!!A.equalsUint8Array(u,t)}const o=await xn(a);try{t=di(o,t).getPublic()}catch{return!1}return!!li(o,n).getPublic().eq(t)}function W0(r){const e=hr(r.x),t=hr(r.y),n=new Uint8Array(e.length+t.length+1);return n[0]=4,n.set(e,1),n.set(t,e.length+1),n}function yi(r,e,t){const n=r,i=t.slice(1,n+1),a=t.slice(n+1,2*n+1);return{kty:"EC",crv:e,x:ke(i,!0),y:ke(a,!0),ext:!0}}function $0(r,e,t,n){const i=yi(r,e,t);return i.d=ke(n,!0),i}const Q1=A.getWebCrypto(),Pn=A.getNodeCrypto();async function as(r,e,t,n,i,a){const o=new mr(r);if(t&&!A.isStream(t)){const s={publicKey:n,privateKey:i};switch(o.type){case"web":try{return await async function(u,c,h,l){const _=u.payloadSize,p=$0(u.payloadSize,Je[u.name],l.publicKey,l.privateKey),R=await Q1.importKey("jwk",p,{name:"ECDSA",namedCurve:Je[u.name],hash:{name:m.read(m.webHash,u.hash)}},!1,["sign"]),M=new Uint8Array(await Q1.sign({name:"ECDSA",namedCurve:Je[u.name],hash:{name:m.read(m.webHash,c)}},R,h));return{r:M.slice(0,_),s:M.slice(_,_<<1)}}(o,e,t,s)}catch(u){if(o.name!=="p521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;A.printDebugError("Browser did not support signing: "+u.message)}break;case"node":{const u=await async function(c,h,l,_){const p=Pn.createSign(m.read(m.hash,h));p.write(l),p.end();const R=lo.encode({version:1,parameters:c.oid,privateKey:Array.from(_.privateKey),publicKey:{unused:0,data:Array.from(_.publicKey)}},"pem",{label:"EC PRIVATE KEY"});return Z0.decode(p.sign(R),"der")}(o,e,t,s);return{r:u.r.toArrayLike(Uint8Array),s:u.s.toArrayLike(Uint8Array)}}}}return async function(s,u,c){const h=await xn(s.name),l=li(h,c),_=l.sign(u);return{r:_.r.toArrayLike(Uint8Array),s:_.s.toArrayLike(Uint8Array)}}(o,a,i)}async function ss(r,e,t,n,i,a){const o=new mr(r);if(n&&!A.isStream(n))switch(o.type){case"web":try{return await async function(s,u,{r:c,s:h},l,_){const p=yi(s.payloadSize,Je[s.name],_),R=await Q1.importKey("jwk",p,{name:"ECDSA",namedCurve:Je[s.name],hash:{name:m.read(m.webHash,s.hash)}},!1,["verify"]),M=A.concatUint8Array([c,h]).buffer;return Q1.verify({name:"ECDSA",namedCurve:Je[s.name],hash:{name:m.read(m.webHash,u)}},R,M,l)}(o,e,t,n,i)}catch(s){if(o.name!=="p521"&&(s.name==="DataError"||s.name==="OperationError"))throw s;A.printDebugError("Browser did not support verifying: "+s.message)}break;case"node":return async function(s,u,{r:c,s:h},l,_){const{default:p}=await Or(()=>import("./bn.min.3fe96d20.js"),[],import.meta.url),R=Pn.createVerify(m.read(m.hash,u));R.write(l),R.end();const M=yo.encode({algorithm:{algorithm:[1,2,840,10045,2,1],parameters:s.oid},subjectPublicKey:{unused:0,data:Array.from(_)}},"pem",{label:"PUBLIC KEY"}),N=Z0.encode({r:new p(c),s:new p(h)},"der");try{return R.verify(M,N)}catch{return!1}}(o,e,t,n,i)}return async function(s,u,c,h){const l=await xn(s.name);return di(l,h).verify(c,u)}(o,t,e===void 0?n:a,i)}const pi=void 0,Z0=Pn?pi.define("ECDSASignature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}):void 0,lo=Pn?pi.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().any(),this.key("publicKey").explicit(1).optional().bitstr())}):void 0,fo=Pn?pi.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}):void 0,yo=Pn?pi.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(fo),this.key("subjectPublicKey").bitstr())}):void 0;var po=Object.freeze({__proto__:null,sign:as,verify:ss,validateParams:async function(r,e,t){const n=new mr(r);if(n.keyType!==m.publicKey.ecdsa)return!1;switch(n.type){case"web":case"node":{const i=Xe(8),a=m.hash.sha256,o=await kn.digest(a,i);try{const s=await as(r,a,i,e,t,o);return await ss(r,a,s,i,e,o)}catch{return!1}}default:return V0(m.publicKey.ecdsa,r,e,t)}}});Ye.hash=r=>new Uint8Array(ui().update(r).digest());var go=Object.freeze({__proto__:null,sign:async function(r,e,t,n,i,a){if(kn.getHashByteLength(e)<kn.getHashByteLength(m.hash.sha256))throw Error("Hash algorithm too weak: sha256 or stronger is required for EdDSA.");const o=A.concatUint8Array([i,n.subarray(1)]),s=Ye.sign.detached(a,o);return{r:s.subarray(0,32),s:s.subarray(32)}},verify:async function(r,e,{r:t,s:n},i,a,o){const s=A.concatUint8Array([t,n]);return Ye.sign.detached.verify(o,s,a.subarray(1))},validateParams:async function(r,e,t){if(r.getName()!=="ed25519")return!1;const{publicKey:n}=Ye.sign.keyPair.fromSeed(t),i=new Uint8Array([64,...n]);return A.equalsUint8Array(e,i)}});function Q0(r,e){const t=new f1["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),i=Y1(e);let a=n;const o=i,s=i.length/2,u=new Uint32Array([0,0]);let c=new Uint32Array(4);for(let h=0;h<=5;++h)for(let l=0;l<s;++l)u[1]=s*h+(1+l),c[0]=a[0],c[1]=a[1],c[2]=o[2*l],c[3]=o[2*l+1],c=Y1(t.encrypt(X1(c))),a=c.subarray(0,2),a[0]^=u[0],a[1]^=u[1],o[2*l]=c[2],o[2*l+1]=c[3];return X1(a,o)}function Y0(r,e){const t=new f1["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),i=Y1(e);let a=i.subarray(0,2);const o=i.subarray(2),s=i.length/2-1,u=new Uint32Array([0,0]);let c=new Uint32Array(4);for(let h=5;h>=0;--h)for(let l=s-1;l>=0;--l)u[1]=s*h+(l+1),c[0]=a[0]^u[0],c[1]=a[1]^u[1],c[2]=o[2*l],c[3]=o[2*l+1],c=Y1(t.decrypt(X1(c))),a=c.subarray(0,2),o[2*l]=c[2],o[2*l+1]=c[3];if(a[0]===n[0]&&a[1]===n[1])return X1(o);throw Error("Key Data Integrity failed")}function Y1(r){const{length:e}=r,t=function(a){if(A.isString(a)){const{length:o}=a,s=new ArrayBuffer(o),u=new Uint8Array(s);for(let c=0;c<o;++c)u[c]=a.charCodeAt(c);return s}return new Uint8Array(a).buffer}(r),n=new DataView(t),i=new Uint32Array(e/4);for(let a=0;a<e/4;++a)i[a]=n.getUint32(4*a);return i}function X1(){let r=0;for(let i=0;i<arguments.length;++i)r+=4*arguments[i].length;const e=new ArrayBuffer(r),t=new DataView(e);let n=0;for(let i=0;i<arguments.length;++i){for(let a=0;a<arguments[i].length;++a)t.setUint32(n+4*a,arguments[i][a]);n+=4*arguments[i].length}return new Uint8Array(e)}var mo=Object.freeze({__proto__:null,wrap:Q0,unwrap:Y0});function X0(r){const e=8-r.length%8,t=new Uint8Array(r.length+e).fill(e);return t.set(r),t}function J0(r){const e=r.length;if(e>0){const t=r[e-1];if(t>=1){const n=r.subarray(e-t),i=new Uint8Array(t).fill(t);if(A.equalsUint8Array(n,i))return r.subarray(0,e-t)}}throw Error("Invalid padding")}var wo=Object.freeze({__proto__:null,encode:X0,decode:J0});const Kr=A.getWebCrypto(),t2=A.getNodeCrypto();function os(r,e,t,n){return A.concatUint8Array([e.write(),new Uint8Array([r]),t.write(),A.stringToUint8Array("Anonymous Sender    "),n.subarray(0,20)])}async function cs(r,e,t,n,i=!1,a=!1){let o;if(i){for(o=0;o<e.length&&e[o]===0;o++);e=e.subarray(o)}if(a){for(o=e.length-1;o>=0&&e[o]===0;o--);e=e.subarray(0,o+1)}return(await kn.digest(r,A.concatUint8Array([new Uint8Array([0,0,0,1]),e,n]))).subarray(0,t)}async function bo(r,e){switch(r.type){case"curve25519":{const t=Xe(32),{secretKey:n,sharedKey:i}=await e2(r,e,null,t);let{publicKey:a}=Ye.box.keyPair.fromSecretKey(n);return a=A.concatUint8Array([new Uint8Array([64]),a]),{publicKey:a,sharedKey:i}}case"web":if(r.web&&A.getWebCrypto())try{return await async function(t,n){const i=yi(t.payloadSize,t.web.web,n);let a=Kr.generateKey({name:"ECDH",namedCurve:t.web.web},!0,["deriveKey","deriveBits"]),o=Kr.importKey("jwk",i,{name:"ECDH",namedCurve:t.web.web},!1,[]);[a,o]=await Promise.all([a,o]);let s=Kr.deriveBits({name:"ECDH",namedCurve:t.web.web,public:o},a.privateKey,t.web.sharedSize),u=Kr.exportKey("jwk",a.publicKey);[s,u]=await Promise.all([s,u]);const c=new Uint8Array(s);return{publicKey:new Uint8Array(W0(u)),sharedKey:c}}(r,e)}catch(t){A.printDebugError(t)}break;case"node":return async function(t,n){const i=t2.createECDH(t.node.node);i.generateKeys();const a=new Uint8Array(i.computeSecret(n));return{publicKey:new Uint8Array(i.getPublicKey()),sharedKey:a}}(r,e)}return async function(t,n){const i=await xn(t.name),a=await t.genKeyPair();n=di(i,n);const o=li(i,a.privateKey),s=a.publicKey,u=o.derive(n.getPublic()),c=i.curve.p.byteLength(),h=u.toArrayLike(Uint8Array,"be",c);return{publicKey:s,sharedKey:h}}(r,e)}async function e2(r,e,t,n){if(n.length!==r.payloadSize){const i=new Uint8Array(r.payloadSize);i.set(n,r.payloadSize-n.length),n=i}switch(r.type){case"curve25519":{const i=n.slice().reverse();return{secretKey:i,sharedKey:Ye.scalarMult(i,e.subarray(1))}}case"web":if(r.web&&A.getWebCrypto())try{return await async function(i,a,o,s){const u=$0(i.payloadSize,i.web.web,o,s);let c=Kr.importKey("jwk",u,{name:"ECDH",namedCurve:i.web.web},!0,["deriveKey","deriveBits"]);const h=yi(i.payloadSize,i.web.web,a);let l=Kr.importKey("jwk",h,{name:"ECDH",namedCurve:i.web.web},!0,[]);[c,l]=await Promise.all([c,l]);let _=Kr.deriveBits({name:"ECDH",namedCurve:i.web.web,public:l},c,i.web.sharedSize),p=Kr.exportKey("jwk",c);[_,p]=await Promise.all([_,p]);const R=new Uint8Array(_);return{secretKey:hr(p.d),sharedKey:R}}(r,e,t,n)}catch(i){A.printDebugError(i)}break;case"node":return async function(i,a,o){const s=t2.createECDH(i.node.node);s.setPrivateKey(o);const u=new Uint8Array(s.computeSecret(a));return{secretKey:new Uint8Array(s.getPrivateKey()),sharedKey:u}}(r,e,n)}return async function(i,a,o){const s=await xn(i.name);a=di(s,a),o=li(s,o);const u=new Uint8Array(o.getPrivate()),c=o.derive(a.getPublic()),h=s.curve.p.byteLength(),l=c.toArrayLike(Uint8Array,"be",h);return{secretKey:u,sharedKey:l}}(r,e,n)}var ko=Object.freeze({__proto__:null,validateParams:async function(r,e,t){return V0(m.publicKey.ecdh,r,e,t)},encrypt:async function(r,e,t,n,i){const a=X0(t),o=new mr(r),{publicKey:s,sharedKey:u}=await bo(o,n),c=os(m.publicKey.ecdh,r,e,i),{keySize:h}=Ir(e.cipher);return{publicKey:s,wrappedKey:Q0(await cs(e.hash,u,h,c),a)}},decrypt:async function(r,e,t,n,i,a,o){const s=new mr(r),{sharedKey:u}=await e2(s,t,i,a),c=os(m.publicKey.ecdh,r,e,o),{keySize:h}=Ir(e.cipher);let l;for(let _=0;_<3;_++)try{return J0(Y0(await cs(e.hash,u,h,c,_===1,_===2),n))}catch(p){l=p}throw l}}),vo=Object.freeze({__proto__:null,Curve:mr,ecdh:ko,ecdsa:po,eddsa:go,generate:async function(r){const e=await A.getBigInteger();r=new mr(r);const t=await r.genKeyPair(),n=new e(t.publicKey).toUint8Array(),i=new e(t.privateKey).toUint8Array("be",r.payloadSize);return{oid:r.oid,Q:n,secret:i,hash:r.hash,cipher:r.cipher}},getPreferredHashAlgo:function(r){return z1[m.write(m.curve,r.toHex())].hash}}),_o=Object.freeze({__proto__:null,sign:async function(r,e,t,n,i,a){const o=await A.getBigInteger(),s=new o(1);let u,c,h,l;n=new o(n),i=new o(i),t=new o(t),a=new o(a),t=t.mod(n),a=a.mod(i);const _=new o(e.subarray(0,i.byteLength())).mod(i);for(;;){if(u=await gr(s,i),c=t.modExp(u,n).imod(i),c.isZero())continue;const p=a.mul(c).imod(i);if(l=_.add(p).imod(i),h=u.modInv(i).imul(l).imod(i),!h.isZero())break}return{r:c.toUint8Array("be",i.byteLength()),s:h.toUint8Array("be",i.byteLength())}},verify:async function(r,e,t,n,i,a,o,s){const u=await A.getBigInteger(),c=new u(0);if(e=new u(e),t=new u(t),a=new u(a),o=new u(o),i=new u(i),s=new u(s),e.lte(c)||e.gte(o)||t.lte(c)||t.gte(o))return A.printDebug("invalid DSA Signature"),!1;const h=new u(n.subarray(0,o.byteLength())).imod(o),l=t.modInv(o);if(l.isZero())return A.printDebug("invalid DSA Signature"),!1;i=i.mod(a),s=s.mod(a);const _=h.mul(l).imod(o),p=e.mul(l).imod(o),R=i.modExp(_,a),M=s.modExp(p,a);return R.mul(M).imod(a).imod(o).equal(e)},validateParams:async function(r,e,t,n,i){const a=await A.getBigInteger();r=new a(r),e=new a(e),t=new a(t),n=new a(n);const o=new a(1);if(t.lte(o)||t.gte(r)||!r.dec().mod(e).isZero()||!t.modExp(e,r).isOne())return!1;const s=new a(e.bitLength()),u=new a(150);if(s.lt(u)||!await q0(e,null,32))return!1;i=new a(i);const c=new a(2),h=await gr(c.leftShift(s.dec()),c.leftShift(s)),l=e.mul(h).add(i);return!!n.equal(t.modExp(l,r))}}),$t={rsa:so,elgamal:oo,elliptic:vo,dsa:_o,nacl:Ye},Ao=Object.freeze({__proto__:null,parseSignatureParams:function(r,e){let t=0;switch(r){case m.publicKey.rsaEncryptSign:case m.publicKey.rsaEncrypt:case m.publicKey.rsaSign:return{s:A.readMPI(e.subarray(t))};case m.publicKey.dsa:case m.publicKey.ecdsa:{const n=A.readMPI(e.subarray(t));return t+=n.length+2,{r:n,s:A.readMPI(e.subarray(t))}}case m.publicKey.eddsa:{let n=A.readMPI(e.subarray(t));t+=n.length+2,n=A.leftPad(n,32);let i=A.readMPI(e.subarray(t));return i=A.leftPad(i,32),{r:n,s:i}}default:throw new ge("Unknown signature algorithm.")}},verify:async function(r,e,t,n,i,a){switch(r){case m.publicKey.rsaEncryptSign:case m.publicKey.rsaEncrypt:case m.publicKey.rsaSign:{const{n:o,e:s}=n,u=A.leftPad(t.s,o.length);return $t.rsa.verify(e,i,u,o,s,a)}case m.publicKey.dsa:{const{g:o,p:s,q:u,y:c}=n,{r:h,s:l}=t;return $t.dsa.verify(e,h,l,a,o,s,u,c)}case m.publicKey.ecdsa:{const{oid:o,Q:s}=n,u=new $t.elliptic.Curve(o).payloadSize,c=A.leftPad(t.r,u),h=A.leftPad(t.s,u);return $t.elliptic.ecdsa.verify(o,e,{r:c,s:h},i,s,a)}case m.publicKey.eddsa:{const{oid:o,Q:s}=n;return $t.elliptic.eddsa.verify(o,e,t,i,s,a)}default:throw Error("Unknown signature algorithm.")}},sign:async function(r,e,t,n,i,a){if(!t||!n)throw Error("Missing key parameters");switch(r){case m.publicKey.rsaEncryptSign:case m.publicKey.rsaEncrypt:case m.publicKey.rsaSign:{const{n:o,e:s}=t,{d:u,p:c,q:h,u:l}=n;return{s:await $t.rsa.sign(e,i,o,s,u,c,h,l,a)}}case m.publicKey.dsa:{const{g:o,p:s,q:u}=t,{x:c}=n;return $t.dsa.sign(e,a,o,s,u,c)}case m.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case m.publicKey.ecdsa:{const{oid:o,Q:s}=t,{d:u}=n;return $t.elliptic.ecdsa.sign(o,e,i,s,u,a)}case m.publicKey.eddsa:{const{oid:o,Q:s}=t,{seed:u}=n;return $t.elliptic.eddsa.sign(o,e,i,s,u,a)}default:throw Error("Unknown signature algorithm.")}}});class us{constructor(e){e=e===void 0?new Uint8Array([]):A.isString(e)?A.stringToUint8Array(e):new Uint8Array(e),this.data=e}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return A.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class hs{constructor(e){if(e){const{hash:t,cipher:n}=e;this.hash=t,this.cipher=n}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw Error("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}function Ci(r){try{r.getName()}catch{throw new ge("Unknown curve OID")}}var Eo=Object.freeze({__proto__:null,publicKeyEncrypt:async function(r,e,t,n){switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:{const{n:i,e:a}=e;return{c:await $t.rsa.encrypt(t,i,a)}}case m.publicKey.elgamal:{const{p:i,g:a,y:o}=e;return $t.elgamal.encrypt(t,i,a,o)}case m.publicKey.ecdh:{const{oid:i,Q:a,kdfParams:o}=e,{publicKey:s,wrappedKey:u}=await $t.elliptic.ecdh.encrypt(i,o,t,a,n);return{V:s,C:new us(u)}}default:return[]}},publicKeyDecrypt:async function(r,e,t,n,i,a){switch(r){case m.publicKey.rsaEncryptSign:case m.publicKey.rsaEncrypt:{const{c:o}=n,{n:s,e:u}=e,{d:c,p:h,q:l,u:_}=t;return $t.rsa.decrypt(o,s,u,c,h,l,_,a)}case m.publicKey.elgamal:{const{c1:o,c2:s}=n,u=e.p,c=t.x;return $t.elgamal.decrypt(o,s,u,c,a)}case m.publicKey.ecdh:{const{oid:o,Q:s,kdfParams:u}=e,{d:c}=t,{V:h,C:l}=n;return $t.elliptic.ecdh.decrypt(o,u,h,l.data,s,c,i)}default:throw Error("Unknown public key encryption algorithm.")}},parsePublicKeyParams:function(r,e){let t=0;switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:case m.publicKey.rsaSign:{const n=A.readMPI(e.subarray(t));t+=n.length+2;const i=A.readMPI(e.subarray(t));return t+=i.length+2,{read:t,publicParams:{n,e:i}}}case m.publicKey.dsa:{const n=A.readMPI(e.subarray(t));t+=n.length+2;const i=A.readMPI(e.subarray(t));t+=i.length+2;const a=A.readMPI(e.subarray(t));t+=a.length+2;const o=A.readMPI(e.subarray(t));return t+=o.length+2,{read:t,publicParams:{p:n,q:i,g:a,y:o}}}case m.publicKey.elgamal:{const n=A.readMPI(e.subarray(t));t+=n.length+2;const i=A.readMPI(e.subarray(t));t+=i.length+2;const a=A.readMPI(e.subarray(t));return t+=a.length+2,{read:t,publicParams:{p:n,g:i,y:a}}}case m.publicKey.ecdsa:{const n=new qe;t+=n.read(e),Ci(n);const i=A.readMPI(e.subarray(t));return t+=i.length+2,{read:t,publicParams:{oid:n,Q:i}}}case m.publicKey.eddsa:{const n=new qe;t+=n.read(e),Ci(n);let i=A.readMPI(e.subarray(t));return t+=i.length+2,i=A.leftPad(i,33),{read:t,publicParams:{oid:n,Q:i}}}case m.publicKey.ecdh:{const n=new qe;t+=n.read(e),Ci(n);const i=A.readMPI(e.subarray(t));t+=i.length+2;const a=new hs;return t+=a.read(e.subarray(t)),{read:t,publicParams:{oid:n,Q:i,kdfParams:a}}}default:throw new ge("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(r,e,t){let n=0;switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:case m.publicKey.rsaSign:{const i=A.readMPI(e.subarray(n));n+=i.length+2;const a=A.readMPI(e.subarray(n));n+=a.length+2;const o=A.readMPI(e.subarray(n));n+=o.length+2;const s=A.readMPI(e.subarray(n));return n+=s.length+2,{read:n,privateParams:{d:i,p:a,q:o,u:s}}}case m.publicKey.dsa:case m.publicKey.elgamal:{const i=A.readMPI(e.subarray(n));return n+=i.length+2,{read:n,privateParams:{x:i}}}case m.publicKey.ecdsa:case m.publicKey.ecdh:{const i=new mr(t.oid);let a=A.readMPI(e.subarray(n));return n+=a.length+2,a=A.leftPad(a,i.payloadSize),{read:n,privateParams:{d:a}}}case m.publicKey.eddsa:{const i=new mr(t.oid);let a=A.readMPI(e.subarray(n));return n+=a.length+2,a=A.leftPad(a,i.payloadSize),{read:n,privateParams:{seed:a}}}default:throw new ge("Unknown public key encryption algorithm.")}},parseEncSessionKeyParams:function(r,e){let t=0;switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:return{c:A.readMPI(e.subarray(t))};case m.publicKey.elgamal:{const n=A.readMPI(e.subarray(t));return t+=n.length+2,{c1:n,c2:A.readMPI(e.subarray(t))}}case m.publicKey.ecdh:{const n=A.readMPI(e.subarray(t));t+=n.length+2;const i=new us;return i.read(e.subarray(t)),{V:n,C:i}}default:throw new ge("Unknown public key encryption algorithm.")}},serializeParams:function(r,e){const t=Object.keys(e).map(n=>{const i=e[n];return A.isUint8Array(i)?A.uint8ArrayToMPI(i):i.write()});return A.concatUint8Array(t)},generateParams:function(r,e,t){switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:case m.publicKey.rsaSign:return $t.rsa.generate(e,65537).then(({n,e:i,d:a,p:o,q:s,u})=>({privateParams:{d:a,p:o,q:s,u},publicParams:{n,e:i}}));case m.publicKey.ecdsa:return $t.elliptic.generate(t).then(({oid:n,Q:i,secret:a})=>({privateParams:{d:a},publicParams:{oid:new qe(n),Q:i}}));case m.publicKey.eddsa:return $t.elliptic.generate(t).then(({oid:n,Q:i,secret:a})=>({privateParams:{seed:a},publicParams:{oid:new qe(n),Q:i}}));case m.publicKey.ecdh:return $t.elliptic.generate(t).then(({oid:n,Q:i,secret:a,hash:o,cipher:s})=>({privateParams:{d:a},publicParams:{oid:new qe(n),Q:i,kdfParams:new hs({hash:o,cipher:s})}}));case m.publicKey.dsa:case m.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},validateParams:async function(r,e,t){if(!e||!t)throw Error("Missing key parameters");switch(r){case m.publicKey.rsaEncrypt:case m.publicKey.rsaEncryptSign:case m.publicKey.rsaSign:{const{n,e:i}=e,{d:a,p:o,q:s,u}=t;return $t.rsa.validateParams(n,i,a,o,s,u)}case m.publicKey.dsa:{const{p:n,q:i,g:a,y:o}=e,{x:s}=t;return $t.dsa.validateParams(n,i,a,o,s)}case m.publicKey.elgamal:{const{p:n,g:i,y:a}=e,{x:o}=t;return $t.elgamal.validateParams(n,i,a,o)}case m.publicKey.ecdsa:case m.publicKey.ecdh:{const n=$t.elliptic[m.read(m.publicKey,r)],{oid:i,Q:a}=e,{d:o}=t;return n.validateParams(i,a,o)}case m.publicKey.eddsa:{const{oid:n,Q:i}=e,{seed:a}=t;return $t.elliptic.eddsa.validateParams(n,i,a)}default:throw Error("Unknown public key algorithm.")}},getPrefixRandom:async function(r){const{blockSize:e}=Ir(r),t=await Xe(e),n=new Uint8Array([t[t.length-2],t[t.length-1]]);return A.concat([t,n])},generateSessionKey:function(r){const{keySize:e}=Ir(r);return Xe(e)},getAEADMode:function(r){const e=m.read(m.aead,r);return H0[e]},getCipher:Ir});const Tt={cipher:f1,hash:kn,mode:H0,publicKey:$t,signature:Ao,random:no,pkcs1:ao,pkcs5:wo,aesKW:mo};Object.assign(Tt,Eo);var y1=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r2(r,e){return r.length===e?r:r.subarray?r.subarray(0,e):(r.length=e,r)}const n2={arraySet:function(r,e,t,n,i){if(e.subarray&&r.subarray)r.set(e.subarray(t,t+n),i);else for(let a=0;a<n;a++)r[i+a]=e[t+a]},flattenChunks:function(r){let e,t,n,i,a;for(n=0,e=0,t=r.length;e<t;e++)n+=r[e].length;const o=new Uint8Array(n);for(i=0,e=0,t=r.length;e<t;e++)a=r[e],o.set(a,i),i+=a.length;return o}},i2={arraySet:function(r,e,t,n,i){for(let a=0;a<n;a++)r[i+a]=e[t+a]},flattenChunks:function(r){return[].concat.apply([],r)}};let Ve=y1?Uint8Array:Array,Ae=y1?Uint16Array:Array,J1=y1?Int32Array:Array,a2=y1?n2.flattenChunks:i2.flattenChunks,tr=y1?n2.arraySet:i2.arraySet;const er=0,So=1,i1=2,xo=3,ae=4,Ji=5,U1=6,Ft=0,yr=1,s2=2,te=-2,pa=-3,Yn=-5,ls=-1,Po=1,K1=2,Uo=3,o2=4,ds=0,fs=1,c2=2,vn=8;function Un(r){let e=r.length;for(;--e>=0;)r[e]=0}const Ko=0,u2=1,Do=2,ga=29,p1=256,a1=p1+1+ga,gn=30,ma=19,ys=2*a1+1,jr=15,Ii=16,Co=7,wa=256,h2=16,l2=17,d2=18,ta=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R1=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Io=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ps=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ur=Array(2*(a1+2));Un(ur);const Xn=Array(2*gn);Un(Xn);const s1=Array(512);Un(s1);const o1=Array(256);Un(o1);const ba=Array(ga);Un(ba);const ti=Array(gn);function Ti(r,e,t,n,i){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=r&&r.length}let gs,ms,ws;function Bi(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}function f2(r){return r<256?s1[r]:s1[256+(r>>>7)]}function c1(r,e){r.pending_buf[r.pending++]=255&e,r.pending_buf[r.pending++]=e>>>8&255}function we(r,e,t){r.bi_valid>Ii-t?(r.bi_buf|=e<<r.bi_valid&65535,c1(r,r.bi_buf),r.bi_buf=e>>Ii-r.bi_valid,r.bi_valid+=t-Ii):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)}function je(r,e,t){we(r,t[2*e],t[2*e+1])}function y2(r,e){let t=0;do t|=1&r,r>>>=1,t<<=1;while(--e>0);return t>>>1}function p2(r,e,t){const n=Array(jr+1);let i,a,o=0;for(i=1;i<=jr;i++)n[i]=o=o+t[i-1]<<1;for(a=0;a<=e;a++){const s=r[2*a+1];s!==0&&(r[2*a]=y2(n[s]++,s))}}function g2(r){let e;for(e=0;e<a1;e++)r.dyn_ltree[2*e]=0;for(e=0;e<gn;e++)r.dyn_dtree[2*e]=0;for(e=0;e<ma;e++)r.bl_tree[2*e]=0;r.dyn_ltree[2*wa]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function m2(r){r.bi_valid>8?c1(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function bs(r,e,t,n){const i=2*e,a=2*t;return r[i]<r[a]||r[i]===r[a]&&n[e]<=n[t]}function zi(r,e,t){const n=r.heap[t];let i=t<<1;for(;i<=r.heap_len&&(i<r.heap_len&&bs(e,r.heap[i+1],r.heap[i],r.depth)&&i++,!bs(e,n,r.heap[i],r.depth));)r.heap[t]=r.heap[i],t=i,i<<=1;r.heap[t]=n}function ks(r,e,t){let n,i,a,o,s=0;if(r.last_lit!==0)do n=r.pending_buf[r.d_buf+2*s]<<8|r.pending_buf[r.d_buf+2*s+1],i=r.pending_buf[r.l_buf+s],s++,n===0?je(r,i,e):(a=o1[i],je(r,a+p1+1,e),o=ta[a],o!==0&&(i-=ba[a],we(r,i,o)),n--,a=f2(n),je(r,a,t),o=R1[a],o!==0&&(n-=ti[a],we(r,n,o)));while(s<r.last_lit);je(r,wa,e)}function Ri(r,e){const t=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.elems;let o,s,u,c=-1;for(r.heap_len=0,r.heap_max=ys,o=0;o<a;o++)t[2*o]!==0?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[2*o+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=c<2?++c:0,t[2*u]=1,r.depth[u]=0,r.opt_len--,i&&(r.static_len-=n[2*u+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)zi(r,t,o);u=a;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],zi(r,t,1),s=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=s,t[2*u]=t[2*o]+t[2*s],r.depth[u]=(r.depth[o]>=r.depth[s]?r.depth[o]:r.depth[s])+1,t[2*o+1]=t[2*s+1]=u,r.heap[1]=u++,zi(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function(h,l){const _=l.dyn_tree,p=l.max_code,R=l.stat_desc.static_tree,M=l.stat_desc.has_stree,N=l.stat_desc.extra_bits,j=l.stat_desc.extra_base,Y=l.stat_desc.max_length;let F,E,$,q,V,Z,tt=0;for(q=0;q<=jr;q++)h.bl_count[q]=0;for(_[2*h.heap[h.heap_max]+1]=0,F=h.heap_max+1;F<ys;F++)E=h.heap[F],q=_[2*_[2*E+1]+1]+1,q>Y&&(q=Y,tt++),_[2*E+1]=q,E>p||(h.bl_count[q]++,V=0,E>=j&&(V=N[E-j]),Z=_[2*E],h.opt_len+=Z*(q+V),M&&(h.static_len+=Z*(R[2*E+1]+V)));if(tt!==0){do{for(q=Y-1;h.bl_count[q]===0;)q--;h.bl_count[q]--,h.bl_count[q+1]+=2,h.bl_count[Y]--,tt-=2}while(tt>0);for(q=Y;q!==0;q--)for(E=h.bl_count[q];E!==0;)$=h.heap[--F],$>p||(_[2*$+1]!==q&&(h.opt_len+=(q-_[2*$+1])*_[2*$],_[2*$+1]=q),E--)}}(r,e),p2(t,c,r.bl_count)}function vs(r,e,t){let n,i,a=-1,o=e[1],s=0,u=7,c=4;for(o===0&&(u=138,c=3),e[2*(t+1)+1]=65535,n=0;n<=t;n++)i=o,o=e[2*(n+1)+1],++s<u&&i===o||(s<c?r.bl_tree[2*i]+=s:i!==0?(i!==a&&r.bl_tree[2*i]++,r.bl_tree[2*h2]++):s<=10?r.bl_tree[2*l2]++:r.bl_tree[2*d2]++,s=0,a=i,o===0?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4))}function _s(r,e,t){let n,i,a=-1,o=e[1],s=0,u=7,c=4;for(o===0&&(u=138,c=3),n=0;n<=t;n++)if(i=o,o=e[2*(n+1)+1],!(++s<u&&i===o)){if(s<c)do je(r,i,r.bl_tree);while(--s!=0);else i!==0?(i!==a&&(je(r,i,r.bl_tree),s--),je(r,h2,r.bl_tree),we(r,s-3,2)):s<=10?(je(r,l2,r.bl_tree),we(r,s-3,3)):(je(r,d2,r.bl_tree),we(r,s-11,7));s=0,a=i,o===0?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4)}}Un(ti);let As=!1;function To(r){As||(function(){let e,t,n,i,a;const o=Array(jr+1);for(n=0,i=0;i<ga-1;i++)for(ba[i]=n,e=0;e<1<<ta[i];e++)o1[n++]=i;for(o1[n-1]=i,a=0,i=0;i<16;i++)for(ti[i]=a,e=0;e<1<<R1[i];e++)s1[a++]=i;for(a>>=7;i<gn;i++)for(ti[i]=a<<7,e=0;e<1<<R1[i]-7;e++)s1[256+a++]=i;for(t=0;t<=jr;t++)o[t]=0;for(e=0;e<=143;)ur[2*e+1]=8,e++,o[8]++;for(;e<=255;)ur[2*e+1]=9,e++,o[9]++;for(;e<=279;)ur[2*e+1]=7,e++,o[7]++;for(;e<=287;)ur[2*e+1]=8,e++,o[8]++;for(p2(ur,a1+1,o),e=0;e<gn;e++)Xn[2*e+1]=5,Xn[2*e]=y2(e,5);gs=new Ti(ur,ta,p1+1,a1,jr),ms=new Ti(Xn,R1,0,gn,jr),ws=new Ti([],Io,0,ma,Co)}(),As=!0),r.l_desc=new Bi(r.dyn_ltree,gs),r.d_desc=new Bi(r.dyn_dtree,ms),r.bl_desc=new Bi(r.bl_tree,ws),r.bi_buf=0,r.bi_valid=0,g2(r)}function w2(r,e,t,n){we(r,(Ko<<1)+(n?1:0),3),function(i,a,o,s){m2(i),s&&(c1(i,o),c1(i,~o)),tr(i.pending_buf,i.window,a,o,i.pending),i.pending+=o}(r,e,t,!0)}function Bo(r){we(r,u2<<1,3),je(r,wa,ur),function(e){e.bi_valid===16?(c1(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(r)}function zo(r,e,t,n){let i,a,o=0;r.level>0?(r.strm.data_type===c2&&(r.strm.data_type=function(s){let u,c=4093624447;for(u=0;u<=31;u++,c>>>=1)if(1&c&&s.dyn_ltree[2*u]!==0)return ds;if(s.dyn_ltree[18]!==0||s.dyn_ltree[20]!==0||s.dyn_ltree[26]!==0)return fs;for(u=32;u<p1;u++)if(s.dyn_ltree[2*u]!==0)return fs;return ds}(r)),Ri(r,r.l_desc),Ri(r,r.d_desc),o=function(s){let u;for(vs(s,s.dyn_ltree,s.l_desc.max_code),vs(s,s.dyn_dtree,s.d_desc.max_code),Ri(s,s.bl_desc),u=ma-1;u>=3&&s.bl_tree[2*ps[u]+1]===0;u--);return s.opt_len+=3*(u+1)+5+5+4,u}(r),i=r.opt_len+3+7>>>3,a=r.static_len+3+7>>>3,a<=i&&(i=a)):i=a=t+5,t+4<=i&&e!==-1?w2(r,e,t,n):r.strategy===o2||a===i?(we(r,(u2<<1)+(n?1:0),3),ks(r,ur,Xn)):(we(r,(Do<<1)+(n?1:0),3),function(s,u,c,h){let l;for(we(s,u-257,5),we(s,c-1,5),we(s,h-4,4),l=0;l<h;l++)we(s,s.bl_tree[2*ps[l]+1],3);_s(s,s.dyn_ltree,u-1),_s(s,s.dyn_dtree,c-1)}(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),ks(r,r.dyn_ltree,r.dyn_dtree)),g2(r),n&&m2(r)}function Tr(r,e,t){return r.pending_buf[r.d_buf+2*r.last_lit]=e>>>8&255,r.pending_buf[r.d_buf+2*r.last_lit+1]=255&e,r.pending_buf[r.l_buf+r.last_lit]=255&t,r.last_lit++,e===0?r.dyn_ltree[2*t]++:(r.matches++,e--,r.dyn_ltree[2*(o1[t]+p1+1)]++,r.dyn_dtree[2*f2(e)]++),r.last_lit===r.lit_bufsize-1}function u1(r,e,t,n){let i=65535&r|0,a=r>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do i=i+e[n++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}const Ro=function(){let r;const e=[];for(let t=0;t<256;t++){r=t;for(let n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;e[t]=r}return e}();function re(r,e,t,n){const i=Ro,a=n+t;r^=-1;for(let o=n;o<a;o++)r=r>>>8^i[255&(r^e[o])];return-1^r}var h1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};const Mo=9,Bt=3,Dr=258,Ce=Dr+Bt+1,No=32,ei=42,ea=69,M1=73,N1=91,L1=103,Gr=113,jn=666,ne=1,Jn=2,Vr=3,mn=4,Lo=3;function Cr(r,e){return r.msg=h1[e],e}function Es(r){return(r<<1)-(r>4?9:0)}function Pr(r){let e=r.length;for(;--e>=0;)r[e]=0}function Sr(r){const e=r.state;let t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(tr(r.output,e.pending_buf,e.pending_out,t,r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function oe(r,e){zo(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Sr(r.strm)}function Mt(r,e){r.pending_buf[r.pending++]=e}function Bn(r,e){r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=255&e}function Oo(r,e,t,n){let i=r.avail_in;return i>n&&(i=n),i===0?0:(r.avail_in-=i,tr(e,r.input,r.next_in,i,t),r.state.wrap===1?r.adler=u1(r.adler,e,i,t):r.state.wrap===2&&(r.adler=re(r.adler,e,i,t)),r.next_in+=i,r.total_in+=i,i)}function b2(r,e){let t,n,i=r.max_chain_length,a=r.strstart,o=r.prev_length,s=r.nice_match;const u=r.strstart>r.w_size-Ce?r.strstart-(r.w_size-Ce):0,c=r.window,h=r.w_mask,l=r.prev,_=r.strstart+Dr;let p=c[a+o-1],R=c[a+o];r.prev_length>=r.good_match&&(i>>=2),s>r.lookahead&&(s=r.lookahead);do if(t=e,c[t+o]===R&&c[t+o-1]===p&&c[t]===c[a]&&c[++t]===c[a+1]){a+=2,t++;do;while(c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&a<_);if(n=Dr-(_-a),a=_-Dr,n>o){if(r.match_start=e,o=n,n>=s)break;p=c[a+o-1],R=c[a+o]}}while((e=l[e&h])>u&&--i!=0);return o<=r.lookahead?o:r.lookahead}function $r(r){const e=r.w_size;let t,n,i,a,o;do{if(a=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-Ce)){tr(r.window,r.window,e,e,0),r.match_start-=e,r.strstart-=e,r.block_start-=e,n=r.hash_size,t=n;do i=r.head[--t],r.head[t]=i>=e?i-e:0;while(--n);n=e,t=n;do i=r.prev[--t],r.prev[t]=i>=e?i-e:0;while(--n);a+=e}if(r.strm.avail_in===0)break;if(n=Oo(r.strm,r.window,r.strstart+r.lookahead,a),r.lookahead+=n,r.lookahead+r.insert>=Bt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+Bt-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<Bt)););}while(r.lookahead<Ce&&r.strm.avail_in!==0)}function Mi(r,e){let t,n;for(;;){if(r.lookahead<Ce){if($r(r),r.lookahead<Ce&&e===er)return ne;if(r.lookahead===0)break}if(t=0,r.lookahead>=Bt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Bt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-Ce&&(r.match_length=b2(r,t)),r.match_length>=Bt)if(n=Tr(r,r.strstart-r.match_start,r.match_length-Bt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Bt){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Bt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else n=Tr(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(n&&(oe(r,!1),r.strm.avail_out===0))return ne}return r.insert=r.strstart<Bt-1?r.strstart:Bt-1,e===ae?(oe(r,!0),r.strm.avail_out===0?Vr:mn):r.last_lit&&(oe(r,!1),r.strm.avail_out===0)?ne:Jn}function cn(r,e){let t,n,i;for(;;){if(r.lookahead<Ce){if($r(r),r.lookahead<Ce&&e===er)return ne;if(r.lookahead===0)break}if(t=0,r.lookahead>=Bt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Bt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Bt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-Ce&&(r.match_length=b2(r,t),r.match_length<=5&&(r.strategy===Po||r.match_length===Bt&&r.strstart-r.match_start>4096)&&(r.match_length=Bt-1)),r.prev_length>=Bt&&r.match_length<=r.prev_length){i=r.strstart+r.lookahead-Bt,n=Tr(r,r.strstart-1-r.prev_match,r.prev_length-Bt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=i&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Bt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=Bt-1,r.strstart++,n&&(oe(r,!1),r.strm.avail_out===0))return ne}else if(r.match_available){if(n=Tr(r,0,r.window[r.strstart-1]),n&&oe(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return ne}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(n=Tr(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Bt-1?r.strstart:Bt-1,e===ae?(oe(r,!0),r.strm.avail_out===0?Vr:mn):r.last_lit&&(oe(r,!1),r.strm.avail_out===0)?ne:Jn}class Me{constructor(e,t,n,i,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=a}}const Gn=[new Me(0,0,0,0,function(r,e){let t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if($r(r),r.lookahead===0&&e===er)return ne;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;const n=r.block_start+t;if((r.strstart===0||r.strstart>=n)&&(r.lookahead=r.strstart-n,r.strstart=n,oe(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-Ce&&(oe(r,!1),r.strm.avail_out===0))return ne}return r.insert=0,e===ae?(oe(r,!0),r.strm.avail_out===0?Vr:mn):(r.strstart>r.block_start&&(oe(r,!1),r.strm.avail_out),ne)}),new Me(4,4,8,4,Mi),new Me(4,5,16,8,Mi),new Me(4,6,32,32,Mi),new Me(4,4,16,16,cn),new Me(8,16,32,32,cn),new Me(8,16,128,128,cn),new Me(8,32,128,256,cn),new Me(32,128,258,1024,cn),new Me(32,258,258,4096,cn)];class Fo{constructor(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=vn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ae(1146),this.dyn_dtree=new Ae(122),this.bl_tree=new Ae(78),Pr(this.dyn_ltree),Pr(this.dyn_dtree),Pr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ae(16),this.heap=new Ae(573),Pr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ae(573),Pr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}}function Ho(r){const e=function(t){let n;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c2,n=t.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?ei:Gr,t.adler=n.wrap===2?0:1,n.last_flush=er,To(n),Ft):Cr(t,te)}(r);return e===Ft&&function(t){t.window_size=2*t.w_size,Pr(t.head),t.max_lazy_match=Gn[t.level].max_lazy,t.good_match=Gn[t.level].good_length,t.nice_match=Gn[t.level].nice_length,t.max_chain_length=Gn[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Bt-1,t.match_available=0,t.ins_h=0}(r.state),e}function qo(r,e){let t,n,i,a;if(!r||!r.state||e>Ji||e<0)return r?Cr(r,te):te;if(n=r.state,!r.output||!r.input&&r.avail_in!==0||n.status===jn&&e!==ae)return Cr(r,r.avail_out===0?Yn:te);if(n.strm=r,t=n.last_flush,n.last_flush=e,n.status===ei)if(n.wrap===2)r.adler=0,Mt(n,31),Mt(n,139),Mt(n,8),n.gzhead?(Mt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Mt(n,255&n.gzhead.time),Mt(n,n.gzhead.time>>8&255),Mt(n,n.gzhead.time>>16&255),Mt(n,n.gzhead.time>>24&255),Mt(n,n.level===9?2:n.strategy>=K1||n.level<2?4:0),Mt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Mt(n,255&n.gzhead.extra.length),Mt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(r.adler=re(r.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=ea):(Mt(n,0),Mt(n,0),Mt(n,0),Mt(n,0),Mt(n,0),Mt(n,n.level===9?2:n.strategy>=K1||n.level<2?4:0),Mt(n,Lo),n.status=Gr);else{let s=vn+(n.w_bits-8<<4)<<8,u=-1;u=n.strategy>=K1||n.level<2?0:n.level<6?1:n.level===6?2:3,s|=u<<6,n.strstart!==0&&(s|=No),s+=31-s%31,n.status=Gr,Bn(n,s),n.strstart!==0&&(Bn(n,r.adler>>>16),Bn(n,65535&r.adler)),r.adler=1}if(n.status===ea)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),Sr(r),i=n.pending,n.pending!==n.pending_buf_size));)Mt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=M1)}else n.status=M1;if(n.status===M1)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),Sr(r),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Mt(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),a===0&&(n.gzindex=0,n.status=N1)}else n.status=N1;if(n.status===N1)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),Sr(r),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Mt(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(r.adler=re(r.adler,n.pending_buf,n.pending-i,i)),a===0&&(n.status=L1)}else n.status=L1;if(n.status===L1&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Sr(r),n.pending+2<=n.pending_buf_size&&(Mt(n,255&r.adler),Mt(n,r.adler>>8&255),r.adler=0,n.status=Gr)):n.status=Gr),n.pending!==0){if(Sr(r),r.avail_out===0)return n.last_flush=-1,Ft}else if(r.avail_in===0&&Es(e)<=Es(t)&&e!==ae)return Cr(r,Yn);if(n.status===jn&&r.avail_in!==0)return Cr(r,Yn);if(r.avail_in!==0||n.lookahead!==0||e!==er&&n.status!==jn){var o=n.strategy===K1?function(s,u){let c;for(;;){if(s.lookahead===0&&($r(s),s.lookahead===0)){if(u===er)return ne;break}if(s.match_length=0,c=Tr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,c&&(oe(s,!1),s.strm.avail_out===0))return ne}return s.insert=0,u===ae?(oe(s,!0),s.strm.avail_out===0?Vr:mn):s.last_lit&&(oe(s,!1),s.strm.avail_out===0)?ne:Jn}(n,e):n.strategy===Uo?function(s,u){let c,h,l,_;const p=s.window;for(;;){if(s.lookahead<=Dr){if($r(s),s.lookahead<=Dr&&u===er)return ne;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=Bt&&s.strstart>0&&(l=s.strstart-1,h=p[l],h===p[++l]&&h===p[++l]&&h===p[++l])){_=s.strstart+Dr;do;while(h===p[++l]&&h===p[++l]&&h===p[++l]&&h===p[++l]&&h===p[++l]&&h===p[++l]&&h===p[++l]&&h===p[++l]&&l<_);s.match_length=Dr-(_-l),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=Bt?(c=Tr(s,1,s.match_length-Bt),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(c=Tr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),c&&(oe(s,!1),s.strm.avail_out===0))return ne}return s.insert=0,u===ae?(oe(s,!0),s.strm.avail_out===0?Vr:mn):s.last_lit&&(oe(s,!1),s.strm.avail_out===0)?ne:Jn}(n,e):Gn[n.level].func(n,e);if(o!==Vr&&o!==mn||(n.status=jn),o===ne||o===Vr)return r.avail_out===0&&(n.last_flush=-1),Ft;if(o===Jn&&(e===So?Bo(n):e!==Ji&&(w2(n,0,0,!1),e===xo&&(Pr(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Sr(r),r.avail_out===0))return n.last_flush=-1,Ft}return e!==ae?Ft:n.wrap<=0?yr:(n.wrap===2?(Mt(n,255&r.adler),Mt(n,r.adler>>8&255),Mt(n,r.adler>>16&255),Mt(n,r.adler>>24&255),Mt(n,255&r.total_in),Mt(n,r.total_in>>8&255),Mt(n,r.total_in>>16&255),Mt(n,r.total_in>>24&255)):(Bn(n,r.adler>>>16),Bn(n,65535&r.adler)),Sr(r),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Ft:yr)}try{String.fromCharCode.call(null,0)}catch{}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{}const ra=new Ve(256);for(let r=0;r<256;r++)ra[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;function na(r){let e,t,n,i,a=0;const o=r.length;for(n=0;n<o;n++)e=r.charCodeAt(n),(64512&e)==55296&&n+1<o&&(t=r.charCodeAt(n+1),(64512&t)==56320&&(e=65536+(e-55296<<10)+(t-56320),n++)),a+=e<128?1:e<2048?2:e<65536?3:4;const s=new Ve(a);for(i=0,n=0;i<a;n++)e=r.charCodeAt(n),(64512&e)==55296&&n+1<o&&(t=r.charCodeAt(n+1),(64512&t)==56320&&(e=65536+(e-55296<<10)+(t-56320),n++)),e<128?s[i++]=e:e<2048?(s[i++]=192|e>>>6,s[i++]=128|63&e):e<65536?(s[i++]=224|e>>>12,s[i++]=128|e>>>6&63,s[i++]=128|63&e):(s[i++]=240|e>>>18,s[i++]=128|e>>>12&63,s[i++]=128|e>>>6&63,s[i++]=128|63&e);return s}ra[254]=ra[254]=1;class k2{constructor(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}class jo{constructor(e){this.options={level:ls,method:vn,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,...e||{}};const t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k2,this.strm.avail_out=0;var n,i,a=function(o,s,u,c,h,l){if(!o)return te;let _=1;if(s===ls&&(s=6),c<0?(_=0,c=-c):c>15&&(_=2,c-=16),h<1||h>Mo||u!==vn||c<8||c>15||s<0||s>9||l<0||l>o2)return Cr(o,te);c===8&&(c=9);const p=new Fo;return o.state=p,p.strm=o,p.wrap=_,p.gzhead=null,p.w_bits=c,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=h+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+Bt-1)/Bt),p.window=new Ve(2*p.w_size),p.head=new Ae(p.hash_size),p.prev=new Ae(p.w_size),p.lit_bufsize=1<<h+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new Ve(p.pending_buf_size),p.d_buf=1*p.lit_bufsize,p.l_buf=3*p.lit_bufsize,p.level=s,p.strategy=l,p.method=u,Ho(o)}(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==Ft)throw Error(h1[a]);if(t.header&&(n=this.strm,i=t.header,n&&n.state&&(n.state.wrap!==2||(n.state.gzhead=i))),t.dictionary){let o;if(o=typeof t.dictionary=="string"?na(t.dictionary):t.dictionary instanceof ArrayBuffer?new Uint8Array(t.dictionary):t.dictionary,a=function(s,u){let c,h,l,_,p,R,M,N,j=u.length;if(!s||!s.state||(c=s.state,_=c.wrap,_===2||_===1&&c.status!==ei||c.lookahead))return te;for(_===1&&(s.adler=u1(s.adler,u,j,0)),c.wrap=0,j>=c.w_size&&(_===0&&(Pr(c.head),c.strstart=0,c.block_start=0,c.insert=0),N=new Ve(c.w_size),tr(N,u,j-c.w_size,c.w_size,0),u=N,j=c.w_size),p=s.avail_in,R=s.next_in,M=s.input,s.avail_in=j,s.next_in=0,s.input=u,$r(c);c.lookahead>=Bt;){h=c.strstart,l=c.lookahead-(Bt-1);do c.ins_h=(c.ins_h<<c.hash_shift^c.window[h+Bt-1])&c.hash_mask,c.prev[h&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=h,h++;while(--l);c.strstart=h,c.lookahead=Bt-1,$r(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=Bt-1,c.match_available=0,s.next_in=R,s.input=M,s.avail_in=p,c.wrap=_,Ft}(this.strm,o),a!==Ft)throw Error(h1[a]);this._dict_set=!0}}push(e,t){const{strm:n,options:{chunkSize:i}}=this;var a,o;if(this.ended)return!1;o=t===~~t?t:t===!0?ae:er,typeof e=="string"?n.input=na(e):e instanceof ArrayBuffer?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new Ve(i),n.next_out=0,n.avail_out=i),(a=qo(n,o))!==yr&&a!==Ft)return this.onEnd(a),this.ended=!0,!1;n.avail_out!==0&&(n.avail_in!==0||o!==ae&&o!==i1)||this.onData(r2(n.output,n.next_out))}while((n.avail_in>0||n.avail_out===0)&&a!==yr);return o===ae?(a=function(s){let u;return s&&s.state?(u=s.state.status,u!==ei&&u!==ea&&u!==M1&&u!==N1&&u!==L1&&u!==Gr&&u!==jn?Cr(s,te):(s.state=null,u===Gr?Cr(s,pa):Ft)):te}(this.strm),this.onEnd(a),this.ended=!0,a===Ft):o!==i1||(this.onEnd(Ft),n.avail_out=0,!0)}onData(e){this.chunks.push(e)}onEnd(e){e===Ft&&(this.result=a2(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg}}const D1=30,Go=12;function Vo(r,e){let t,n,i,a,o,s,u,c,h,l;const _=r.state;t=r.next_in;const p=r.input,R=t+(r.avail_in-5);n=r.next_out;const M=r.output,N=n-(e-r.avail_out),j=n+(r.avail_out-257),Y=_.dmax,F=_.wsize,E=_.whave,$=_.wnext,q=_.window;i=_.hold,a=_.bits;const V=_.lencode,Z=_.distcode,tt=(1<<_.lenbits)-1,rt=(1<<_.distbits)-1;t:do{a<15&&(i+=p[t++]<<a,a+=8,i+=p[t++]<<a,a+=8),o=V[i&tt];e:for(;;){if(s=o>>>24,i>>>=s,a-=s,s=o>>>16&255,s===0)M[n++]=65535&o;else{if(!(16&s)){if(!(64&s)){o=V[(65535&o)+(i&(1<<s)-1)];continue e}if(32&s){_.mode=Go;break t}r.msg="invalid literal/length code",_.mode=D1;break t}u=65535&o,s&=15,s&&(a<s&&(i+=p[t++]<<a,a+=8),u+=i&(1<<s)-1,i>>>=s,a-=s),a<15&&(i+=p[t++]<<a,a+=8,i+=p[t++]<<a,a+=8),o=Z[i&rt];r:for(;;){if(s=o>>>24,i>>>=s,a-=s,s=o>>>16&255,!(16&s)){if(!(64&s)){o=Z[(65535&o)+(i&(1<<s)-1)];continue r}r.msg="invalid distance code",_.mode=D1;break t}if(c=65535&o,s&=15,a<s&&(i+=p[t++]<<a,a+=8,a<s&&(i+=p[t++]<<a,a+=8)),c+=i&(1<<s)-1,c>Y){r.msg="invalid distance too far back",_.mode=D1;break t}if(i>>>=s,a-=s,s=n-N,c>s){if(s=c-s,s>E&&_.sane){r.msg="invalid distance too far back",_.mode=D1;break t}if(h=0,l=q,$===0){if(h+=F-s,s<u){u-=s;do M[n++]=q[h++];while(--s);h=n-c,l=M}}else if($<s){if(h+=F+$-s,s-=$,s<u){u-=s;do M[n++]=q[h++];while(--s);if(h=0,$<u){s=$,u-=s;do M[n++]=q[h++];while(--s);h=n-c,l=M}}}else if(h+=$-s,s<u){u-=s;do M[n++]=q[h++];while(--s);h=n-c,l=M}for(;u>2;)M[n++]=l[h++],M[n++]=l[h++],M[n++]=l[h++],u-=3;u&&(M[n++]=l[h++],u>1&&(M[n++]=l[h++]))}else{h=n-c;do M[n++]=M[h++],M[n++]=M[h++],M[n++]=M[h++],u-=3;while(u>2);u&&(M[n++]=M[h++],u>1&&(M[n++]=M[h++]))}break}}break}}while(t<R&&n<j);u=a>>3,t-=u,a-=u<<3,i&=(1<<a)-1,r.next_in=t,r.next_out=n,r.avail_in=t<R?R-t+5:5-(t-R),r.avail_out=n<j?j-n+257:257-(n-j),_.hold=i,_.bits=a}const un=15,Ss=852,xs=592,Ps=0,Ni=1,Us=2,Wo=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Zo=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Qo=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function t1(r,e,t,n,i,a,o,s){const u=s.bits;let c,h,l,_,p,R=0,M=0,N=0,j=0,Y=0,F=0,E=0,$=0,q=0,V=0,Z=null,tt=0;const rt=new Ae(un+1),ft=new Ae(un+1);let lt,mt,L,yt=null,Ct=0;for(R=0;R<=un;R++)rt[R]=0;for(M=0;M<n;M++)rt[e[t+M]]++;for(Y=u,j=un;j>=1&&rt[j]===0;j--);if(Y>j&&(Y=j),j===0)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(N=1;N<j&&rt[N]===0;N++);for(Y<N&&(Y=N),$=1,R=1;R<=un;R++)if($<<=1,$-=rt[R],$<0)return-1;if($>0&&(r===Ps||j!==1))return-1;for(ft[1]=0,R=1;R<un;R++)ft[R+1]=ft[R]+rt[R];for(M=0;M<n;M++)e[t+M]!==0&&(o[ft[e[t+M]]++]=M);r===Ps?(Z=yt=o,p=19):r===Ni?(Z=Wo,tt-=257,yt=$o,Ct-=257,p=256):(Z=Zo,yt=Qo,p=-1),V=0,M=0,R=N,_=a,F=Y,E=0,l=-1,q=1<<Y;const H=q-1;if(r===Ni&&q>Ss||r===Us&&q>xs)return 1;for(;;){lt=R-E,o[M]<p?(mt=0,L=o[M]):o[M]>p?(mt=yt[Ct+o[M]],L=Z[tt+o[M]]):(mt=96,L=0),c=1<<R-E,h=1<<F,N=h;do h-=c,i[_+(V>>E)+h]=lt<<24|mt<<16|L|0;while(h!==0);for(c=1<<R-1;V&c;)c>>=1;if(c!==0?(V&=c-1,V+=c):V=0,M++,--rt[R]==0){if(R===j)break;R=e[t+o[M]]}if(R>Y&&(V&H)!==l){for(E===0&&(E=Y),_+=N,F=R-E,$=1<<F;F+E<j&&($-=rt[F+E],!($<=0));)F++,$<<=1;if(q+=1<<F,r===Ni&&q>Ss||r===Us&&q>xs)return 1;l=V&H,i[l]=Y<<24|F<<16|_-a|0}}return V!==0&&(i[_+V]=R-E<<24|64<<16|0),s.bits=Y,0}const Yo=0,v2=1,_2=2,A2=1,Ks=2,Ds=3,Cs=4,Is=5,Ts=6,Bs=7,zs=8,Rs=9,Ms=10,ri=11,sr=12,Li=13,Ns=14,Oi=15,Ls=16,Os=17,Fs=18,Hs=19,C1=20,I1=21,qs=22,js=23,Gs=24,Vs=25,Ws=26,Fi=27,$s=28,Zs=29,Zt=30,Xo=852,Jo=592;function Qs(r){return(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24)}class t5{constructor(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ae(320),this.work=new Ae(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}}function e5(r){let e;return r&&r.state?(e=r.state,e.wsize=0,e.whave=0,e.wnext=0,function(t){let n;return t&&t.state?(n=t.state,t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=A2,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new J1(Xo),n.distcode=n.distdyn=new J1(Jo),n.sane=1,n.back=-1,Ft):te}(r)):te}function r5(r,e){let t,n;return r?(n=new t5,r.state=n,n.window=null,t=function(i,a){let o,s;return i&&i.state?(s=i.state,a<0?(o=0,a=-a):(o=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?te:(s.window!==null&&s.wbits!==a&&(s.window=null),s.wrap=o,s.wbits=a,e5(i))):te}(r,e),t!==Ft&&(r.state=null),t):te}let Hi,qi,Ys=!0;function n5(r){if(Ys){let e;for(Hi=new J1(512),qi=new J1(32),e=0;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(t1(v2,r.lens,0,288,Hi,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;t1(_2,r.lens,0,32,qi,0,r.work,{bits:5}),Ys=!1}r.lencode=Hi,r.lenbits=9,r.distcode=qi,r.distbits=5}function E2(r,e,t,n){let i;const a=r.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Ve(a.wsize)),n>=a.wsize?(tr(a.window,e,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),tr(a.window,e,t-n,i,a.wnext),(n-=i)?(tr(a.window,e,t-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}function i5(r,e){let t,n,i,a,o,s,u,c,h,l,_,p,R,M,N,j,Y,F,E,$,q,V,Z,tt,rt=0,ft=new Ve(4);const lt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return te;t=r.state,t.mode===sr&&(t.mode=Li),o=r.next_out,i=r.output,u=r.avail_out,a=r.next_in,n=r.input,s=r.avail_in,c=t.hold,h=t.bits,l=s,_=u,V=Ft;t:for(;;)switch(t.mode){case A2:if(t.wrap===0){t.mode=Li;break}for(;h<16;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(2&t.wrap&&c===35615){t.check=0,ft[0]=255&c,ft[1]=c>>>8&255,t.check=re(t.check,ft,2,0),c=0,h=0,t.mode=Ks;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&c)<<8)+(c>>8))%31){r.msg="incorrect header check",t.mode=Zt;break}if((15&c)!==vn){r.msg="unknown compression method",t.mode=Zt;break}if(c>>>=4,h-=4,q=8+(15&c),t.wbits===0)t.wbits=q;else if(q>t.wbits){r.msg="invalid window size",t.mode=Zt;break}t.dmax=1<<q,r.adler=t.check=1,t.mode=512&c?Ms:sr,c=0,h=0;break;case Ks:for(;h<16;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(t.flags=c,(255&t.flags)!==vn){r.msg="unknown compression method",t.mode=Zt;break}if(57344&t.flags){r.msg="unknown header flags set",t.mode=Zt;break}t.head&&(t.head.text=c>>8&1),512&t.flags&&(ft[0]=255&c,ft[1]=c>>>8&255,t.check=re(t.check,ft,2,0)),c=0,h=0,t.mode=Ds;case Ds:for(;h<32;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.head&&(t.head.time=c),512&t.flags&&(ft[0]=255&c,ft[1]=c>>>8&255,ft[2]=c>>>16&255,ft[3]=c>>>24&255,t.check=re(t.check,ft,4,0)),c=0,h=0,t.mode=Cs;case Cs:for(;h<16;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.head&&(t.head.xflags=255&c,t.head.os=c>>8),512&t.flags&&(ft[0]=255&c,ft[1]=c>>>8&255,t.check=re(t.check,ft,2,0)),c=0,h=0,t.mode=Is;case Is:if(1024&t.flags){for(;h<16;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.length=c,t.head&&(t.head.extra_len=c),512&t.flags&&(ft[0]=255&c,ft[1]=c>>>8&255,t.check=re(t.check,ft,2,0)),c=0,h=0}else t.head&&(t.head.extra=null);t.mode=Ts;case Ts:if(1024&t.flags&&(p=t.length,p>s&&(p=s),p&&(t.head&&(q=t.head.extra_len-t.length,t.head.extra||(t.head.extra=Array(t.head.extra_len)),tr(t.head.extra,n,a,p,q)),512&t.flags&&(t.check=re(t.check,n,p,a)),s-=p,a+=p,t.length-=p),t.length))break t;t.length=0,t.mode=Bs;case Bs:if(2048&t.flags){if(s===0)break t;p=0;do q=n[a+p++],t.head&&q&&t.length<65536&&(t.head.name+=String.fromCharCode(q));while(q&&p<s);if(512&t.flags&&(t.check=re(t.check,n,p,a)),s-=p,a+=p,q)break t}else t.head&&(t.head.name=null);t.length=0,t.mode=zs;case zs:if(4096&t.flags){if(s===0)break t;p=0;do q=n[a+p++],t.head&&q&&t.length<65536&&(t.head.comment+=String.fromCharCode(q));while(q&&p<s);if(512&t.flags&&(t.check=re(t.check,n,p,a)),s-=p,a+=p,q)break t}else t.head&&(t.head.comment=null);t.mode=Rs;case Rs:if(512&t.flags){for(;h<16;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(c!==(65535&t.check)){r.msg="header crc mismatch",t.mode=Zt;break}c=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=sr;break;case Ms:for(;h<32;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}r.adler=t.check=Qs(c),c=0,h=0,t.mode=ri;case ri:if(t.havedict===0)return r.next_out=o,r.avail_out=u,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=h,s2;r.adler=t.check=1,t.mode=sr;case sr:if(e===Ji||e===U1)break t;case Li:if(t.last){c>>>=7&h,h-=7&h,t.mode=Fi;break}for(;h<3;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}switch(t.last=1&c,c>>>=1,h-=1,3&c){case 0:t.mode=Ns;break;case 1:if(n5(t),t.mode=C1,e===U1){c>>>=2,h-=2;break t}break;case 2:t.mode=Os;break;case 3:r.msg="invalid block type",t.mode=Zt}c>>>=2,h-=2;break;case Ns:for(c>>>=7&h,h-=7&h;h<32;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Zt;break}if(t.length=65535&c,c=0,h=0,t.mode=Oi,e===U1)break t;case Oi:t.mode=Ls;case Ls:if(p=t.length,p){if(p>s&&(p=s),p>u&&(p=u),p===0)break t;tr(i,n,a,p,o),s-=p,a+=p,u-=p,o+=p,t.length-=p;break}t.mode=sr;break;case Os:for(;h<14;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(t.nlen=257+(31&c),c>>>=5,h-=5,t.ndist=1+(31&c),c>>>=5,h-=5,t.ncode=4+(15&c),c>>>=4,h-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Zt;break}t.have=0,t.mode=Fs;case Fs:for(;t.have<t.ncode;){for(;h<3;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.lens[lt[t.have++]]=7&c,c>>>=3,h-=3}for(;t.have<19;)t.lens[lt[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Z={bits:t.lenbits},V=t1(Yo,t.lens,0,19,t.lencode,0,t.work,Z),t.lenbits=Z.bits,V){r.msg="invalid code lengths set",t.mode=Zt;break}t.have=0,t.mode=Hs;case Hs:for(;t.have<t.nlen+t.ndist;){for(;rt=t.lencode[c&(1<<t.lenbits)-1],N=rt>>>24,j=rt>>>16&255,Y=65535&rt,!(N<=h);){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(Y<16)c>>>=N,h-=N,t.lens[t.have++]=Y;else{if(Y===16){for(tt=N+2;h<tt;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(c>>>=N,h-=N,t.have===0){r.msg="invalid bit length repeat",t.mode=Zt;break}q=t.lens[t.have-1],p=3+(3&c),c>>>=2,h-=2}else if(Y===17){for(tt=N+3;h<tt;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}c>>>=N,h-=N,q=0,p=3+(7&c),c>>>=3,h-=3}else{for(tt=N+7;h<tt;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}c>>>=N,h-=N,q=0,p=11+(127&c),c>>>=7,h-=7}if(t.have+p>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Zt;break}for(;p--;)t.lens[t.have++]=q}}if(t.mode===Zt)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Zt;break}if(t.lenbits=9,Z={bits:t.lenbits},V=t1(v2,t.lens,0,t.nlen,t.lencode,0,t.work,Z),t.lenbits=Z.bits,V){r.msg="invalid literal/lengths set",t.mode=Zt;break}if(t.distbits=6,t.distcode=t.distdyn,Z={bits:t.distbits},V=t1(_2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Z),t.distbits=Z.bits,V){r.msg="invalid distances set",t.mode=Zt;break}if(t.mode=C1,e===U1)break t;case C1:t.mode=I1;case I1:if(s>=6&&u>=258){r.next_out=o,r.avail_out=u,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=h,Vo(r,_),o=r.next_out,i=r.output,u=r.avail_out,a=r.next_in,n=r.input,s=r.avail_in,c=t.hold,h=t.bits,t.mode===sr&&(t.back=-1);break}for(t.back=0;rt=t.lencode[c&(1<<t.lenbits)-1],N=rt>>>24,j=rt>>>16&255,Y=65535&rt,!(N<=h);){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(j&&!(240&j)){for(F=N,E=j,$=Y;rt=t.lencode[$+((c&(1<<F+E)-1)>>F)],N=rt>>>24,j=rt>>>16&255,Y=65535&rt,!(F+N<=h);){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}c>>>=F,h-=F,t.back+=F}if(c>>>=N,h-=N,t.back+=N,t.length=Y,j===0){t.mode=Ws;break}if(32&j){t.back=-1,t.mode=sr;break}if(64&j){r.msg="invalid literal/length code",t.mode=Zt;break}t.extra=15&j,t.mode=qs;case qs:if(t.extra){for(tt=t.extra;h<tt;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=js;case js:for(;rt=t.distcode[c&(1<<t.distbits)-1],N=rt>>>24,j=rt>>>16&255,Y=65535&rt,!(N<=h);){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(!(240&j)){for(F=N,E=j,$=Y;rt=t.distcode[$+((c&(1<<F+E)-1)>>F)],N=rt>>>24,j=rt>>>16&255,Y=65535&rt,!(F+N<=h);){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}c>>>=F,h-=F,t.back+=F}if(c>>>=N,h-=N,t.back+=N,64&j){r.msg="invalid distance code",t.mode=Zt;break}t.offset=Y,t.extra=15&j,t.mode=Gs;case Gs:if(t.extra){for(tt=t.extra;h<tt;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Zt;break}t.mode=Vs;case Vs:if(u===0)break t;if(p=_-u,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Zt;break}p>t.wnext?(p-=t.wnext,R=t.wsize-p):R=t.wnext-p,p>t.length&&(p=t.length),M=t.window}else M=i,R=o-t.offset,p=t.length;p>u&&(p=u),u-=p,t.length-=p;do i[o++]=M[R++];while(--p);t.length===0&&(t.mode=I1);break;case Ws:if(u===0)break t;i[o++]=t.length,u--,t.mode=I1;break;case Fi:if(t.wrap){for(;h<32;){if(s===0)break t;s--,c|=n[a++]<<h,h+=8}if(_-=u,r.total_out+=_,t.total+=_,_&&(r.adler=t.check=t.flags?re(t.check,i,_,o-_):u1(t.check,i,_,o-_)),_=u,(t.flags?c:Qs(c))!==t.check){r.msg="incorrect data check",t.mode=Zt;break}c=0,h=0}t.mode=$s;case $s:if(t.wrap&&t.flags){for(;h<32;){if(s===0)break t;s--,c+=n[a++]<<h,h+=8}if(c!==(4294967295&t.total)){r.msg="incorrect length check",t.mode=Zt;break}c=0,h=0}t.mode=Zs;case Zs:V=yr;break t;case Zt:V=pa;break t;default:return te}return r.next_out=o,r.avail_out=u,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=h,(t.wsize||_!==r.avail_out&&t.mode<Zt&&(t.mode<Fi||e!==ae))&&E2(r,r.output,r.next_out,_-r.avail_out),l-=r.avail_in,_-=r.avail_out,r.total_in+=l,r.total_out+=_,t.total+=_,t.wrap&&_&&(r.adler=t.check=t.flags?re(t.check,i,_,r.next_out-_):u1(t.check,i,_,r.next_out-_)),r.data_type=t.bits+(t.last?64:0)+(t.mode===sr?128:0)+(t.mode===C1||t.mode===Oi?256:0),(l===0&&_===0||e===ae)&&V===Ft&&(V=Yn),V}function Xs(r,e){const t=e.length;let n,i;return r&&r.state?(n=r.state,n.wrap!==0&&n.mode!==ri?te:n.mode===ri&&(i=1,i=u1(i,e,t,0),i!==n.check)?pa:(E2(r,e,t,t),n.havedict=1,Ft)):te}class a5{constructor(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}class Js{constructor(e){this.options={chunkSize:16384,windowBits:0,...e||{}};const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k2,this.strm.avail_out=0;let n=r5(this.strm,t.windowBits);if(n!==Ft||(this.header=new a5,function(i,a){let o;i&&i.state&&(o=i.state,!(2&o.wrap)||(o.head=a,a.done=!1))}(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=na(t.dictionary):t.dictionary instanceof ArrayBuffer&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Xs(this.strm,t.dictionary),n!==Ft))))throw Error(h1[n])}push(e,t){const{strm:n,options:{chunkSize:i,dictionary:a}}=this;let o,s,u=!1;if(this.ended)return!1;s=t===~~t?t:t===!0?ae:er,typeof e=="string"?n.input=function(c){const h=new Ve(c.length);for(let l=0,_=h.length;l<_;l++)h[l]=c.charCodeAt(l);return h}(e):e instanceof ArrayBuffer?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new Ve(i),n.next_out=0,n.avail_out=i),o=i5(n,er),o===s2&&a&&(o=Xs(this.strm,a)),o===Yn&&u===!0&&(o=Ft,u=!1),o!==yr&&o!==Ft)return this.onEnd(o),this.ended=!0,!1;n.next_out&&(n.avail_out!==0&&o!==yr&&(n.avail_in!==0||s!==ae&&s!==i1)||this.onData(r2(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(u=!0)}while((n.avail_in>0||n.avail_out===0)&&o!==yr);return o===yr&&(s=ae),s===ae?(o=function(c){if(!c||!c.state)return te;const h=c.state;return h.window&&(h.window=null),c.state=null,Ft}(this.strm),this.onEnd(o),this.ended=!0,o===Ft):s!==i1||(this.onEnd(Ft),n.avail_out=0,!0)}onData(e){this.chunks.push(e)}onEnd(e){e===Ft&&(this.result=a2(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg}}var t0=[0,1,3,7,15,31,63,127,255],Vn=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};Vn.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},Vn.prototype.read=function(r){for(var e=0;r>0;){this._ensureByte();var t=8-this.bitOffset;if(r>=t)e<<=t,e|=t0[t]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=t;else{e<<=r;var n=t-r;e|=(this.curByte&t0[r]<<n)>>n,this.bitOffset+=r,r=0}}return e},Vn.prototype.seek=function(r){var e=r%8,t=(r-e)/8;this.bitOffset=e,this.stream.seek(t),this.hasByte=!1},Vn.prototype.pi=function(){var r,e=new Uint8Array(6);for(r=0;r<e.length;r++)e[r]=this.read(8);return function(t){return Array.prototype.map.call(t,n=>("00"+n.toString(16)).slice(-2)).join("")}(e)};var s5=Vn,Lr=function(){};Lr.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Lr.prototype.read=function(r,e,t){for(var n=0;n<t;){var i=this.readByte();if(i<0)return n===0?-1:n;r[e++]=i,n++}return n},Lr.prototype.seek=function(r){throw Error("abstract method seek() not implemented")},Lr.prototype.writeByte=function(r){throw Error("abstract method readByte() not implemented")},Lr.prototype.write=function(r,e,t){var n;for(n=0;n<t;n++)this.writeByte(r[e++]);return t},Lr.prototype.flush=function(){};var ji,S2=Lr,o5=(ji=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var r=4294967295;this.getCRC=function(){return~r>>>0},this.updateCRC=function(e){r=r<<8^ji[255&(r>>>24^e)]},this.updateCRCRun=function(e,t){for(;t-- >0;)r=r<<8^ji[255&(r>>>24^e)]}}),e0=function(r,e){var t,n=r[e];for(t=e;t>0;t--)r[t]=r[t-1];return r[0]=n,n},Qt={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},xr={};xr[Qt.LAST_BLOCK]="Bad file checksum",xr[Qt.NOT_BZIP_DATA]="Not bzip data",xr[Qt.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",xr[Qt.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",xr[Qt.DATA_ERROR]="Data error",xr[Qt.OUT_OF_MEMORY]="Out of memory",xr[Qt.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var se=function(r,e){var t=xr[r]||"unknown error";e&&(t+=": "+e);var n=new TypeError(t);throw n.errorCode=r,n},Wn=function(r,e){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(r,e)};Wn.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new o5,!0):(this.writeCount=-1,!1)},Wn.prototype._start_bunzip=function(r,e){var t=new Uint8Array(4);r.read(t,0,4)===4&&String.fromCharCode(t[0],t[1],t[2])==="BZh"||se(Qt.NOT_BZIP_DATA,"bad magic");var n=t[3]-48;(n<1||n>9)&&se(Qt.NOT_BZIP_DATA,"level out of range"),this.reader=new s5(r),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=e,this.streamCRC=0},Wn.prototype._get_next_block=function(){var r,e,t,n=this.reader,i=n.pi();if(i==="177245385090")return!1;i!=="314159265359"&&se(Qt.NOT_BZIP_DATA),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&se(Qt.OBSOLETE_INPUT);var a=n.read(24);a>this.dbufSize&&se(Qt.DATA_ERROR,"initial position out of bounds");var o=n.read(16),s=new Uint8Array(256),u=0;for(r=0;r<16;r++)if(o&1<<15-r){var c=16*r;for(t=n.read(16),e=0;e<16;e++)t&1<<15-e&&(s[u++]=c+e)}var h=n.read(3);(h<2||h>6)&&se(Qt.DATA_ERROR);var l=n.read(15);l===0&&se(Qt.DATA_ERROR);var _=new Uint8Array(256);for(r=0;r<h;r++)_[r]=r;var p=new Uint8Array(l);for(r=0;r<l;r++){for(e=0;n.read(1);e++)e>=h&&se(Qt.DATA_ERROR);p[r]=e0(_,e)}var R,M=u+2,N=[];for(e=0;e<h;e++){var j,Y,F=new Uint8Array(M),E=new Uint16Array(21);for(o=n.read(5),r=0;r<M;r++){for(;(o<1||o>20)&&se(Qt.DATA_ERROR),n.read(1);)n.read(1)?o--:o++;F[r]=o}for(j=Y=F[0],r=1;r<M;r++)F[r]>Y?Y=F[r]:F[r]<j&&(j=F[r]);R={},N.push(R),R.permute=new Uint16Array(258),R.limit=new Uint32Array(22),R.base=new Uint32Array(21),R.minLen=j,R.maxLen=Y;var $=0;for(r=j;r<=Y;r++)for(E[r]=R.limit[r]=0,o=0;o<M;o++)F[o]===r&&(R.permute[$++]=o);for(r=0;r<M;r++)E[F[r]]++;for($=o=0,r=j;r<Y;r++)$+=E[r],R.limit[r]=$-1,$<<=1,o+=E[r],R.base[r+1]=$-o;R.limit[Y+1]=Number.MAX_VALUE,R.limit[Y]=$+E[Y]-1,R.base[j]=0}var q=new Uint32Array(256);for(r=0;r<256;r++)_[r]=r;var V,Z=0,tt=0,rt=0,ft=this.dbuf=new Uint32Array(this.dbufSize);for(M=0;;){for(M--||(M=49,rt>=l&&se(Qt.DATA_ERROR),R=N[p[rt++]]),r=R.minLen,e=n.read(r);r>R.maxLen&&se(Qt.DATA_ERROR),!(e<=R.limit[r]);r++)e=e<<1|n.read(1);((e-=R.base[r])<0||e>=258)&&se(Qt.DATA_ERROR);var lt=R.permute[e];if(lt!==0&&lt!==1){if(Z)for(Z=0,tt+o>this.dbufSize&&se(Qt.DATA_ERROR),q[V=s[_[0]]]+=o;o--;)ft[tt++]=V;if(lt>u)break;tt>=this.dbufSize&&se(Qt.DATA_ERROR),q[V=s[V=e0(_,r=lt-1)]]++,ft[tt++]=V}else Z||(Z=1,o=0),o+=lt===0?Z:2*Z,Z<<=1}for((a<0||a>=tt)&&se(Qt.DATA_ERROR),e=0,r=0;r<256;r++)t=e+q[r],q[r]=e,e=t;for(r=0;r<tt;r++)ft[q[V=255&ft[r]]]|=r<<8,q[V]++;var mt=0,L=0,yt=0;return tt&&(L=255&(mt=ft[a]),mt>>=8,yt=-1),this.writePos=mt,this.writeCurrent=L,this.writeCount=tt,this.writeRun=yt,!0},Wn.prototype._read_bunzip=function(r,e){var t,n,i;if(this.writeCount<0)return 0;var a=this.dbuf,o=this.writePos,s=this.writeCurrent,u=this.writeCount;this.outputsize;for(var c=this.writeRun;u;){for(u--,n=s,s=255&(o=a[o]),o>>=8,c++==3?(t=s,i=n,s=-1):(t=1,i=s),this.blockCRC.updateCRCRun(i,t);t--;)this.outputStream.writeByte(i),this.nextoutput++;s!=n&&(c=0)}return this.writeCount=u,this.blockCRC.getCRC()!==this.targetBlockCRC&&se(Qt.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var c5=function(r){if("readByte"in r)return r;var e=new S2;return e.pos=0,e.readByte=function(){return r[this.pos++]},e.seek=function(t){this.pos=t},e.eof=function(){return this.pos>=r.length},e},u5=function(r){var e=new S2,t=!0;if(r)if(typeof r=="number")e.buffer=new Uint8Array(r),t=!1;else{if("writeByte"in r)return r;e.buffer=r,t=!1}else e.buffer=new Uint8Array(16384);return e.pos=0,e.writeByte=function(n){if(t&&this.pos>=this.buffer.length){var i=new Uint8Array(2*this.buffer.length);i.set(this.buffer),this.buffer=i}this.buffer[this.pos++]=n},e.getBuffer=function(){if(this.pos!==this.buffer.length){if(!t)throw new TypeError("outputsize does not match decoded input");var n=new Uint8Array(this.pos);n.set(this.buffer.subarray(0,this.pos)),this.buffer=n}return this.buffer},e._coerced=!0,e},r0=function(r,e,t){for(var n=c5(r),i=u5(e),a=new Wn(n,i);!("eof"in n)||!n.eof();)if(a._init_block())a._read_bunzip();else{var o=a.reader.read(32)>>>0;if(o!==a.streamCRC&&se(Qt.DATA_ERROR,"Bad stream CRC (got "+a.streamCRC.toString(16)+" expected "+o.toString(16)+")"),!t||!("eof"in n)||n.eof())break;a._start_bunzip(n,i)}if("getBuffer"in i)return i.getBuffer()};const zn=Symbol("verified"),h5=new Set([m.signatureSubpacket.issuer,m.signatureSubpacket.issuerFingerprint,m.signatureSubpacket.embeddedSignature]);class rr{static get tag(){return m.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.signedHashValue=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new bn,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.revoked=null,this[zn]=null}read(e){let t=0;if(this.version=e[t++],this.version!==4&&this.version!==5)throw new ge(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.params=Tt.signature.parseSignatureParams(this.publicKeyAlgorithm,e.subarray(t,e.length))}writeParams(){return this.params instanceof Promise?l1(async()=>Tt.serializeParams(this.publicKeyAlgorithm,await this.params)):Tt.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),e.push(this.writeParams()),A.concat(e)}async sign(e,t,n=new Date,i=!1){e.version===5?this.version=5:this.version=4;const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];this.created=A.normalizeDate(n),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID(),a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=A.concat(a);const o=this.toHash(this.signatureType,t,i),s=await this.hash(this.signatureType,t,o,i);this.signedHashValue=ve(O1(s),0,2);const u=async()=>Tt.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,o,await nr(s));A.isStream(s)?this.params=u():(this.params=await u(),this[zn]=!0)}writeHashedSubPackets(){const e=m.signatureSubpacket,t=[];let n;if(this.created===null)throw Error("Missing signature creation time");t.push(Wt(e.signatureCreationTime,!0,A.writeDate(this.created))),this.signatureExpirationTime!==null&&t.push(Wt(e.signatureExpirationTime,!0,A.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&t.push(Wt(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(n=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(Wt(e.trustSignature,!0,n))),this.regularExpression!==null&&t.push(Wt(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&t.push(Wt(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&t.push(Wt(e.keyExpirationTime,!0,A.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(Wt(e.preferredSymmetricAlgorithms,!1,n))),this.revocationKeyClass!==null&&(n=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),n=A.concat([n,this.revocationKeyFingerprint]),t.push(Wt(e.revocationKey,!1,n))),this.issuerKeyID.isNull()||this.issuerKeyVersion===5||t.push(Wt(e.issuer,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:o,value:s,humanReadable:u,critical:c})=>{n=[new Uint8Array([u?128:0,0,0,0])];const h=A.encodeUTF8(o);n.push(A.writeNumber(h.length,2)),n.push(A.writeNumber(s.length,2)),n.push(h),n.push(s),n=A.concat(n),t.push(Wt(e.notationData,c,n))}),this.preferredHashAlgorithms!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(Wt(e.preferredHashAlgorithms,!1,n))),this.preferredCompressionAlgorithms!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(Wt(e.preferredCompressionAlgorithms,!1,n))),this.keyServerPreferences!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.keyServerPreferences)),t.push(Wt(e.keyServerPreferences,!1,n))),this.preferredKeyServer!==null&&t.push(Wt(e.preferredKeyServer,!1,A.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&t.push(Wt(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&t.push(Wt(e.policyURI,!1,A.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.keyFlags)),t.push(Wt(e.keyFlags,!0,n))),this.signersUserID!==null&&t.push(Wt(e.signersUserID,!1,A.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(n=A.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(Wt(e.reasonForRevocation,!0,n))),this.features!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.features)),t.push(Wt(e.features,!1,n))),this.signatureTargetPublicKeyAlgorithm!==null&&(n=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],n.push(A.stringToUint8Array(this.signatureTargetHash)),n=A.concat(n),t.push(Wt(e.signatureTarget,!0,n))),this.embeddedSignature!==null&&t.push(Wt(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(n=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],n=A.concat(n),t.push(Wt(e.issuerFingerprint,this.version===5,n))),this.preferredAEADAlgorithms!==null&&(n=A.stringToUint8Array(A.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(Wt(e.preferredAEADAlgorithms,!1,n)));const i=A.concat(t),a=A.writeNumber(i.length,2);return A.concat([a,i])}writeUnhashedSubPackets(){const e=[];this.unhashedSubpackets.forEach(i=>{e.push(fi(i.length)),e.push(i)});const t=A.concat(e),n=A.writeNumber(t.length,2);return A.concat([n,t])}readSubPacket(e,t=!0){let n=0;const i=!!(128&e[n]),a=127&e[n];if(t||(this.unhashedSubpackets.push(e.subarray(n,e.length)),h5.has(a)))switch(n++,a){case m.signatureSubpacket.signatureCreationTime:this.created=A.readDate(e.subarray(n,e.length));break;case m.signatureSubpacket.signatureExpirationTime:{const o=A.readNumber(e.subarray(n,e.length));this.signatureNeverExpires=o===0,this.signatureExpirationTime=o;break}case m.signatureSubpacket.exportableCertification:this.exportable=e[n++]===1;break;case m.signatureSubpacket.trustSignature:this.trustLevel=e[n++],this.trustAmount=e[n++];break;case m.signatureSubpacket.regularExpression:this.regularExpression=e[n];break;case m.signatureSubpacket.revocable:this.revocable=e[n++]===1;break;case m.signatureSubpacket.keyExpirationTime:{const o=A.readNumber(e.subarray(n,e.length));this.keyExpirationTime=o,this.keyNeverExpires=o===0;break}case m.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.revocationKey:this.revocationKeyClass=e[n++],this.revocationKeyAlgorithm=e[n++],this.revocationKeyFingerprint=e.subarray(n,n+20);break;case m.signatureSubpacket.issuer:this.issuerKeyID.read(e.subarray(n,e.length));break;case m.signatureSubpacket.notationData:{const o=!!(128&e[n]);n+=4;const s=A.readNumber(e.subarray(n,n+2));n+=2;const u=A.readNumber(e.subarray(n,n+2));n+=2;const c=A.decodeUTF8(e.subarray(n,n+s)),h=e.subarray(n+s,n+s+u);this.rawNotations.push({name:c,humanReadable:o,value:h,critical:i}),o&&(this.notations[c]=A.decodeUTF8(h));break}case m.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=A.decodeUTF8(e.subarray(n,e.length));break;case m.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[n++]!==0;break;case m.signatureSubpacket.policyURI:this.policyURI=A.decodeUTF8(e.subarray(n,e.length));break;case m.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.signersUserID:this.signersUserID=A.decodeUTF8(e.subarray(n,e.length));break;case m.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[n++],this.reasonForRevocationString=A.decodeUTF8(e.subarray(n,e.length));break;case m.signatureSubpacket.features:this.features=[...e.subarray(n,e.length)];break;case m.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[n++],this.signatureTargetHashAlgorithm=e[n++];const o=Tt.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=A.uint8ArrayToString(e.subarray(n,n+o));break}case m.signatureSubpacket.embeddedSignature:this.embeddedSignature=new rr,this.embeddedSignature.read(e.subarray(n,e.length));break;case m.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[n++],this.issuerFingerprint=e.subarray(n,e.length),this.issuerKeyVersion===5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case m.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(n,e.length)];break;default:{const o=Error("Unknown signature subpacket type "+a);if(i)throw o;A.printDebug(o)}}}readSubPackets(e,t=!0,n){const i=A.readNumber(e.subarray(0,2));let a=2;for(;a<2+i;){const o=co(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),t,n),a+=o.len}return a}toSign(e,t){const n=m.signature;switch(e){case n.binary:return t.text!==null?A.encodeUTF8(t.getText(!0)):t.getBytes(!0);case n.text:{const i=t.getBytes(!0);return A.canonicalizeEOL(i)}case n.standalone:return new Uint8Array(0);case n.certGeneric:case n.certPersona:case n.certCasual:case n.certPositive:case n.certRevocation:{let i,a;if(t.userID)a=180,i=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");a=209,i=t.userAttribute}const o=i.write();return A.concat([this.toSign(n.key,t),new Uint8Array([a]),A.writeNumber(o.length,4),o])}case n.subkeyBinding:case n.subkeyRevocation:case n.keyBinding:return A.concat([this.toSign(n.key,t),this.toSign(n.key,{key:t.bind})]);case n.key:if(t.key===void 0)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case n.keyRevocation:return this.toSign(n.key,t);case n.timestamp:return new Uint8Array(0);case n.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let n=0;return Xt(O1(this.signatureData),i=>{n+=i.length},()=>{const i=[];return this.version!==5||this.signatureType!==m.signature.binary&&this.signatureType!==m.signature.text||(t?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(A.writeNumber(n,4)),A.concat(i)})}toHash(e,t,n=!1){const i=this.toSign(e,t);return A.concat([i,this.signatureData,this.calculateTrailer(t,n)])}async hash(e,t,n,i=!1){return n||(n=this.toHash(e,t,i)),Tt.hash.digest(this.hashAlgorithm,n)}async verify(e,t,n,i=new Date,a=!1,o=At){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const s=t===m.signature.binary||t===m.signature.text;if(!(this[zn]&&!s)){let c,h;if(this.hashed?h=await this.hashed:(c=this.toHash(t,n,a),h=await this.hash(t,n,c)),h=await nr(h),this.signedHashValue[0]!==h[0]||this.signedHashValue[1]!==h[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[zn]=await Tt.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,c,h),!this[zn])throw Error("Signature verification failed")}const u=A.normalizeDate(i);if(u&&this.created>u)throw Error("Signature creation time is in the future");if(u&&u>=this.getExpirationTime())throw Error("Signature is expired");if(o.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+m.read(m.hash,this.hashAlgorithm).toUpperCase());if(o.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[m.signature.binary,m.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+m.read(m.hash,this.hashAlgorithm).toUpperCase());if(this.rawNotations.forEach(({name:c,critical:h})=>{if(h&&o.knownNotations.indexOf(c)<0)throw Error("Unknown critical notation: "+c)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const t=A.normalizeDate(e);return t!==null&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function Wt(r,e,t){const n=[];return n.push(fi(t.length+1)),n.push(new Uint8Array([(e?128:0)|r])),n.push(t),A.concat(n)}class Gi{static get tag(){return m.packet.onePassSignature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.issuerKeyID=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],this.version!==3)throw new ge(`Version ${this.version} of the one-pass signature packet is unsupported.`);return this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],this.issuerKeyID=new bn,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8,this.flags=e[t++],this}write(){const e=new Uint8Array([3,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm]),t=new Uint8Array([this.flags]);return A.concatUint8Array([e,this.issuerKeyID.write(),t])}calculateTrailer(...e){return l1(async()=>rr.prototype.calculateTrailer.apply(await this.correspondingSig,e))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==m.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function l5(r,e){if(!e[r]){let t;try{t=m.read(m.packet,r)}catch{throw new ge("Unknown packet type with tag: "+r)}throw Error("Packet not allowed in this context: "+t)}return new e[r]}Gi.prototype.hash=rr.prototype.hash,Gi.prototype.toHash=rr.prototype.toHash,Gi.prototype.toSign=rr.prototype.toSign;class Ie extends Array{static async fromBinary(e,t,n=At){const i=new Ie;return await i.read(e,t,n),i}async read(e,t,n=At){this.stream=n1(e,async(a,o)=>{const s=Te(o);try{for(;;)if(await s.ready,await ho(a,async u=>{try{if(u.tag===m.packet.marker||u.tag===m.packet.trust)return;const c=l5(u.tag,t);c.packets=new Ie,c.fromStream=A.isStream(u.packet),await c.read(u.packet,n),await s.write(c)}catch(c){const h=!n.ignoreUnsupportedPackets&&c instanceof ge,l=!(n.ignoreMalformedPackets||c instanceof ge);if(h||l||B1(u.tag))await s.abort(c);else{const _=new Xi(u.tag,u.packet);await s.write(_)}A.printDebugError(c)}}))return await s.ready,void await s.close()}catch(u){await s.abort(u)}});const i=Zr(this.stream);for(;;){const{done:a,value:o}=await i.read();if(a?this.stream=null:this.push(o),a||B1(o.constructor.tag))break}i.releaseLock()}write(){const e=[];for(let t=0;t<this.length;t++){const n=this[t]instanceof Xi?this[t].tag:this[t].constructor.tag,i=this[t].write();if(A.isStream(i)&&B1(this[t].constructor.tag)){let a=[],o=0;const s=512;e.push(G0(n)),e.push(Xt(i,u=>{if(a.push(u),o+=u.length,o>=s){const c=Math.min(Math.log(o)/Math.LN2|0,30),h=2**c,l=A.concat([uo(c)].concat(a));return a=[l.subarray(1+h)],o=a[0].length,l.subarray(0,1+h)}},()=>A.concat([fi(o)].concat(a))))}else{if(A.isStream(i)){let a=0;e.push(Xt(O1(i),o=>{a+=o.length},()=>is(n,a)))}else e.push(is(n,i.length));e.push(i)}}return A.concat(e)}filterByTag(...e){const t=new Ie,n=i=>a=>i===a;for(let i=0;i<this.length;i++)e.some(n(this[i].constructor.tag))&&t.push(this[i]);return t}findPacket(e){return this.find(t=>t.constructor.tag===e)}indexOfTag(...e){const t=[],n=this,i=a=>o=>a===o;for(let a=0;a<this.length;a++)e.some(i(n[a].constructor.tag))&&t.push(a);return t}}const Rn=A.getNodeZlib();function n0(r){return r}function i0(r,e,t={}){return function(n){return!A.isStream(n)||ce(n)?l1(()=>nr(n).then(i=>new Promise((a,o)=>{r(i,t,(s,u)=>{if(s)return o(s);a(u)})}))):si(w0(n).pipe(e(t)))}}function a0(r,e={}){return function(t){const n=new r(e);return Xt(t,i=>{if(i.length)return n.push(i,i1),n.result},()=>{if(r===jo)return n.push([],ae),n.result})}}function s0(r){return function(e){return l1(async()=>r(await nr(e)))}}Rn&&(Rn.inflateRaw,Rn.createInflateRaw,Rn.inflate,Rn.createInflate);class Vi{constructor(e=At){this.algorithm=m.hash.sha256,this.type="iterated",this.c=e.s2kIterationCountByte,this.salt=null}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;switch(this.type=m.read(m.s2k,e[t++]),this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if(A.uint8ArrayToString(e.subarray(t,t+3))!=="GNU")throw Error("Unknown s2k type.");if(t+=3,1e3+e[t++]!==1001)throw Error("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw Error("Unknown s2k type.")}return t}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...A.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([m.write(m.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return A.concatUint8Array(e)}async produceKey(e,t){e=A.encodeUTF8(e);const n=[];let i=0,a=0;for(;i<t;){let o;switch(this.type){case"simple":o=A.concatUint8Array([new Uint8Array(a),e]);break;case"salted":o=A.concatUint8Array([new Uint8Array(a),this.salt,e]);break;case"iterated":{const u=A.concatUint8Array([this.salt,e]);let c=u.length;const h=Math.max(this.getCount(),c);o=new Uint8Array(a+h),o.set(u,a);for(let l=a+c;l<h;l+=c,c*=2)o.copyWithin(l,a,l);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await Tt.hash.digest(this.algorithm,o);n.push(s),i+=s.length,a++}return A.concatUint8Array(n).subarray(0,t)}}class We{static get tag(){return m.packet.publicKey}constructor(e=new Date,t=At){this.version=t.v5Keys?5:4,this.created=A.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const t=new We,{version:n,created:i,algorithm:a,publicParams:o,keyID:s,fingerprint:u}=e;return t.version=n,t.created=i,t.algorithm=a,t.publicParams=o,t.keyID=s,t.fingerprint=u,t}async read(e){let t=0;if(this.version=e[t++],this.version===4||this.version===5){this.created=A.readDate(e.subarray(t,t+4)),t+=4,this.algorithm=e[t++],this.version===5&&(t+=4);const{read:n,publicParams:i}=Tt.parsePublicKeyParams(this.algorithm,e.subarray(t));return this.publicParams=i,t+=n,await this.computeFingerprintAndKeyID(),t}throw new ge(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(A.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const t=Tt.serializeParams(this.algorithm,this.publicParams);return this.version===5&&e.push(A.writeNumber(t.length,4)),e.push(t),A.concatUint8Array(e)}writeForHash(e){const t=this.writePublicKey();return e===5?A.concatUint8Array([new Uint8Array([154]),A.writeNumber(t.length,4),t]):A.concatUint8Array([new Uint8Array([153]),A.writeNumber(t.length,2),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new bn,this.version===5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version===5)this.fingerprint=await Tt.hash.sha256(e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await Tt.hash.sha1(e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return A.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&A.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=m.read(m.publicKey,this.algorithm);const t=this.publicParams.n||this.publicParams.p;return t?e.bits=A.uint8ArrayBitLength(t):e.curve=this.publicParams.oid.getName(),e}}We.prototype.readPublicKey=We.prototype.read,We.prototype.writePublicKey=We.prototype.write;class gi extends We{static get tag(){return m.packet.publicSubkey}constructor(e,t){super(e,t)}static fromSecretSubkeyPacket(e){const t=new gi,{version:n,created:i,algorithm:a,publicParams:o,keyID:s,fingerprint:u}=e;return t.version=n,t.created=i,t.algorithm=a,t.publicParams=o,t.keyID=s,t.fingerprint=u,t}}class ka extends We{static get tag(){return m.packet.secretKey}constructor(e=new Date,t=At){super(e,t),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.privateParams=null}async read(e){let t=await this.readPublicKey(e);if(this.s2kUsage=e[t++],this.version===5&&t++,this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){if(this.symmetric=e[t++],this.s2kUsage===253&&(this.aead=e[t++]),this.s2k=new Vi,t+=this.s2k.read(e.subarray(t,e.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);if(this.s2kUsage&&(this.iv=e.subarray(t,t+Tt.getCipher(this.symmetric).blockSize),t+=this.iv.length),this.version===5&&(t+=4),this.keyMaterial=e.subarray(t),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){const n=this.keyMaterial.subarray(0,-2);if(!A.equalsUint8Array(A.writeChecksum(n),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{privateParams:i}=Tt.parsePrivateKeyParams(this.algorithm,n,this.publicParams);this.privateParams=i}catch(i){throw i instanceof ge?i:Error("Error reading MPIs")}}}write(){const e=[this.writePublicKey()];e.push(new Uint8Array([this.s2kUsage]));const t=[];return this.s2kUsage!==255&&this.s2kUsage!==254&&this.s2kUsage!==253||(t.push(this.symmetric),this.s2kUsage===253&&t.push(this.aead),t.push(...this.s2k.write())),this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&t.push(...this.iv),this.version===5&&e.push(new Uint8Array([t.length])),e.push(new Uint8Array(t)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=Tt.serializeParams(this.algorithm,this.privateParams)),this.version===5&&e.push(A.writeNumber(this.keyMaterial.length,4)),e.push(this.keyMaterial),this.s2kUsage||e.push(A.writeChecksum(this.keyMaterial))),A.concatUint8Array(e)}isDecrypted(){return this.isEncrypted===!1}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(e=At){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),this.isEncrypted=null,this.keyMaterial=null,this.s2k=new Vi(e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=m.symmetric.aes256)}async encrypt(e,t=At){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=new Vi(t),this.s2k.salt=Tt.random.getRandomBytes(8);const n=Tt.serializeParams(this.algorithm,this.privateParams);this.symmetric=m.symmetric.aes256;const i=await o0(this.s2k,e,this.symmetric),{blockSize:a}=Tt.getCipher(this.symmetric);if(this.iv=Tt.random.getRandomBytes(a),t.aeadProtect){this.s2kUsage=253,this.aead=m.aead.eax;const o=Tt.getAEADMode(this.aead),s=await o(this.symmetric,i);this.keyMaterial=await s.encrypt(n,this.iv.subarray(0,o.ivLength),new Uint8Array)}else this.s2kUsage=254,this.keyMaterial=await Tt.mode.cfb.encrypt(this.symmetric,i,A.concatUint8Array([n,await Tt.hash.sha1(n,t)]),this.iv,t)}async decrypt(e){if(this.isDummy())return!1;if(this.isDecrypted())throw Error("Key packet is already decrypted.");let t,n;if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");if(t=await o0(this.s2k,e,this.symmetric),this.s2kUsage===253){const i=Tt.getAEADMode(this.aead),a=await i(this.symmetric,t);try{n=await a.decrypt(this.keyMaterial,this.iv.subarray(0,i.ivLength),new Uint8Array)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{const i=await Tt.mode.cfb.decrypt(this.symmetric,t,this.keyMaterial,this.iv);n=i.subarray(0,-20);const a=await Tt.hash.sha1(n);if(!A.equalsUint8Array(a,i.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:i}=Tt.parsePrivateKeyParams(this.algorithm,n,this.publicParams);this.privateParams=i}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");let e;try{e=await Tt.validateParams(this.algorithm,this.publicParams,this.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")}async generate(e,t){const{privateParams:n,publicParams:i}=await Tt.generateParams(this.algorithm,e,t);this.privateParams=n,this.publicParams=i,this.isEncrypted=!1}clearPrivateParams(){this.isDummy()||(Object.keys(this.privateParams).forEach(e=>{this.privateParams[e].fill(0),delete this.privateParams[e]}),this.privateParams=null,this.isEncrypted=!0)}}async function o0(r,e,t){const{keySize:n}=Tt.getCipher(t);return r.produceKey(e,n)}var d5=la(function(r){(function(e){function t(i){function a(){return Et<qt}function o(){return Et}function s(X){Et=X}function u(){Et=0,qt=Rt.length}function c(X,J){return{name:X,tokens:J||"",semantic:J||"",children:[]}}function h(X,J){var ot;return J===null?null:((ot=c(X)).tokens=J.tokens,ot.semantic=J.semantic,ot.children.push(J),ot)}function l(X,J){return J!==null&&(X.tokens+=J.tokens,X.semantic+=J.semantic),X.children.push(J),X}function _(X){var J;return a()&&X(J=Rt[Et])?(Et+=1,c("token",J)):null}function p(X){return function(){return h("literal",_(function(J){return J===X}))}}function R(){var X=arguments;return function(){var J,ot,bt,kt;for(kt=o(),ot=c("and"),J=0;J<X.length;J+=1){if((bt=X[J]())===null)return s(kt),null;l(ot,bt)}return ot}}function M(){var X=arguments;return function(){var J,ot,bt;for(bt=o(),J=0;J<X.length;J+=1){if((ot=X[J]())!==null)return ot;s(bt)}return null}}function N(X){return function(){var J,ot;return ot=o(),(J=X())!==null?J:(s(ot),c("opt"))}}function j(X){return function(){var J=X();return J!==null&&(J.semantic=""),J}}function Y(X){return function(){var J=X();return J!==null&&J.semantic.length>0&&(J.semantic=" "),J}}function F(X,J){return function(){var ot,bt,kt,xt,vt;for(xt=o(),ot=c("star"),kt=0,vt=J===void 0?0:J;(bt=X())!==null;)kt+=1,l(ot,bt);return kt>=vt?ot:(s(xt),null)}}function E(X){return X.charCodeAt(0)>=128}function $(){return h("cr",p("\r")())}function q(){return h("crlf",R($,tt)())}function V(){return h("dquote",p('"')())}function Z(){return h("htab",p("	")())}function tt(){return h("lf",p(`
`)())}function rt(){return h("sp",p(" ")())}function ft(){return h("vchar",_(function(X){var J=X.charCodeAt(0),ot=33<=J&&J<=126;return i.rfc6532&&(ot=ot||E(X)),ot}))}function lt(){return h("wsp",M(rt,Z)())}function mt(){var X=h("quoted-pair",M(R(p("\\"),M(ft,lt)),U)());return X===null?null:(X.semantic=X.semantic[1],X)}function L(){return h("fws",M(I,R(N(R(F(lt),j(q))),F(lt,1)))())}function yt(){return h("ctext",M(function(){return _(function(X){var J=X.charCodeAt(0),ot=33<=J&&J<=39||42<=J&&J<=91||93<=J&&J<=126;return i.rfc6532&&(ot=ot||E(X)),ot})},ut)())}function Ct(){return h("ccontent",M(yt,mt,H)())}function H(){return h("comment",R(p("("),F(R(N(L),Ct)),N(L),p(")"))())}function nt(){return h("cfws",M(R(F(R(N(L),H),1),N(L)),L)())}function pt(){return h("atext",_(function(X){var J="a"<=X&&X<="z"||"A"<=X&&X<="Z"||"0"<=X&&X<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(X)>=0;return i.rfc6532&&(J=J||E(X)),J}))}function gt(){return h("atom",R(Y(N(nt)),F(pt,1),Y(N(nt)))())}function dt(){var X,J;return(X=h("dot-atom-text",F(pt,1)()))===null||(J=F(R(p("."),F(pt,1)))())!==null&&l(X,J),X}function ht(){return h("dot-atom",R(j(N(nt)),dt,j(N(nt)))())}function wt(){return h("qtext",M(function(){return _(function(X){var J=X.charCodeAt(0),ot=J===33||35<=J&&J<=91||93<=J&&J<=126;return i.rfc6532&&(ot=ot||E(X)),ot})},D)())}function st(){return h("qcontent",M(wt,mt)())}function S(){return h("quoted-string",R(j(N(nt)),j(V),F(R(N(Y(L)),st)),N(j(L)),j(V),j(N(nt)))())}function O(){return h("word",M(gt,S)())}function w(){return h("address",M(d,W)())}function d(){return h("mailbox",M(P,ct)())}function P(){return h("name-addr",R(N(Q),G)())}function G(){return h("angle-addr",M(R(j(N(nt)),p("<"),ct,p(">"),j(N(nt))),T)())}function W(){return h("group",R(Q,p(":"),N(g),p(";"),j(N(nt)))())}function Q(){return h("display-name",((X=h("phrase",M(K,F(O,1))()))!==null&&(X.semantic=function(J){return J.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}(X.semantic)),X));var X}function y(){return h("mailbox-list",M(R(d,F(R(p(","),d))),b)())}function f(){return h("address-list",M(R(w,F(R(p(","),w))),et)())}function g(){return h("group-list",M(y,j(nt),it)())}function v(){return h("local-part",M(St,ht,S)())}function C(){return h("dtext",M(function(){return _(function(X){var J=X.charCodeAt(0),ot=33<=J&&J<=90||94<=J&&J<=126;return i.rfc6532&&(ot=ot||E(X)),ot})},zt)())}function x(){return h("domain-literal",R(j(N(nt)),p("["),F(R(N(L),C)),N(L),p("]"),j(N(nt)))())}function B(){return h("domain",(X=M(It,ht,x)(),i.rejectTLD&&X&&X.semantic&&X.semantic.indexOf(".")<0?null:(X&&(X.semantic=X.semantic.replace(/\s+/g,"")),X)));var X}function ct(){return h("addr-spec",R(v,p("@"),B)())}function at(){return i.strict?null:h("obs-NO-WS-CTL",_(function(X){var J=X.charCodeAt(0);return 1<=J&&J<=8||J===11||J===12||14<=J&&J<=31||J===127}))}function ut(){return i.strict?null:h("obs-ctext",at())}function D(){return i.strict?null:h("obs-qtext",at())}function U(){return i.strict?null:h("obs-qp",R(p("\\"),M(p("\0"),at,tt,$))())}function K(){return i.strict?null:i.atInDisplayName?h("obs-phrase",R(O,F(M(O,p("."),p("@"),Y(nt))))()):h("obs-phrase",R(O,F(M(O,p("."),Y(nt))))())}function I(){return i.strict?null:h("obs-FWS",F(R(j(N(q)),lt),1)())}function T(){return i.strict?null:h("obs-angle-addr",R(j(N(nt)),p("<"),z,ct,p(">"),j(N(nt)))())}function z(){return i.strict?null:h("obs-route",R(k,p(":"))())}function k(){return i.strict?null:h("obs-domain-list",R(F(M(j(nt),p(","))),p("@"),B,F(R(p(","),j(N(nt)),N(R(p("@"),B)))))())}function b(){return i.strict?null:h("obs-mbox-list",R(F(R(j(N(nt)),p(","))),d,F(R(p(","),N(R(d,j(nt))))))())}function et(){return i.strict?null:h("obs-addr-list",R(F(R(j(N(nt)),p(","))),w,F(R(p(","),N(R(w,j(nt))))))())}function it(){return i.strict?null:h("obs-group-list",R(F(R(j(N(nt)),p(",")),1),j(N(nt)))())}function St(){return i.strict?null:h("obs-local-part",R(O,F(R(p("."),O)))())}function It(){return i.strict?null:h("obs-domain",R(gt,F(R(p("."),gt)))())}function zt(){return i.strict?null:h("obs-dtext",M(at,mt)())}function Kt(X,J){var ot,bt,kt;if(J==null)return null;for(bt=[J];bt.length>0;){if((kt=bt.pop()).name===X)return kt;for(ot=kt.children.length-1;ot>=0;ot-=1)bt.push(kt.children[ot])}return null}function Vt(X,J){var ot,bt,kt,xt,vt;if(J==null)return null;for(bt=[J],xt=[],vt={},ot=0;ot<X.length;ot+=1)vt[X[ot]]=!0;for(;bt.length>0;)if((kt=bt.pop()).name in vt)xt.push(kt);else for(ot=kt.children.length-1;ot>=0;ot-=1)bt.push(kt.children[ot]);return xt}function Yt(X){var J,ot,bt,kt,xt;if(X===null)return null;for(J=[],ot=Vt(["group","mailbox"],X),bt=0;bt<ot.length;bt+=1)(kt=ot[bt]).name==="group"?J.push(Jt(kt)):kt.name==="mailbox"&&J.push(ee(kt));return xt={ast:X,addresses:J},i.simple&&(xt=function(vt){var Lt;if(vt&&vt.addresses)for(Lt=0;Lt<vt.addresses.length;Lt+=1)delete vt.addresses[Lt].node;return vt}(xt)),i.oneResult?function(vt){return!vt||!i.partial&&vt.addresses.length>1?null:vt.addresses&&vt.addresses[0]}(xt):i.simple?xt&&xt.addresses:xt}function Jt(X){var J,ot=Kt("display-name",X),bt=[],kt=Vt(["mailbox"],X);for(J=0;J<kt.length;J+=1)bt.push(ee(kt[J]));return{node:X,parts:{name:ot},type:X.name,name:Ut(ot),addresses:bt}}function ee(X){var J=Kt("display-name",X),ot=Kt("addr-spec",X),bt=function(Lt,jt){var Se,xe,Pe,Be;if(jt==null)return null;for(xe=[jt],Be=[];xe.length>0;)for((Pe=xe.pop()).name===Lt&&Be.push(Pe),Se=Pe.children.length-1;Se>=0;Se-=1)xe.push(Pe.children[Se]);return Be}("cfws",X),kt=Vt(["comment"],X),xt=Kt("local-part",ot),vt=Kt("domain",ot);return{node:X,parts:{name:J,address:ot,local:xt,domain:vt,comments:bt},type:X.name,name:Ut(J),address:Ut(ot),local:Ut(xt),domain:Ut(vt),comments:Nt(kt),groupName:Ut(X.groupName)}}function Ut(X){return X!=null?X.semantic:null}function Nt(X){var J="";if(X)for(var ot=0;ot<X.length;ot+=1)J+=Ut(X[ot]);return J}var Rt,Et,qt,Ot,Ht;if((i=n(i,{}))===null)return null;if(Rt=i.input,Ht={address:w,"address-list":f,"angle-addr":G,from:function(){return h("from",M(y,f)())},group:W,mailbox:d,"mailbox-list":y,"reply-to":function(){return h("reply-to",f())},sender:function(){return h("sender",M(d,w)())}}[i.startAt]||f,!i.strict){if(u(),i.strict=!0,Ot=Ht(Rt),i.partial||!a())return Yt(Ot);i.strict=!1}return u(),Ot=Ht(Rt),!i.partial&&a()?null:Yt(Ot)}function n(i,a){function o(h){return Object.prototype.toString.call(h)==="[object String]"}function s(h){return h==null}var u,c;if(o(i))i={input:i};else if(!function(h){return h===Object(h)}(i))return null;if(!o(i.input)||!a)return null;for(c in u={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1})s(i[c])&&(i[c]=s(a[c])?u[c]:a[c]);return i}t.parseOneAddress=function(i){return t(n(i,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},t.parseAddressList=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"address-list"}))},t.parseFrom=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"from"}))},t.parseSender=function(i){return t(n(i,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},t.parseReplyTo=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},r.exports=t})()});class va{static get tag(){return m.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(A.isString(e)||e.name&&!A.isString(e.name)||e.email&&!A.isEmailAddress(e.email)||e.comment&&!A.isString(e.comment))throw Error("Invalid user ID format");const t=new va;Object.assign(t,e);const n=[];return t.name&&n.push(t.name),t.comment&&n.push(`(${t.comment})`),t.email&&n.push(`<${t.email}>`),t.userID=n.join(" "),t}read(e,t=At){const n=A.decodeUTF8(e);if(n.length>t.maxUserIDLength)throw Error("User ID string is too long");try{const{name:i,address:a,comments:o}=d5.parseOneAddress({input:n,atInDisplayName:!0});this.comment=o.replace(/^\(|\)$/g,""),this.name=i,this.email=a}catch{}this.userID=n}write(){return A.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class x2 extends ka{static get tag(){return m.packet.secretSubkey}constructor(e=new Date,t=At){super(e,t)}}async function P2(r,e){const t=new x2(r.date,e);return t.packets=null,t.algorithm=m.write(m.publicKey,r.algorithm),await t.generate(r.rsaBits,r.curve),await t.computeFingerprintAndKeyID(),t}async function f5(r,e){const t=new ka(r.date,e);return t.packets=null,t.algorithm=m.write(m.publicKey,r.algorithm),await t.generate(r.rsaBits,r.curve,r.config),await t.computeFingerprintAndKeyID(),t}async function Oe(r,e,t,n,i=new Date,a){let o,s;for(let u=r.length-1;u>=0;u--)try{(!o||r[u].created>=o.created)&&(await r[u].verify(e,t,n,i,void 0,a),o=r[u])}catch(c){s=c}if(!o)throw A.wrapError(`Could not find valid ${m.read(m.signature,t)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(u,c,h)=>c+" "+h.toLowerCase()),s);return o}function ia(r,e,t=new Date){const n=A.normalizeDate(t);if(n!==null){const i=ni(r,e);return!(r.created<=n&&n<i)}return!1}async function U2(r,e,t,n){const i={};i.key=e,i.bind=r;const a=new rr;return a.signatureType=m.signature.subkeyBinding,a.publicKeyAlgorithm=e.algorithm,a.hashAlgorithm=await _a(null,r,void 0,void 0,n),t.sign?(a.keyFlags=[m.keyFlags.signData],a.embeddedSignature=await _n(i,null,r,{signatureType:m.signature.keyBinding},t.date,void 0,void 0,void 0,n)):a.keyFlags=[m.keyFlags.encryptCommunication|m.keyFlags.encryptStorage],t.keyExpirationTime>0&&(a.keyExpirationTime=t.keyExpirationTime,a.keyNeverExpires=!1),await a.sign(e,i,t.date),a}async function _a(r,e,t=new Date,n={},i){let a=i.preferredHashAlgorithm,o=a;if(r){const s=await r.getPrimaryUser(t,n,i);s.selfCertification.preferredHashAlgorithms&&([o]=s.selfCertification.preferredHashAlgorithms,a=Tt.hash.getHashByteLength(a)<=Tt.hash.getHashByteLength(o)?o:a)}switch(Object.getPrototypeOf(e)){case ka.prototype:case We.prototype:case x2.prototype:case gi.prototype:switch(e.algorithm){case m.publicKey.ecdh:case m.publicKey.ecdsa:case m.publicKey.eddsa:o=Tt.publicKey.elliptic.getPreferredHashAlgo(e.publicParams.oid)}}return Tt.hash.getHashByteLength(a)<=Tt.hash.getHashByteLength(o)?o:a}async function _n(r,e,t,n,i,a,o=[],s=!1,u){if(t.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!t.isDecrypted())throw Error("Signing key is not decrypted.");const c=new rr;return Object.assign(c,n),c.publicKeyAlgorithm=t.algorithm,c.hashAlgorithm=await _a(e,t,i,a,u),c.rawNotations=o,await c.sign(t,r,i,s),c}async function Wr(r,e,t,n=new Date,i){(r=r[t])&&(e[t].length?await Promise.all(r.map(async function(a){a.isExpired(n)||i&&!await i(a)||e[t].some(function(o){return A.equalsUint8Array(o.writeParams(),a.writeParams())})||e[t].push(a)})):e[t]=r)}async function An(r,e,t,n,i,a,o=new Date,s){a=a||r;const u=[];return await Promise.all(n.map(async function(c){try{i&&!c.issuerKeyID.equals(i.issuerKeyID)||(await c.verify(a,e,t,s.revocationsExpire?o:null,!1,s),u.push(c.issuerKeyID))}catch{}})),i?(i.revoked=!!u.some(c=>c.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):u.length>0}function ni(r,e){let t;return e.keyNeverExpires===!1&&(t=r.created.getTime()+1e3*e.keyExpirationTime),t?new Date(t):1/0}function aa(r,e={}){switch(r.type=r.type||e.type,r.curve=r.curve||e.curve,r.rsaBits=r.rsaBits||e.rsaBits,r.keyExpirationTime=r.keyExpirationTime!==void 0?r.keyExpirationTime:e.keyExpirationTime,r.passphrase=A.isString(r.passphrase)?r.passphrase:e.passphrase,r.date=r.date||e.date,r.sign=r.sign||!1,r.type){case"ecc":try{r.curve=m.write(m.curve,r.curve)}catch{throw Error("Unknown curve")}r.curve!==m.curve.ed25519&&r.curve!==m.curve.curve25519||(r.curve=r.sign?m.curve.ed25519:m.curve.curve25519),r.sign?r.algorithm=r.curve===m.curve.ed25519?m.publicKey.eddsa:m.publicKey.ecdsa:r.algorithm=m.publicKey.ecdh;break;case"rsa":r.algorithm=m.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+r.type)}return r}function c0(r,e){const t=r.algorithm;return t!==m.publicKey.rsaEncrypt&&t!==m.publicKey.elgamal&&t!==m.publicKey.ecdh&&(!e.keyFlags||(e.keyFlags[0]&m.keyFlags.signData)!=0)}function u0(r,e){const t=r.algorithm;return t!==m.publicKey.dsa&&t!==m.publicKey.rsaSign&&t!==m.publicKey.ecdsa&&t!==m.publicKey.eddsa&&(!e.keyFlags||(e.keyFlags[0]&m.keyFlags.encryptCommunication)!=0||(e.keyFlags[0]&m.keyFlags.encryptStorage)!=0)}function h0(r,e){return!!e.allowInsecureDecryptionWithSigningKeys||!r.keyFlags||(r.keyFlags[0]&m.keyFlags.encryptCommunication)!=0||(r.keyFlags[0]&m.keyFlags.encryptStorage)!=0}function yn(r,e){const t=m.write(m.publicKey,r.algorithm),n=r.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(t))throw Error(n.algorithm+" keys are considered too weak.");switch(t){case m.publicKey.rsaEncryptSign:case m.publicKey.rsaSign:case m.publicKey.rsaEncrypt:if(n.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case m.publicKey.ecdsa:case m.publicKey.eddsa:case m.publicKey.ecdh:if(e.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class e1{constructor(e,t){this.userID=e.constructor.tag===m.packet.userID?e:null,this.userAttribute=e.constructor.tag===m.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new Ie;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new e1(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,t,n){const i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i},o=new e1(a.userID||a.userAttribute,this.mainKey);return o.otherCertifications=await Promise.all(e.map(async function(s){if(!s.isPrivate())throw Error("Need private key for signing");if(s.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");const u=await s.getSigningKey(void 0,t,void 0,n);return _n(a,s,u.keyPacket,{signatureType:m.signature.certGeneric,keyFlags:[m.keyFlags.certifyKeys|m.keyFlags.signData]},t,void 0,void 0,void 0,n)})),await o.update(this,t,n),o}async isRevoked(e,t,n=new Date,i=At){const a=this.mainKey.keyPacket;return An(a,m.signature.certRevocation,{key:a,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,n,i)}async verifyCertificate(e,t,n=new Date,i){const a=this,o=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:o},{issuerKeyID:u}=e,c=t.filter(h=>h.getKeys(u).length>0);return c.length===0?null:(await Promise.all(c.map(async h=>{const l=await h.getSigningKey(u,e.created,void 0,i);if(e.revoked||await a.isRevoked(e,l.keyPacket,n,i))throw Error("User certificate is revoked");try{await e.verify(l.keyPacket,m.signature.certGeneric,s,n,void 0,i)}catch(_){throw A.wrapError("User certificate is invalid",_)}})),!0)}async verifyAllCertifications(e,t=new Date,n){const i=this,a=this.selfCertifications.concat(this.otherCertifications);return Promise.all(a.map(async o=>({keyID:o.issuerKeyID,valid:await i.verifyCertificate(o,e,t,n).catch(()=>!1)})))}async verify(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");const n=this,i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i};let o;for(let s=this.selfCertifications.length-1;s>=0;s--)try{const u=this.selfCertifications[s];if(u.revoked||await n.isRevoked(u,void 0,e,t))throw Error("Self-certification is revoked");try{await u.verify(i,m.signature.certGeneric,a,e,void 0,t)}catch(c){throw A.wrapError("Self-certification is invalid",c)}return!0}catch(u){o=u}throw o}async update(e,t,n){const i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i};await Wr(e,this,"selfCertifications",t,async function(o){try{return await o.verify(i,m.signature.certGeneric,a,t,!1,n),!0}catch{return!1}}),await Wr(e,this,"otherCertifications",t),await Wr(e,this,"revocationSignatures",t,function(o){return An(i,m.signature.certRevocation,a,[o],void 0,void 0,t,n)})}async revoke(e,{flag:t=m.reasonForRevocation.noReason,string:n=""}={},i=new Date,a=At){const o={userID:this.userID,userAttribute:this.userAttribute,key:e},s=new e1(o.userID||o.userAttribute,this.mainKey);return s.revocationSignatures.push(await _n(o,null,e,{signatureType:m.signature.certRevocation,reasonForRevocationFlag:m.write(m.reasonForRevocation,t),reasonForRevocationString:n},i,void 0,void 0,!1,a)),await s.update(this),s}}class En{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new Ie;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new En(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,t,n=new Date,i=At){const a=this.mainKey.keyPacket;return An(a,m.signature.subkeyRevocation,{key:a,bind:this.keyPacket},this.revocationSignatures,e,t,n,i)}async verify(e=new Date,t=At){const n=this.mainKey.keyPacket,i={key:n,bind:this.keyPacket},a=await Oe(this.bindingSignatures,n,m.signature.subkeyBinding,i,e,t);if(a.revoked||await this.isRevoked(a,null,e,t))throw Error("Subkey is revoked");if(ia(this.keyPacket,a,e))throw Error("Subkey is expired");return a}async getExpirationTime(e=new Date,t=At){const n=this.mainKey.keyPacket,i={key:n,bind:this.keyPacket};let a;try{a=await Oe(this.bindingSignatures,n,m.signature.subkeyBinding,i,e,t)}catch{return null}const o=ni(this.keyPacket,a),s=a.getExpirationTime();return o<s?o:s}async update(e,t=new Date,n=At){const i=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===m.packet.publicSubkey&&e.keyPacket.constructor.tag===m.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const a=this,o={key:i,bind:a.keyPacket};await Wr(e,this,"bindingSignatures",t,async function(s){for(let u=0;u<a.bindingSignatures.length;u++)if(a.bindingSignatures[u].issuerKeyID.equals(s.issuerKeyID))return s.created>a.bindingSignatures[u].created&&(a.bindingSignatures[u]=s),!1;try{return await s.verify(i,m.signature.subkeyBinding,o,t,void 0,n),!0}catch{return!1}}),await Wr(e,this,"revocationSignatures",t,function(s){return An(i,m.signature.subkeyRevocation,o,[s],void 0,void 0,t,n)})}async revoke(e,{flag:t=m.reasonForRevocation.noReason,string:n=""}={},i=new Date,a=At){const o={key:e,bind:this.keyPacket},s=new En(this.keyPacket,this.mainKey);return s.revocationSignatures.push(await _n(o,null,e,{signatureType:m.signature.subkeyRevocation,reasonForRevocationFlag:m.write(m.reasonForRevocation,t),reasonForRevocationString:n},i,void 0,void 0,!1,a)),await s.update(this),s}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(r=>{En.prototype[r]=function(){return this.keyPacket[r]()}});const y5=A.constructAllowedPackets([rr]),l0=new Set([m.packet.publicKey,m.packet.privateKey]),d0=new Set([m.packet.publicKey,m.packet.privateKey,m.packet.publicSubkey,m.packet.privateSubkey]);class K2{packetListToStructure(e,t=new Set){let n,i,a,o;for(const s of e){if(s instanceof Xi){d0.has(s.tag)&&!o&&(o=l0.has(s.tag)?l0:d0);continue}const u=s.constructor.tag;if(o){if(!o.has(u))continue;o=null}if(t.has(u))throw Error("Unexpected packet type: "+u);switch(u){case m.packet.publicKey:case m.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=s,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case m.packet.userID:case m.packet.userAttribute:n=new e1(s,this),this.users.push(n);break;case m.packet.publicSubkey:case m.packet.secretSubkey:n=null,a=new En(s,this),this.subkeys.push(a);break;case m.packet.signature:switch(s.signatureType){case m.signature.certGeneric:case m.signature.certPersona:case m.signature.certCasual:case m.signature.certPositive:if(!n){A.printDebug("Dropping certification signatures without preceding user packet");continue}s.issuerKeyID.equals(i)?n.selfCertifications.push(s):n.otherCertifications.push(s);break;case m.signature.certRevocation:n?n.revocationSignatures.push(s):this.directSignatures.push(s);break;case m.signature.key:this.directSignatures.push(s);break;case m.signature.subkeyBinding:if(!a){A.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}a.bindingSignatures.push(s);break;case m.signature.keyRevocation:this.revocationSignatures.push(s);break;case m.signature.subkeyRevocation:if(!a){A.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}a.revocationSignatures.push(s)}}}}toPacketList(){const e=new Ie;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(t=>e.push(...t.toPacketList())),this.subkeys.map(t=>e.push(...t.toPacketList())),e}clone(e=!1){const t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach(n=>{if(n.keyPacket=Object.create(Object.getPrototypeOf(n.keyPacket),Object.getOwnPropertyDescriptors(n.keyPacket)),!n.keyPacket.isDecrypted())return;const i={};Object.keys(n.keyPacket.privateParams).forEach(a=>{i[a]=new Uint8Array(n.keyPacket.privateParams[a])}),n.keyPacket.privateParams=i}),t}getSubkeys(e=null){return this.subkeys.filter(t=>!e||t.getKeyID().equals(e,!0))}getKeys(e=null){const t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>e!==null)}write(){return this.toPacketList().write()}async getSigningKey(e=null,t=new Date,n={},i=At){await this.verifyPrimaryKey(t,n,i);const a=this.keyPacket,o=this.subkeys.slice().sort((u,c)=>c.keyPacket.created-u.keyPacket.created);let s;for(const u of o)if(!e||u.getKeyID().equals(e))try{await u.verify(t,i);const c={key:a,bind:u.keyPacket},h=await Oe(u.bindingSignatures,a,m.signature.subkeyBinding,c,t,i);if(!c0(u.keyPacket,h))continue;if(!h.embeddedSignature)throw Error("Missing embedded signature");return await Oe([h.embeddedSignature],u.keyPacket,m.signature.keyBinding,c,t,i),yn(u.keyPacket,i),u}catch(c){s=c}try{const u=await this.getPrimaryUser(t,n,i);if((!e||a.getKeyID().equals(e))&&c0(a,u.selfCertification))return yn(a,i),this}catch(u){s=u}throw A.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),s)}async getEncryptionKey(e,t=new Date,n={},i=At){await this.verifyPrimaryKey(t,n,i);const a=this.keyPacket,o=this.subkeys.slice().sort((u,c)=>c.keyPacket.created-u.keyPacket.created);let s;for(const u of o)if(!e||u.getKeyID().equals(e))try{await u.verify(t,i);const c={key:a,bind:u.keyPacket},h=await Oe(u.bindingSignatures,a,m.signature.subkeyBinding,c,t,i);if(u0(u.keyPacket,h))return yn(u.keyPacket,i),u}catch(c){s=c}try{const u=await this.getPrimaryUser(t,n,i);if((!e||a.getKeyID().equals(e))&&u0(a,u.selfCertification))return yn(a,i),this}catch(u){s=u}throw A.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),s)}async isRevoked(e,t,n=new Date,i=At){return An(this.keyPacket,m.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,n,i)}async verifyPrimaryKey(e=new Date,t={},n=At){const i=this.keyPacket;if(await this.isRevoked(null,null,e,n))throw Error("Primary key is revoked");const{selfCertification:a}=await this.getPrimaryUser(e,t,n);if(ia(i,a,e))throw Error("Primary key is expired");const o=await Oe(this.directSignatures,i,m.signature.key,{key:i},e,n).catch(()=>{});if(o&&ia(i,o,e))throw Error("Primary key is expired")}async getExpirationTime(e,t=At){let n;try{const{selfCertification:i}=await this.getPrimaryUser(null,e,t),a=ni(this.keyPacket,i),o=i.getExpirationTime(),s=await Oe(this.directSignatures,this.keyPacket,m.signature.key,{key:this.keyPacket},null,t).catch(()=>{});if(s){const u=ni(this.keyPacket,s);n=Math.min(a,o,u)}else n=a<o?a:o}catch{n=null}return A.normalizeDate(n)}async getPrimaryUser(e=new Date,t={},n=At){const i=this.keyPacket,a=[];let o;for(let h=0;h<this.users.length;h++)try{const l=this.users[h];if(!l.userID)continue;if(t.name!==void 0&&l.userID.name!==t.name||t.email!==void 0&&l.userID.email!==t.email||t.comment!==void 0&&l.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");const _={userID:l.userID,key:i},p=await Oe(l.selfCertifications,i,m.signature.certGeneric,_,e,n);a.push({index:h,user:l,selfCertification:p})}catch(l){o=l}if(!a.length)throw o||Error("Could not find primary user");await Promise.all(a.map(async function(h){return h.user.revoked||h.user.isRevoked(h.selfCertification,null,e,n)}));const s=a.sort(function(h,l){const _=h.selfCertification,p=l.selfCertification;return p.revoked-_.revoked||_.isPrimaryUserID-p.isPrimaryUserID||_.created-p.created}).pop(),{user:u,selfCertification:c}=s;if(c.revoked||await u.isRevoked(c,null,e,n))throw Error("Primary user is revoked");return s}async update(e,t=new Date,n=At){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(!(this.subkeys.length===e.subkeys.length&&this.subkeys.every(a=>e.subkeys.some(o=>a.hasSameFingerprintAs(o)))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,n)}const i=this.clone();return await Wr(e,i,"revocationSignatures",t,a=>An(i.keyPacket,m.signature.keyRevocation,i,[a],null,e.keyPacket,t,n)),await Wr(e,i,"directSignatures",t),await Promise.all(e.users.map(async a=>{const o=i.users.filter(s=>a.userID&&a.userID.equals(s.userID)||a.userAttribute&&a.userAttribute.equals(s.userAttribute));if(o.length>0)await Promise.all(o.map(s=>s.update(a,t,n)));else{const s=a.clone();s.mainKey=i,i.users.push(s)}})),await Promise.all(e.subkeys.map(async a=>{const o=i.subkeys.filter(s=>s.hasSameFingerprintAs(a));if(o.length>0)await Promise.all(o.map(s=>s.update(a,t,n)));else{const s=a.clone();s.mainKey=i,i.subkeys.push(s)}})),i}async getRevocationCertificate(e=new Date,t=At){const n={key:this.keyPacket},i=await Oe(this.revocationSignatures,this.keyPacket,m.signature.keyRevocation,n,e,t),a=new Ie;return a.push(i),ca(m.armor.publicKey,a.write(),null,null,"This is a revocation certificate")}async applyRevocationCertificate(e,t=new Date,n=At){const i=await Y2(e,n),a=(await Ie.fromBinary(i.data,y5,n)).findPacket(m.packet.signature);if(!a||a.signatureType!==m.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!a.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await a.verify(this.keyPacket,m.signature.keyRevocation,{key:this.keyPacket},t,void 0,n)}catch(s){throw A.wrapError("Could not verify revocation signature",s)}const o=this.clone();return o.revocationSignatures.push(a),o}async signPrimaryUser(e,t,n,i=At){const{index:a,user:o}=await this.getPrimaryUser(t,n,i),s=await o.certify(e,t,i),u=this.clone();return u.users[a]=s,u}async signAllUsers(e,t=new Date,n=At){const i=this.clone();return i.users=await Promise.all(this.users.map(function(a){return a.certify(e,t,n)})),i}async verifyPrimaryUser(e,t=new Date,n,i=At){const a=this.keyPacket,{user:o}=await this.getPrimaryUser(t,n,i);return e?await o.verifyAllCertifications(e,t,i):[{keyID:a.getKeyID(),valid:await o.verify(t,i).catch(()=>!1)}]}async verifyAllUsers(e,t=new Date,n=At){const i=this.keyPacket,a=[];return await Promise.all(this.users.map(async o=>{const s=e?await o.verifyAllCertifications(e,t,n):[{keyID:i.getKeyID(),valid:await o.verify(t,n).catch(()=>!1)}];a.push(...s.map(u=>({userID:o.userID.userID,keyID:u.keyID,valid:u.valid})))})),a}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(r=>{K2.prototype[r]=En.prototype[r]});class f0 extends K2{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([m.packet.secretKey,m.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=At){return ca(m.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,e)}}class Aa extends f0{constructor(e){if(super(),this.packetListToStructure(e,new Set([m.packet.publicKey,m.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new Ie,t=this.toPacketList();for(const n of t)switch(n.constructor.tag){case m.packet.secretKey:{const i=We.fromSecretKeyPacket(n);e.push(i);break}case m.packet.secretSubkey:{const i=gi.fromSecretSubkeyPacket(n);e.push(i);break}default:e.push(n)}return new f0(e)}armor(e=At){return ca(m.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,e)}async getDecryptionKeys(e,t=new Date,n={},i=At){const a=this.keyPacket,o=[];for(let u=0;u<this.subkeys.length;u++)if(!e||this.subkeys[u].getKeyID().equals(e,!0))try{const c={key:a,bind:this.subkeys[u].keyPacket};h0(await Oe(this.subkeys[u].bindingSignatures,a,m.signature.subkeyBinding,c,t,i),i)&&o.push(this.subkeys[u])}catch{}const s=await this.getPrimaryUser(t,n,i);return e&&!a.getKeyID().equals(e,!0)||!h0(s.selfCertification,i)||o.push(this),o}isDecrypted(){return this.getKeys().some(({keyPacket:e})=>e.isDecrypted())}async validate(e=At){if(!this.isPrivate())throw Error("Cannot validate a public key");let t;if(this.keyPacket.isDummy()){const n=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});n&&!n.keyPacket.isDummy()&&(t=n.keyPacket)}else t=this.keyPacket;if(t)return t.validate();{const n=this.getKeys();if(n.map(i=>i.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(n.map(async i=>i.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()})}async revoke({flag:e=m.reasonForRevocation.noReason,string:t=""}={},n=new Date,i=At){if(!this.isPrivate())throw Error("Need private key for revoking");const a={key:this.keyPacket},o=this.clone();return o.revocationSignatures.push(await _n(a,null,this.keyPacket,{signatureType:m.signature.keyRevocation,reasonForRevocationFlag:m.write(m.reasonForRevocation,e),reasonForRevocationString:t},n,void 0,void 0,void 0,i)),o}async addSubkey(e={}){const t={...At,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<t.minRSABits)throw Error(`rsaBits should be at least ${t.minRSABits}, got: ${e.rsaBits}`);const n=this.keyPacket;if(n.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!n.isDecrypted())throw Error("Key is not decrypted");const i=n.getAlgorithmInfo();i.type=i.curve?"ecc":"rsa",i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519",e=aa(e,i);const a=await P2(e);yn(a,t);const o=await U2(a,n,e,t),s=this.toPacketList();return s.push(a,o),new Aa(s)}}async function p5(r,e,t,n){t.passphrase&&await r.encrypt(t.passphrase,n),await Promise.all(e.map(async function(o,s){const u=t.subkeys[s].passphrase;u&&await o.encrypt(u,n)}));const i=new Ie;i.push(r),await Promise.all(t.userIDs.map(async function(o,s){function u(_,p){return[p,..._.filter(R=>R!==p)]}const c=va.fromObject(o),h={};h.userID=c,h.key=r;const l=new rr;return l.signatureType=m.signature.certGeneric,l.publicKeyAlgorithm=r.algorithm,l.hashAlgorithm=await _a(null,r,void 0,void 0,n),l.keyFlags=[m.keyFlags.certifyKeys|m.keyFlags.signData],l.preferredSymmetricAlgorithms=u([m.symmetric.aes256,m.symmetric.aes128,m.symmetric.aes192],n.preferredSymmetricAlgorithm),n.aeadProtect&&(l.preferredAEADAlgorithms=u([m.aead.eax,m.aead.ocb],n.preferredAEADAlgorithm)),l.preferredHashAlgorithms=u([m.hash.sha256,m.hash.sha512],n.preferredHashAlgorithm),l.preferredCompressionAlgorithms=u([m.compression.zlib,m.compression.zip,m.compression.uncompressed],n.preferredCompressionAlgorithm),s===0&&(l.isPrimaryUserID=!0),l.features=[0],l.features[0]|=m.features.modificationDetection,n.aeadProtect&&(l.features[0]|=m.features.aead),n.v5Keys&&(l.features[0]|=m.features.v5Keys),t.keyExpirationTime>0&&(l.keyExpirationTime=t.keyExpirationTime,l.keyNeverExpires=!1),await l.sign(r,h,t.date),{userIDPacket:c,signaturePacket:l}})).then(o=>{o.forEach(({userIDPacket:s,signaturePacket:u})=>{i.push(s),i.push(u)})}),await Promise.all(e.map(async function(o,s){const u=t.subkeys[s];return{secretSubkeyPacket:o,subkeySignaturePacket:await U2(o,r,u,n)}})).then(o=>{o.forEach(({secretSubkeyPacket:s,subkeySignaturePacket:u})=>{i.push(s),i.push(u)})});const a={key:r};return i.push(await _n(a,null,r,{signatureType:m.signature.keyRevocation,reasonForRevocationFlag:m.reasonForRevocation.noReason,reasonForRevocationString:""},t.date,void 0,void 0,void 0,n)),t.passphrase&&r.clearPrivateParams(),await Promise.all(e.map(async function(o,s){t.subkeys[s].passphrase&&o.clearPrivateParams()})),new Aa(i)}async function g5({userIDs:r=[],passphrase:e,type:t="ecc",rsaBits:n=4096,curve:i="curve25519",keyExpirationTime:a=0,date:o=new Date,subkeys:s=[{}],format:u="armored",config:c,...h}){w5(c={...At,...c}),r=b5(r);const l=Object.keys(h);if(l.length>0)throw Error("Unknown option: "+l.join(", "));if(r.length===0)throw Error("UserIDs are required for key generation");if(t==="rsa"&&n<c.minRSABits)throw Error(`rsaBits should be at least ${c.minRSABits}, got: ${n}`);const _={userIDs:r,passphrase:e,type:t,rsaBits:n,curve:i,keyExpirationTime:a,date:o,subkeys:s};try{const{key:p,revocationCertificate:R}=await async function(M,N){M.sign=!0,(M=aa(M)).subkeys=M.subkeys.map(($,q)=>aa(M.subkeys[q],M));let j=[f5(M,N)];j=j.concat(M.subkeys.map($=>P2($,N)));const Y=await Promise.all(j),F=await p5(Y[0],Y.slice(1),M,N),E=await F.getRevocationCertificate(M.date,N);return F.revocationSignatures=[],{key:F,revocationCertificate:E}}(_,c);return p.getKeys().forEach(({keyPacket:M})=>yn(M,c)),{privateKey:y0(p,u,c),publicKey:y0(p.toPublic(),u,c),revocationCertificate:R}}catch(p){throw A.wrapError("Error generating keypair",p)}}const m5=Object.keys(At).length;function w5(r){const e=Object.keys(r);if(e.length!==m5){for(const t of e)if(At[t]===void 0)throw Error("Unknown config property: "+t)}}function b5(r){return r&&!A.isArray(r)&&(r=[r]),r}function y0(r,e,t){switch(e){case"object":return r;case"armored":return r.armor(t);case"binary":return r.write();default:throw Error("Unsupported format "+e)}}function k5(r){let e,t,n,i,a,o,s=r[0].slug+"",u,c;return{c(){e=nn("Welcome "),t=nn(r[1]),n=nn("!"),i=Pa("br"),a=Pa("br"),o=nn(`
    Lets create `),u=nn(s),c=nn("...")},l(h){e=an(h,"Welcome "),t=an(h,r[1]),n=an(h,"!"),i=Ua(h,"BR",{}),a=Ua(h,"BR",{}),o=an(h,`
    Lets create `),u=an(h,s),c=an(h,"...")},m(h,l){wr(h,e,l),wr(h,t,l),wr(h,n,l),wr(h,i,l),wr(h,a,l),wr(h,o,l),wr(h,u,l),wr(h,c,l)},p(h,l){l&2&&Ka(t,h[1]),l&1&&s!==(s=h[0].slug+"")&&Ka(u,s)},d(h){h&&br(e),h&&br(t),h&&br(n),h&&br(i),h&&br(a),h&&br(o),h&&br(u),h&&br(c)}}}function v5(r){let e,t;return e=new F2({props:{variant:"rounded",dark:!0,title:"Create Seesion",$$slots:{default:[k5]},$$scope:{ctx:r}}}),{c(){T2(e.$$.fragment)},l(n){B2(e.$$.fragment,n)},m(n,i){z2(e,n,i),t=!0},p(n,[i]){const a={};i&259&&(a.$$scope={dirty:i,ctx:n}),e.$set(a)},i(n){t||(R2(e.$$.fragment,n),t=!0)},o(n){M2(e.$$.fragment,n),t=!1},d(n){N2(e,n)}}}function _5(r,e,t){let{data:n}=e,i="";const a=H2.subscribe(h=>t(1,i=h)),o=q2.subscribe(h=>h);let s=null;const u=new RTCPeerConnection({iceServers:[{urls:"stun:stun2.1.google.com:19302"}]});return u.onicecandidate=({candidate:h})=>{s=h,console.log("own ice candidate received",{ownCandidate:s})},L2(async()=>{console.log("now creating session",{username:i,password:"not displayed here",sessionname:n.slug});const h=await g5({curve:"curve25519",userIDs:[{name:"Test",email:i}]});console.log("pgp keyPair created",{keyPair:h});const l=await u.createOffer();await u.setLocalDescription(l),console.log("webrtc offer created",{offer:l})}),O2(()=>{a(),o()}),r.$$set=h=>{"data"in h&&t(0,n=h.data)},[n,i]}class U5 extends D2{constructor(e){super(),C2(this,e,_5,v5,I2,{data:0})}}export{Sn as A,ci as J,P5 as K,k3 as M,U5 as P,ui as X,Dt as d,da as g,n3 as i,la as r,x5 as t,N3 as y,z0 as z};
